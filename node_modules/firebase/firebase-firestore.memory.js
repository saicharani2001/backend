!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Ep){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Ep),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=u=u||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ie={})[u.DEBUG]="log",Ie[u.VERBOSE]="log",Ie[u.INFO]="info",Ie[u.WARN]="warn",Ie[u.ERROR]="error",Ie),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){e=d.call(this,e)||this;return e.code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var h=a[u];"_"!==h.slice(-1)&&(h in s&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),s[h]=i[h])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},L={},S=R||self;function O(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function V(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),U=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:C).apply(null,arguments)}function x(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,_)&&t[_]||(t[_]=++U))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var Y,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var $=S.navigator;if($){$=$.userAgent;if($){Y=$;break t}}Y=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=O;var rt,it=K(Y,"Opera"),ot=K(Y,"Trident")||K(Y,"MSIE"),st=K(Y,"Edge"),ut=st||ot,at=K(Y,"Gecko")&&!(K(Y.toLowerCase(),"webkit")&&!K(Y,"Edge"))&&!(K(Y,"Trident")||K(Y,"MSIE"))&&!K(Y,"Edge"),ht=K(Y.toLowerCase(),"webkit")&&!K(Y,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}t:{var lt="",ft=(ft=Y,at?/rv:([^\);]+)(\)|;)/.exec(ft):st?/Edge\/([\d\.]+)/.exec(ft):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):ht?/WebKit\/(\S+)/.exec(ft):it?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(lt=ft?ft[1]:""),ot){ft=ct();if(null!=ft&&ft>parseFloat(lt)){rt=String(ft);break t}}rt=lt}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=W(String(rt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=S.document&&ot?ct()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",O,e),S.removeEventListener("test",O,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},j(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Rt(t){this.src=t,this.a={},this.b=0}function Lt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Rt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new At(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Dt={};function Vt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Ft(r);return e&&e[It]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);return null}return n=Ft(n),t&&t[It]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,h=Mt(t);if(h||(t[Ot]=h=new Rt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?Lt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(Lt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):Nt(t)))}function Ut(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Pt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(vt)return Pt(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Pt(t,e=new bt(e,this))}function Mt(t){return(t=t[Ot])instanceof Rt?t:null}var xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ft(e){return"function"==D(e)?e:(e[xt]||(e[xt]=function(t){return e.handleEvent(t)}),e[xt])}function jt(){B.call(this),this.c=new Rt(this),(this.J=this).C=null}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Lt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,B),jt.prototype[It]=!0,(N=jt.prototype).addEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Ft(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&_t(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new wt(t,n):t instanceof wt?t.target=t.target||n:(s=t,et(t=new wt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Bt(o,r,!0,t)&&s;if(s=Bt(o=t.a=n,r,!0,t)&&s,s=Bt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Bt(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(jt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=S.JSON.stringify;function Gt(){this.b=this.a=null}var zt,Qt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Yt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function Wt(t,e){var n;zt||(n=S.Promise.resolve(void 0),zt=function(){n.then($t)}),Kt||(zt(),Kt=!0),Xt.add(t,e)}Gt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Kt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new Gt;function $t(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Qt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Kt=!1}function Jt(t,e){jt.call(this),this.b=t||1,this.a=e||S,this.f=M(this.Ya,this),this.g=F()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==D(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j(Jt,jt),(N=Jt.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=F()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Zt(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=F())},N.G=function(){Jt.S.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=B),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e,n){var r=ee.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ue(t){B.call(this),this.b=t,this.a={}}j(ue,B);var ae=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Vt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&_t(t)},t),t.a={}}function le(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.S.G.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var pe=null;function de(){return pe=pe||new jt}function ye(t){wt.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){wt.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){wt.call(this,"timingevent",t)}function be(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}j(ye,wt),j(ge,wt),j(we,wt);var Ee={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Te(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var Re,R={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Le(){wt.call(this,"d")}function Se(){wt.call(this,"c")}function Oe(){}function De(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ue(this),this.P=Ve,t=ut?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(Le,wt),j(Se,wt),j(Oe,Te),Re=new Oe;var Ve=45e3,ke={},_e={};function Ue(t,e,n){t.H=1,t.i=en(Ke(e)),t.j=n,t.I=!0,Pe(t,null)}function Pe(t,e){t.u=F(),Me(t),t.l=Ke(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(M(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Ce(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?_e:(i=Number(u.substring(i,o)),isNaN(i)?ke:(o+=1)+i>u.length?_e:(u=u.substr(o,i),r.D=o+i,u)));if(u==_e){4==e&&(t.h=4,me(14),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==ke){t.h=4,me(15),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),qe(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),je(t))}function Me(t){t.U=F()+t.P,xe(t,t.P)}function xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(M(t.Ua,t),e)}function Fe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function je(t){0==t.g.v||t.A||rr(t.g,t)}function Be(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function qe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),Qn(u)}Zn(u),me(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(M(u.Ra,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(K(r,"spdy")||K(r,"quic")||K(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=F()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),Me(o)),n.a=i):Jn(n),0<u.g.length&&Wn(u)):"stop"!=h[0]&&"close"!=h[0]||or(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?or(u,7):zn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0)}ve(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(V(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(V(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(V(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=De.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==jn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),Fe(this);var i=this.a.X();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,me(12),Be(this),je(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,qe(this,s)}this.I?(Ce(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),qe(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),Be(this),je(this)}}}catch(t){}var u,a,h,c,l,f},N.Va=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),Ce(this,t,e),this.b&&4!=t&&Me(this)))},N.cancel=function(){this.A=!0,Be(this)},N.Ua=function(){this.o=null;var t,e,n=F();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),Be(this),this.h=2,je(this)):xe(this,this.U-n)},(N=ze.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Qe(this),this.a.concat()},N.get=function(t,e){return He(this.b,t)?this.b[t]:e},N.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,$e(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=nn(n[2]||""),$e(this,n[3]||"",!0),Je(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Ke(t){return new We(t)}function Xe(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?nn(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,hn)),t.b=new ln(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,cn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,hn=/[#\?@]/g,cn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){fn(t),e=vn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function dn(t,e){return fn(t),e=vn(t,e),He(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),Q(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=ln.prototype).add=function(t,e){fn(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){fn(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=z(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},N.set=function(t,e){return fn(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return Q(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Rn(){}function Ln(){this.a=new Rn}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Rn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Rn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var On=S.JSON.parse;function Dn(t){jt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Vn,this.D=this.F=!1}j(Dn,jt);var Vn="",kn=/^https?$/i,_n=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function Pn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),xn(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Mn(t){if(t.b&&void 0!==L&&(!t.s[1]||4!=jn(t)||2!=t.X()))if(t.l&&4==jn(t))te(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Cn(t)}}finally{xn(t)}}}function xn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=qn("baseRetryDelayMs",5e3,t),this.Ma=qn("retryDelaySeedMs",1e4,t),this.Ja=qn("forwardChannelMaxRetries",2,t),this.ma=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new Ln,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function zn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,tn(n=Ke(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Xn(t,n),(e=new De(t,t.c,e,void 0)).H=2,e.i=en(Ke(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=F(),Me(e)),sr(t)}function Qn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Hn(t){Qn(t),t.j&&(S.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new gn(t.La++,e)),3==t.v&&Wn(t)}function Wn(t){bn(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function Kn(t,e){var n=e?e.f:t.R++,r=Ke(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Xn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new De(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Ue(n,r,e)}function Xn(t,n){t.f&&Ge({},function(t,e){tn(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;k(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.U=1,Wt(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=be(M(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function er(t){t.a=new De(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ke(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Xn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Ke(e)),n.j=null,n.I=!0,Pe(n,t)}function nr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r=null;if(t.a==e){nr(t),tr(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=F()-e.u,n=t.u,(i=de()).dispatchEvent(new we(i)),Wn(t)):Jn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=be(M(t.Ba,t,e),ir(t,t.u)),t.u++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=M(t.Xa,t),r||(r=new We("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Xe(r,"https"),en(r)),n=r.toString(),r=o,o=new le,S.Image?((i=new Image).onload=x(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=x(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=x(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=x(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Hn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,Q(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?Ke(s):new We(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Je(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&Xe(u,r),i&&$e(u,i),o&&Je(u,o),s&&(u.g=s),a=u),t.W&&J(t.W,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Xn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Ka)).F=t.C,e}function hr(){}function cr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function fr(t){Le.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){Se.call(this),this.status=1}function dr(t){this.a=t}(N=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Re),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Pn(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=q(_n,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Pn(this,t)}},N.xa=function(){void 0!==L&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),xn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xn(this,!0)),Dn.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ta())},N.Ta=function(){Mn(this)},N.X=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Gn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new De(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),tn(i=Ke(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Xn(this,i),this.i&&r&&Bn(i,this.i,r),Tn(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,Ue(n,i,null)):Ue(n,i,e),this.v=2}}else 3==this.v&&(t?Kn(this,t):0==this.g.length||bn(this.b)||Kn(this))},N.Aa=function(){var t;this.j=null,er(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(M(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qn(this),er(this))},N.Ra=function(){null!=this.m&&(this.m=null,Qn(this),Zn(this),me(19))},N.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(N=hr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},cr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),(N=lr.prototype).addEventListener=function(t,e,n,r){lr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){lr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=ur(t,null,t.fa),Wn(t)},N.close=function(){zn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.g?((e={}).__data__=qt(t),Yn(this.a,e)):Yn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,lr.S.G.call(this)},j(fr,Le),j(pr,Se),j(dr,hr),dr.prototype.ta=function(){this.a.dispatchEvent("a")},dr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},dr.prototype.ra=function(t){this.a.dispatchEvent(new pr)},dr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,lr.prototype.send=lr.prototype.Pa,lr.prototype.open=lr.prototype.Oa,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ne.EventType=R).OPEN="a",R.CLOSE="b",R.ERROR="c",R.MESSAGE="d",jt.prototype.listen=jt.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Qa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.X,Dn.prototype.getResponseJson=Dn.prototype.Na,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var Ie={createWebChannelTransport:function(){return new cr},ErrorCode:Ee,EventType:Ie,WebChannel:Ne,XhrIo:Dn},yr=Ie.createWebChannelTransport,vr=Ie.ErrorCode,gr=Ie.EventType,mr=Ie.WebChannel,wr=Ie.XhrIo,br=(Er.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Er.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Er.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Er);function Er(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir,Tr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ar=(n(Lr,Ir=Error),Lr),Nr="7.22.1-alpha.96ae6a5fe",Rr=new l("@firebase/firestore");function Lr(t,e){var n=this;return(n=Ir.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Sr(){return Rr.logLevel}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.DEBUG&&(e=n.map(kr),Rr.debug.apply(Rr,i(["Firestore ("+Nr+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.ERROR&&(e=n.map(kr),Rr.error.apply(Rr,i(["Firestore ("+Nr+"): "+t],e)))}function Vr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.WARN&&(e=n.map(kr),Rr.warn.apply(Rr,i(["Firestore ("+Nr+"): "+t],e)))}function kr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function _r(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Nr+") INTERNAL ASSERTION FAILED: "+t;throw Dr(t),new Error(t)}function Ur(t){t||_r()}function Pr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Cr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Mr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var xr,Fr,l=(Object.defineProperty(Yr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Yr.prototype.isEqual=function(t){return 0===Yr.i(this,t)},Yr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Yr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Yr.prototype.limit=function(){return this.offset+this.length},Yr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Yr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Yr.prototype.l=function(){return this.segments[this.offset]},Yr.prototype._=function(){return this.get(this.length-1)},Yr.prototype.get=function(t){return this.segments[this.offset+t]},Yr.prototype.m=function(){return 0===this.length},Yr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Yr.prototype.A=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Yr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Yr.prototype.I=function(){return this.segments.slice(this.offset,this.limit())},Yr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Yr),jr=(n(Hr,Fr=l),Hr.prototype.o=function(t,e,n){return new Hr(t,e,n)},Hr.prototype.R=function(){return this.I().join("/")},Hr.prototype.toString=function(){return this.R()},Hr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Hr(n)},Hr.V=function(){return new Hr([])},Hr),Br=/^[_a-zA-Z][_a-zA-Z0-9]*$/,qr=(n(Qr,xr=l),Qr.prototype.o=function(t,e,n){return new Qr(t,e,n)},Qr.p=function(t){return Br.test(t)},Qr.prototype.R=function(){return this.I().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Qr.p(t)||(t="`"+t+"`"),t}).join(".")},Qr.prototype.toString=function(){return this.R()},Qr.prototype.g=function(){return 1===this.length&&"__name__"===this.get(0)},Qr.v=function(){return new Qr(["__name__"])},Qr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ar(Tr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ar(Tr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Qr(e)},Qr.V=function(){return new Qr([])},Qr),Gr=(zr.D=function(t){return new zr(jr.P(t))},zr.C=function(t){return new zr(jr.P(t).u(5))},zr.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},zr.prototype.isEqual=function(t){return null!==t&&0===jr.i(this.path,t.path)},zr.prototype.toString=function(){return this.path.toString()},zr.i=function(t,e){return jr.i(t.path,e.path)},zr.F=function(t){return t.length%2==0},zr.$=function(t){return new zr(new jr(t.slice()))},zr);function zr(t){this.path=t}function Qr(){return null!==xr&&xr.apply(this,arguments)||this}function Hr(){return null!==Fr&&Fr.apply(this,arguments)||this}function Yr(t,e,n){void 0===e?e=0:e>t.length&&_r(),void 0===n?n=t.length-e:n>t.length-e&&_r(),this.segments=t,this.offset=e,this.t=n}function Wr(t,e){if(0!==e.length)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+fi(e.length,"argument")+".")}function Kr(t,e,n){if(e.length!==n)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Xr(t,e,n){if(e.length<n)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function $r(t,e,n,r){if(e.length<n||e.length>r)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+fi(e.length,"argument")+".")}function Jr(t,e,n,r){ii(t,e,li(n)+" argument",r)}function Zr(t,e,n,r){void 0!==r&&Jr(t,e,n,r)}function ti(t,e,n,r){ii(t,e,n+" option",r)}function ei(t,e,n,r){void 0!==r&&ti(t,e,n,r)}function ni(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(si(s))}var u=si(n);throw new Ar(Tr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ri(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid value "+si(r)+" provided to function "+t+"() for its "+li(n)+" argument. Acceptable values: "+e.join(", "));return r}function ii(t,e,n,r){if(!("object"===e?oi(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){r=si(r);throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function oi(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function si(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":_r();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ui(t,e,n){if(void 0===n)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+li(e)+" argument, but it was undefined.")}function ai(n,t,r){Cr(t,function(t,e){if(r.indexOf(t)<0)throw new Ar(Tr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function hi(t,e,n,r){r=si(r);return new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+li(n)+" argument to be a "+e+", but it was: "+r)}function ci(t,e,n){if(n<=0)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+li(e)+" argument to be a positive number, but it was: "+n+".")}function li(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function fi(t,e){return t+" "+e+(1===t?"":"s")}var pi=(di.L=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},di);function di(){}function yi(t,e){return t<e?-1:e<t?1:0}function vi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var gi=(mi.fromBase64String=function(t){return new mi(atob(t))},mi.fromUint8Array=function(t){return new mi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},mi.prototype.toBase64=function(){return t=this.O,btoa(t);var t},mi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},mi.prototype.k=function(){return 2*this.O.length},mi.prototype.M=function(t){return yi(this.O,t.O)},mi.prototype.isEqual=function(t){return this.O===t.O},mi);function mi(t){this.O=t}gi.U=new gi("");var wi=(bi.fromBase64String=function(t){try{return new bi(gi.fromBase64String(t))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},bi.fromUint8Array=function(t){return new bi(gi.fromUint8Array(t))},bi.prototype.toBase64=function(){return this.q.toBase64()},bi.prototype.toUint8Array=function(){return this.q.toUint8Array()},bi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},bi.prototype.isEqual=function(t){return this.q.isEqual(t.q)},bi);function bi(t){this.q=t}function Ei(){if("undefined"==typeof Uint8Array)throw new Ar(Tr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ii(){if("undefined"==typeof atob)throw new Ar(Tr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ti(t,e,n,r,i){this.B=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ai,Ni=(n(Ui,Ai=wi),Ui.fromBase64String=function(t){Kr("Blob.fromBase64String",arguments,1),Jr("Blob.fromBase64String","string",1,t),Ii();try{return new Ui(gi.fromBase64String(t))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Ui.fromUint8Array=function(t){if(Kr("Blob.fromUint8Array",arguments,1),Ei(),!(t instanceof Uint8Array))throw hi("Blob.fromUint8Array","Uint8Array",1,t);return new Ui(gi.fromUint8Array(t))},Ui.prototype.toBase64=function(){return Kr("Blob.toBase64",arguments,0),Ii(),Ai.prototype.toBase64.call(this)},Ui.prototype.toUint8Array=function(){return Kr("Blob.toUint8Array",arguments,0),Ei(),Ai.prototype.toUint8Array.call(this)},Ui.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Ui),Ri=(Object.defineProperty(_i.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),_i.prototype.isEqual=function(t){return t instanceof _i&&t.projectId===this.projectId&&t.database===this.database},_i.prototype.M=function(t){return yi(this.projectId,t.projectId)||yi(this.database,t.database)},_i),Li=(ki.prototype.get=function(t){var e=this.W(t),e=this.K[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.G(o,t))return i}},ki.prototype.has=function(t){return void 0!==this.get(t)},ki.prototype.set=function(t,e){var n=this.W(t),r=this.K[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.K[n]=[[t,e]]},ki.prototype.delete=function(t){var e=this.W(t),n=this.K[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.K[e]:n.splice(r,1),!0;return!1},ki.prototype.forEach=function(s){Cr(this.K,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},ki.prototype.m=function(){return Mr(this.K)},ki),Si=(Vi.now=function(){return Vi.fromMillis(Date.now())},Vi.fromDate=function(t){return Vi.fromMillis(t.getTime())},Vi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Vi(e,1e6*(t-1e3*e))},Vi.prototype.toDate=function(){return new Date(this.toMillis())},Vi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Vi.prototype.H=function(t){return this.seconds===t.seconds?yi(this.nanoseconds,t.nanoseconds):yi(this.seconds,t.seconds)},Vi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Vi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Vi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Vi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Vi),Oi=(Di.Y=function(t){return new Di(t)},Di.min=function(){return new Di(new Si(0,0))},Di.prototype.M=function(t){return this.timestamp.H(t.timestamp)},Di.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Di.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Di.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Di.prototype.X=function(){return this.timestamp},Di);function Di(t){this.timestamp=t}function Vi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ki(t,e){this.W=t,this.G=e,this.K={}}function _i(t,e){this.projectId=t,this.database=e||"(default)"}function Ui(){return null!==Ai&&Ai.apply(this,arguments)||this}function Pi(t){return null==t}function Ci(t){return 0===t&&1/t==-1/0}var Mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function xi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Mi(t,e,n,r,i,o,s)}function Fi(t){var e=t;return null===e.Z&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+Fo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Pi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=da(e.startAt)),e.endAt&&(t+="|ub:",t+=da(e.endAt)),e.Z=t),e.Z}function ji(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Po(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!va(t.startAt,e.startAt)&&va(t.endAt,e.endAt)}function Bi(t){return Gr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function qi(t){this.count=t}var Gi,zi=(Qi.prototype.nt=function(t){return new Qi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Qi.prototype.st=function(t,e){return new Qi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Qi.prototype.it=function(t){return new Qi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},Qi);function Qi(t,e,n,r,i,o,s){void 0===i&&(i=Oi.min()),void 0===o&&(o=Oi.min()),void 0===s&&(s=gi.U),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Hi(t){switch(t){case Tr.OK:return _r(),0;case Tr.CANCELLED:case Tr.UNKNOWN:case Tr.DEADLINE_EXCEEDED:case Tr.RESOURCE_EXHAUSTED:case Tr.INTERNAL:case Tr.UNAVAILABLE:case Tr.UNAUTHENTICATED:return;case Tr.INVALID_ARGUMENT:case Tr.NOT_FOUND:case Tr.ALREADY_EXISTS:case Tr.PERMISSION_DENIED:case Tr.FAILED_PRECONDITION:case Tr.ABORTED:case Tr.OUT_OF_RANGE:case Tr.UNIMPLEMENTED:case Tr.DATA_LOSS:return 1;default:return _r(),0}}function Yi(t){if(void 0===t)return Dr("GRPC error has no .code"),Tr.UNKNOWN;switch(t){case Gi.OK:return Tr.OK;case Gi.CANCELLED:return Tr.CANCELLED;case Gi.UNKNOWN:return Tr.UNKNOWN;case Gi.DEADLINE_EXCEEDED:return Tr.DEADLINE_EXCEEDED;case Gi.RESOURCE_EXHAUSTED:return Tr.RESOURCE_EXHAUSTED;case Gi.INTERNAL:return Tr.INTERNAL;case Gi.UNAVAILABLE:return Tr.UNAVAILABLE;case Gi.UNAUTHENTICATED:return Tr.UNAUTHENTICATED;case Gi.INVALID_ARGUMENT:return Tr.INVALID_ARGUMENT;case Gi.NOT_FOUND:return Tr.NOT_FOUND;case Gi.ALREADY_EXISTS:return Tr.ALREADY_EXISTS;case Gi.PERMISSION_DENIED:return Tr.PERMISSION_DENIED;case Gi.FAILED_PRECONDITION:return Tr.FAILED_PRECONDITION;case Gi.ABORTED:return Tr.ABORTED;case Gi.OUT_OF_RANGE:return Tr.OUT_OF_RANGE;case Gi.UNIMPLEMENTED:return Tr.UNIMPLEMENTED;case Gi.DATA_LOSS:return Tr.DATA_LOSS;default:return _r()}}(l=Gi=Gi||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Wi=(Zi.prototype.rt=function(t,e){return new Zi(this.i,this.root.rt(t,e,this.i).copy(null,null,Xi.ot,null,null))},Zi.prototype.remove=function(t){return new Zi(this.i,this.root.remove(t,this.i).copy(null,null,Xi.ot,null,null))},Zi.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Zi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Zi.prototype.m=function(){return this.root.m()},Object.defineProperty(Zi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Zi.prototype.ut=function(){return this.root.ut()},Zi.prototype.at=function(){return this.root.at()},Zi.prototype.ct=function(t){return this.root.ct(t)},Zi.prototype.forEach=function(n){this.ct(function(t,e){return n(t,e),!1})},Zi.prototype.toString=function(){var n=[];return this.ct(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Zi.prototype.ht=function(t){return this.root.ht(t)},Zi.prototype.lt=function(){return new Ki(this.root,null,this.i,!1)},Zi.prototype._t=function(t){return new Ki(this.root,t,this.i,!1)},Zi.prototype.ft=function(){return new Ki(this.root,null,this.i,!0)},Zi.prototype.dt=function(t){return new Ki(this.root,t,this.i,!0)},Zi),Ki=(Ji.prototype.Tt=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},Ji.prototype.At=function(){return 0<this.Et.length},Ji.prototype.It=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},Ji),Xi=($i.prototype.copy=function(t,e,n,r,i){return new $i(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},$i.prototype.m=function(){return!1},$i.prototype.ct=function(t){return this.left.ct(t)||t(this.key,this.value)||this.right.ct(t)},$i.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},$i.prototype.min=function(){return this.left.m()?this:this.left.min()},$i.prototype.ut=function(){return this.min().key},$i.prototype.at=function(){return this.right.m()?this.key:this.right.at()},$i.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},$i.prototype.yt=function(){if(this.left.m())return $i.EMPTY;var t=this;return t.left.Pt()||t.left.left.Pt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.yt(),null)).Rt()},$i.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.Pt()||r.left.left.Pt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Pt()&&(r=r.gt()),r.right.m()||r.right.Pt()||r.right.left.Pt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return $i.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},$i.prototype.Pt=function(){return this.color},$i.prototype.Rt=function(){var t=this;return t.right.Pt()&&!t.left.Pt()&&(t=t.bt()),t.left.Pt()&&t.left.left.Pt()&&(t=t.gt()),t.left.Pt()&&t.right.Pt()&&(t=t.St()),t},$i.prototype.Vt=function(){var t=this.St();return t.right.left.Pt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).bt()).St()),t},$i.prototype.vt=function(){var t=this.St();return t.left.left.Pt()&&(t=(t=t.gt()).St()),t},$i.prototype.bt=function(){var t=this.copy(null,null,$i.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},$i.prototype.gt=function(){var t=this.copy(null,null,$i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},$i.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},$i.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},$i.prototype.Ct=function(){if(this.Pt()&&this.left.Pt())throw _r();if(this.right.Pt())throw _r();var t=this.left.Ct();if(t!==this.right.Ct())throw _r();return t+(this.Pt()?0:1)},$i);function $i(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:$i.RED,this.left=null!=r?r:$i.EMPTY,this.right=null!=i?i:$i.EMPTY,this.size=this.left.size+1+this.right.size}function Ji(t,e,n,r){this.wt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.wt?t.right:t.left}}function Zi(t,e){this.i=t,this.root=e||Xi.EMPTY}function to(){this.size=0}Xi.EMPTY=null,Xi.RED=!0,Xi.ot=!1,Xi.EMPTY=(Object.defineProperty(to.prototype,"key",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"value",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"color",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"left",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"right",{get:function(){throw _r()},enumerable:!1,configurable:!0}),to.prototype.copy=function(t,e,n,r,i){return this},to.prototype.rt=function(t,e,n){return new Xi(t,e)},to.prototype.remove=function(t,e){return this},to.prototype.m=function(){return!0},to.prototype.ct=function(t){return!1},to.prototype.ht=function(t){return!1},to.prototype.ut=function(){return null},to.prototype.at=function(){return null},to.prototype.Pt=function(){return!1},to.prototype.Dt=function(){return!0},to.prototype.Ct=function(){return 0},new to);var eo=(oo.prototype.has=function(t){return null!==this.data.get(t)},oo.prototype.first=function(){return this.data.ut()},oo.prototype.last=function(){return this.data.at()},Object.defineProperty(oo.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),oo.prototype.indexOf=function(t){return this.data.indexOf(t)},oo.prototype.forEach=function(n){this.data.ct(function(t,e){return n(t),!1})},oo.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.At();){var r=n.Tt();if(0<=this.i(r.key,t[1]))return;e(r.key)}},oo.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.At();)if(!t(n.Tt().key))return},oo.prototype.$t=function(t){t=this.data._t(t);return t.At()?t.Tt().key:null},oo.prototype.lt=function(){return new no(this.data.lt())},oo.prototype._t=function(t){return new no(this.data._t(t))},oo.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},oo.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},oo.prototype.m=function(){return this.data.m()},oo.prototype.Lt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},oo.prototype.isEqual=function(t){if(!(t instanceof oo))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.At();){var r=e.Tt().key,i=n.Tt().key;if(0!==this.i(r,i))return!1}return!0},oo.prototype.I=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},oo.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},oo.prototype.copy=function(t){var e=new oo(this.i);return e.data=t,e},oo),no=(io.prototype.Tt=function(){return this.Ot.Tt().key},io.prototype.At=function(){return this.Ot.At()},io),ro=new Wi(Gr.i);function io(t){this.Ot=t}function oo(t){this.i=t,this.data=new Wi(this.i)}var so=new Wi(Gr.i);var uo=new Wi(Gr.i);var ao=new eo(Gr.i);function ho(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ao,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var co=new eo(yi);var lo=(So.Mt=function(t){return new So(t.i)},So.prototype.has=function(t){return null!=this.xt.get(t)},So.prototype.get=function(t){return this.xt.get(t)},So.prototype.first=function(){return this.kt.ut()},So.prototype.last=function(){return this.kt.at()},So.prototype.m=function(){return this.kt.m()},So.prototype.indexOf=function(t){t=this.xt.get(t);return t?this.kt.indexOf(t):-1},Object.defineProperty(So.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),So.prototype.forEach=function(n){this.kt.ct(function(t,e){return n(t),!1})},So.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.xt.rt(t.key,t),e.kt.rt(t,null))},So.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.xt.remove(t),this.kt.remove(e)):this},So.prototype.isEqual=function(t){if(!(t instanceof So))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.lt(),n=t.kt.lt();e.At();){var r=e.Tt().key,i=n.Tt().key;if(!r.isEqual(i))return!1}return!0},So.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},So.prototype.copy=function(t,e){var n=new So;return n.i=this.i,n.xt=t,n.kt=e,n},So),fo=(Lo.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.rt(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):_r()},Lo.prototype.qt=function(){var n=[];return this.Ut.ct(function(t,e){n.push(e)}),n},Lo),po=(Ro.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ro(t,e,lo.Mt(e),i,n,r,!0,!1)},Object.defineProperty(Ro.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),Ro.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&Mu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Bt.isEqual(t.Bt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ro),yo=(No.Jt=function(t,e){var n=new Map;return n.set(t,vo.Xt(t,e)),new No(Oi.min(),n,co,ro,ho())},No),vo=(Ao.Xt=function(t,e){return new Ao(gi.U,e,ho(),ho(),ho())},Ao),go=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},mo=function(t,e){this.targetId=t,this.re=e},wo=function(t,e,n,r){void 0===n&&(n=gi.U),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},bo=(Object.defineProperty(To.prototype,"Zt",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"resumeToken",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),To.prototype.fe=function(t){0<t.k()&&(this.he=!0,this.ae=t)},To.prototype.de=function(){var n=ho(),r=ho(),i=ho();return this.ue.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:_r()}}),new vo(this.ae,this.ce,n,r,i)},To.prototype.we=function(){this.he=!1,this.ue=Do()},To.prototype.me=function(t,e){this.he=!0,this.ue=this.ue.rt(t,e)},To.prototype.Ee=function(t){this.he=!0,this.ue=this.ue.remove(t)},To.prototype.Te=function(){this.oe+=1},To.prototype.Ae=function(){--this.oe},To.prototype.Ie=function(){this.he=!0,this.ce=!0},To),Eo=(Io.prototype.ge=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof wu?this.ve(r,t.ie):t.ie instanceof bu&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},Io.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.Ae(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ae(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ie(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.Fe(t),e.fe(n.resumeToken));break;default:_r()}})},Io.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ye.forEach(function(t,e){r.Ne(e)&&n(e)})},Io.prototype.$e=function(t){var e=t.targetId,n=t.re.count,t=this.Le(e);t&&(Bi(t=t.target)?0===n?(t=new Gr(t.path),this.be(e,t,new bu(t,Oi.min()))):Ur(1===n):this.Oe(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e)))},Io.prototype.xe=function(r){var i=this,o=new Map;this.ye.forEach(function(t,e){var n=i.Le(e);n&&(t.Zt&&Bi(n.target)&&(n=new Gr(n.target.path),null!==i.Pe.get(n)||i.ke(e,n)||i.be(e,n,new bu(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=ho();this.Ve.forEach(function(t,e){var n=!0;e.Ft(function(t){t=i.Le(t);return!t||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new yo(r,o,this.pe,this.Pe,s);return this.Pe=ro,this.Ve=Oo(),this.pe=new eo(yi),t},Io.prototype.ve=function(t,e){var n;this.Ne(t)&&(n=this.ke(t,e.key)?2:0,this.Ce(t).me(e.key,n),this.Pe=this.Pe.rt(e.key,e),this.Ve=this.Ve.rt(e.key,this.Me(e.key).add(t)))},Io.prototype.be=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.ke(t,e)?r.me(e,1):r.Ee(e),this.Ve=this.Ve.rt(e,this.Me(e).delete(t)),n&&(this.Pe=this.Pe.rt(e,n)))},Io.prototype.removeTarget=function(t){this.ye.delete(t)},Io.prototype.Oe=function(t){var e=this.Ce(t).de();return this.Re.Ue(t).size+e.te.size-e.ne.size},Io.prototype.Te=function(t){this.Ce(t).Te()},Io.prototype.Ce=function(t){var e=this.ye.get(t);return e||(e=new bo,this.ye.set(t,e)),e},Io.prototype.Me=function(t){var e=this.Ve.get(t);return e||(e=new eo(yi),this.Ve=this.Ve.rt(t,e)),e},Io.prototype.Ne=function(t){var e=null!==this.Le(t);return e||Or("WatchChangeAggregator","Detected inactive target",t),e},Io.prototype.Le=function(t){var e=this.ye.get(t);return e&&e.le?null:this.Re.qe(t)},Io.prototype.Fe=function(e){var n=this;this.ye.set(e,new bo),this.Re.Ue(e).forEach(function(t){n.be(e,t,null)})},Io.prototype.ke=function(t,e){return this.Re.Ue(t).has(e)},Io);function Io(t){this.Re=t,this.ye=new Map,this.Pe=ro,this.Ve=Oo(),this.pe=new eo(yi)}function To(){this.oe=0,this.ue=Do(),this.ae=gi.U,this.ce=!1,this.he=!0}function Ao(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function No(t,e,n,r,i){this.et=t,this.zt=e,this.Kt=n,this.Ht=r,this.Yt=i}function Ro(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Bt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=u}function Lo(){this.Ut=new Wi(Gr.i)}function So(n){this.i=n?function(t,e){return n(t,e)||Gr.i(t.key,e.key)}:function(t,e){return Gr.i(t.key,e.key)},this.xt=so,this.kt=new Wi(this.i)}function Oo(){return new Wi(Gr.i)}function Do(){return new Wi(Gr.i)}function Vo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ko(t){t=jo(t.mapValue.fields.__local_write_time__.timestampValue);return new Si(t.seconds,t.nanos)}var _o=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Uo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Vo(t)?4:10:_r()}function Po(r,i){var t,e=Uo(r);if(e!==Uo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return ko(r).isEqual(ko(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=jo(r.timestampValue),t=jo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,qo(r.bytesValue).isEqual(qo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Bo((t=r).geoPointValue.latitude)===Bo(e.geoPointValue.latitude)&&Bo(t.geoPointValue.longitude)===Bo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Bo(t.integerValue)===Bo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Bo(t.doubleValue),e=Bo(e.doubleValue);return t===e?Ci(t)===Ci(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return vi(r.arrayValue.values||[],i.arrayValue.values||[],Po);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Pr(e)!==Pr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Po(e[t],n[t])))return!1;return!0}();default:return _r()}}function Co(t,e){return void 0!==(t.values||[]).find(function(t){return Po(t,e)})}function Mo(t,e){var n,r,i=Uo(t),o=Uo(e);if(i!==o)return yi(i,o);switch(i){case 0:return 0;case 1:return yi(t.booleanValue,e.booleanValue);case 2:return n=e,r=Bo(t.integerValue||t.doubleValue),n=Bo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return xo(t.timestampValue,e.timestampValue);case 4:return xo(ko(t),ko(e));case 5:return yi(t.stringValue,e.stringValue);case 6:return function(t,e){t=qo(t),e=qo(e);return t.M(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=yi(n[i],r[i]);if(0!==o)return o}return yi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=yi(Bo(i.latitude),Bo(r.latitude)))?n:yi(Bo(i.longitude),Bo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Mo(n[i],r[i]);if(o)return o}return yi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=yi(r[s],o[s]);if(0!==u)return u;u=Mo(n[r[s]],i[o[s]]);if(0!==u)return u}return yi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw _r()}}function xo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return yi(t,e);var n=jo(t),t=jo(e),e=yi(n.seconds,t.seconds);return 0!==e?e:yi(n.nanos,t.nanos)}function Fo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=jo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?qo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Gr.C(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):_r();var e}(t)}function jo(t){if(Ur(!!t),"string"!=typeof t)return{seconds:Bo(t.seconds),nanos:Bo(t.nanos)};var e=0,n=_o.exec(t);Ur(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Bo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function qo(t){return"string"==typeof t?gi.fromBase64String(t):gi.fromUint8Array(t)}function Go(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function zo(t){return t&&"integerValue"in t}function Qo(t){return!!t&&"arrayValue"in t}function Ho(t){return t&&"nullValue"in t}function Yo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wo(t){return t&&"mapValue"in t}var Ko={asc:"ASCENDING",desc:"DESCENDING"},Xo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$o=function(t,e){this.B=t,this.Be=e};function Jo(t){return{integerValue:""+t}}function Zo(t,e){if(t.Be){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ci(e)?"-0":e}}function ts(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Ci(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Jo(e):Zo(t,e);var n}function es(t,e){return t.Be?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ns(t,e){return t.Be?e.toBase64():e.toUint8Array()}function rs(t){return Ur(!!t),Oi.Y((t=jo(t),new Si(t.seconds,t.nanos)))}function is(t,e){return new jr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function os(t){t=jr.P(t);return Ur(bs(t)),t}function ss(t,e){return is(t.B,e.path)}function us(t,e){e=os(e);return Ur(e.get(1)===t.B.projectId),Ur(!e.get(3)&&!t.B.database||e.get(3)===t.B.database),new Gr(cs(e))}function as(t,e){return is(t.B,e)}function hs(t){return new jr(["projects",t.B.projectId,"databases",t.B.database]).R()}function cs(t){return Ur(4<t.length&&"documents"===t.get(4)),t.u(5)}function ls(t,e,n){return{name:ss(t,e),fields:n.proto.mapValue.fields}}function fs(t,e){var n,r,i;if(e instanceof $s)n={update:ls(t,e.key,e.value)};else if(e instanceof au)n={delete:ss(t,e.key)};else if(e instanceof Js)n={update:ls(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof ru)n={transform:{document:ss(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof As)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ns)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Ds)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Us)return{fieldPath:t.field.R(),increment:e.je};throw _r()})}};else{if(!(e instanceof hu))return _r();n={verify:ss(t,e.key)}}return e.Ge.We||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:(e=t,t=i.updateTime,es(e,t.X()))}:void 0!==i.exists?{exists:i.exists}:_r()),n}function ps(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=as(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=as(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Yo(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NAN"}};if(Ho(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Yo(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NOT_NAN"}};if(Ho(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gs(t.field),op:(e=t.op,Xo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:gs((t=t).field),direction:(t=t.dir,Ko[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Be||Pi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ys(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ys(e.endAt)),n}function ds(t){var e=4===(o=os(t.parent)).length?jr.V():cs(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Ur(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ws(t)]:void 0!==t.fieldFilter?[(n=t,Gu.create(ms(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return _r()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):_r():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new ga(ms((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Pi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=vs(n.startAt));var u=null;return n.endAt&&(u=vs(n.endAt)),new Iu(e,i,t,o,r,"F",s,u)}function ys(t){return{before:t.before,values:t.position}}function vs(t){var e=!!t.before,t=t.values||[];return new ha(t,e)}function gs(t){return{fieldPath:t.R()}}function ms(t){return qr.S(t.fieldPath)}function ws(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ms(t.unaryFilter.field);return Gu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ms(t.unaryFilter.field);return Gu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=ms(t.unaryFilter.field);return Gu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=ms(t.unaryFilter.field);return Gu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return _r()}}function bs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}l=function(){this.ze=void 0};function Es(t,e){return t instanceof Us?zo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Is,Ts,As=(n(Ls,Ts=l),Ls),Ns=(n(Rs,Is=l),Rs);function Rs(t){var e=this;return(e=Is.call(this)||this).elements=t,e}function Ls(){return null!==Ts&&Ts.apply(this,arguments)||this}function Ss(t,e){for(var n=Ms(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Po(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Os,Ds=(n(Vs,Os=l),Vs);function Vs(t){var e=this;return(e=Os.call(this)||this).elements=t,e}function ks(t,e){for(var n=Ms(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Po(t,e)})}(i[r]);return{arrayValue:{values:n}}}var _s,Us=(n(Ps,_s=l),Ps);function Ps(t,e){var n=this;return(n=_s.call(this)||this).serializer=t,n.je=e,n}function Cs(t){return Bo(t.integerValue||t.doubleValue)}function Ms(t){return Qo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function xs(t,e){this.field=t,this.transform=e}var Fs=(js.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},js.prototype.isEqual=function(t){return vi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},js);function js(t){(this.fields=t).sort(qr.i)}function Bs(t,e){this.version=t,this.transformResults=e}var qs=(Gs.He=function(){return new Gs},Gs.exists=function(t){return new Gs(void 0,t)},Gs.updateTime=function(t){return new Gs(t)},Object.defineProperty(Gs.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Gs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Gs);function Gs(t,e){this.updateTime=t,this.exists=e}function zs(t,e){return void 0!==t.updateTime?e instanceof wu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof wu}l=function(){};function Qs(t,e,n){return t instanceof $s?new wu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Js?function(t,e,n){if(!zs(t.Ge,e))return new Eu(t.key,n.version);e=eu(t,e);return new wu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof ru?function(t,e,n){if(Ur(null!=n.transformResults),!zs(t.Ge,e))return new Eu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Ur(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof wu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Ns?Ss(o,s):o instanceof Ds?ks(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=ou(t,r.data(),e);return new wu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new bu(t.key,n.version,{hasCommittedMutations:!0})}function Hs(t,e,n,r){return t instanceof $s?function(t,e){if(!zs(t.Ge,e))return e;e=Ws(e);return new wu(t.key,e,t.value,{Ye:!0})}(t,e):t instanceof Js?function(t,e){if(!zs(t.Ge,e))return e;var n=Ws(e),e=eu(t,e);return new wu(t.key,n,e,{Ye:!0})}(t,e):t instanceof ru?function(t,e,n,r){if(!zs(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof wu&&(c=n.field(a.field)),null===c&&r instanceof wu&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof As?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof Ns?Ss(h,i):h instanceof Ds?ks(h,i):(h=Es(c=h,i),i=Cs(h)+Cs(c.je),zo(h)&&zo(c.je)?Jo(i):Zo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=ou(t,i.data(),r);return new wu(t.key,i.version,r,{Ye:!0})}(t,e,r,n):(e=e,zs((t=t).Ge,e)?new bu(t.key,Oi.min()):e)}function Ys(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||vi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Ns&&e instanceof Ns||t instanceof Ds&&e instanceof Ds?vi(t.elements,e.elements,Po):t instanceof Us&&e instanceof Us?Po(t.je,e.je):t instanceof As&&e instanceof As)}))}function Ws(t){return t instanceof wu?t.version:Oi.min()}var Ks,Xs,$s=(n(tu,Xs=l),tu),Js=(n(Zs,Ks=l),Zs);function Zs(t,e,n,r){var i=this;return(i=Ks.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function tu(t,e,n){var r=this;return(r=Xs.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function eu(t,e){return n=t,e=e instanceof wu?e.data():cu.empty(),r=new lu(e),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Je();var n,r}var nu,ru=(n(iu,nu=l),iu);function iu(t,e){var n=this;return(n=nu.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=qs.exists(!0),n}function ou(t,e,n){for(var r=new lu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var su,uu,au=(n(yu,uu=l),yu),hu=(n(du,su=l),du),cu=(pu.empty=function(){return new pu({mapValue:{}})},pu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Wo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},pu.prototype.isEqual=function(t){return Po(this.proto,t.proto)},pu),lu=(fu.prototype.set=function(t,e){return this.tn(t,e),this},fu.prototype.delete=function(t){return this.tn(t,null),this},fu.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Uo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},fu.prototype.Je=function(){var t=this.en(qr.V(),this.Ze);return null!=t?new cu(t):this.Xe},fu.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Wo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},fu);function fu(t){void 0===t&&(t=cu.empty()),this.Xe=t,this.Ze=new Map}function pu(t){this.proto=t}function du(t,e){var n=this;return(n=su.call(this)||this).key=t,n.Ge=e,n.type=4,n}function yu(t,e){var n=this;return(n=uu.call(this)||this).key=t,n.Ge=e,n.type=3,n}var vu,gu,mu,l=function(t,e){this.key=t,this.version=e},wu=(n(Nu,mu=l),Nu.prototype.field=function(t){return this.nn.field(t)},Nu.prototype.data=function(){return this.nn},Nu.prototype.sn=function(){return this.nn.proto},Nu.prototype.isEqual=function(t){return t instanceof Nu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Nu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Nu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Nu),bu=(n(Au,gu=l),Au.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Au.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Au.prototype.isEqual=function(t){return t instanceof Au&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Au),Eu=(n(Tu,vu=l),Tu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Tu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Tu.prototype.isEqual=function(t){return t instanceof Tu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Tu),Iu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.on=null,this.un=null,this.startAt,this.endAt};function Tu(){return null!==vu&&vu.apply(this,arguments)||this}function Au(t,e,n){var r=this;return(r=gu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Nu(t,e,n,r){var i=this;return(i=mu.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Ru(t){return new Iu(t)}function Lu(t){return!Pi(t.limit)&&"F"===t.limitType}function Su(t){return!Pi(t.limit)&&"L"===t.limitType}function Ou(t){return 0<t.rn.length?t.rn[0].field:null}function Du(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.an())return r.field}return null}function Vu(t){return null!==t.collectionGroup}function ku(t){var e=t;if(null===e.on){e.on=[];var n=Du(e),t=Ou(e);if(null!==n&&null===t)n.g()||e.on.push(new ga(n)),e.on.push(new ga(qr.v(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.on.push(s),s.field.g()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.on.push(new ga(qr.v(),n)))}}return e.on}function _u(t){var e=t;if(!e.un)if("F"===e.limitType)e.un=xi(e.path,e.collectionGroup,ku(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ku(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ga(o.field,s))}var u=e.endAt?new ha(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ha(e.startAt.position,!e.startAt.before):null;e.un=xi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function Uu(t,e,n){return new Iu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Pu(t,e){return new Iu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function Cu(t,e){return new Iu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function Mu(t,e){return ji(_u(t),_u(e))&&t.limitType===e.limitType}function xu(t){return Fi(_u(t))+"|lt:"+t.limitType}function Fu(t){return"Query(target="+(e=_u(t),n=e.path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+Fo(t.value)}).join(", ")+"]"),Pi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+da(e.startAt)),e.endAt&&(n+=", endAt: "+da(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function ju(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):Gr.F(e.path)?e.path.isEqual(n):e.path.A(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.g()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ya(t.startAt,ku(t),n))&&(!t.endAt||!ya(t.endAt,ku(t),n)));var e,n}function Bu(u){return function(t,e){for(var n=!1,r=0,i=ku(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.g()?Gr.i(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Mo(n,t):_r()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return _r()}}(o,t,e);if(0!==s)return s;n=n||o.field.g()}return 0}}var qu,Gu=(n(zu,qu=function(){}),zu.create=function(t,e,n){if(t.g())return"in"===e||"not-in"===e?this.cn(t,e,n):new Wu(t,e,n);if(Ho(n)){if("=="!==e&&"!="!==e)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new zu(t,e,n)}if(Yo(n)){if("=="!==e&&"!="!==e)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new zu(t,e,n)}return"array-contains"===e?new oa(t,n):"in"===e?new sa(t,n):"not-in"===e?new ua(t,n):"array-contains-any"===e?new aa(t,n):new zu(t,e,n)},zu.cn=function(t,e,n){return new("in"===e?Ku:Xu)(t,n)},zu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.hn(Mo(t,this.value)):null!==t&&Uo(this.value)===Uo(t)&&this.hn(Mo(t,this.value))},zu.prototype.hn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return _r()}},zu.prototype.an=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},zu);function zu(t,e,n){var r=this;return(r=qu.call(this)||this).field=t,r.op=e,r.value=n,r}var Qu,Hu,Yu,Wu=(n(Zu,Yu=Gu),Zu.prototype.matches=function(t){t=Gr.i(t.key,this.key);return this.hn(t)},Zu),Ku=(n(Ju,Hu=Gu),Ju.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ju),Xu=(n($u,Qu=Gu),$u.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},$u);function $u(t,e){var n=this;return(n=Qu.call(this,t,"not-in",e)||this).keys=ta(0,e),n}function Ju(t,e){var n=this;return(n=Hu.call(this,t,"in",e)||this).keys=ta(0,e),n}function Zu(t,e,n){var r=this;return(r=Yu.call(this,t,e,n)||this).key=Gr.C(n.referenceValue),r}function ta(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Gr.C(t.referenceValue)})}var ea,na,ra,ia,oa=(n(pa,ia=Gu),pa.prototype.matches=function(t){t=t.field(this.field);return Qo(t)&&Co(t.arrayValue,this.value)},pa),sa=(n(fa,ra=Gu),fa.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Co(this.value.arrayValue,t)},fa),ua=(n(la,na=Gu),la.prototype.matches=function(t){if(Co(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Co(this.value.arrayValue,t)},la),aa=(n(ca,ea=Gu),ca.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Qo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Co(e.value.arrayValue,t)})},ca),ha=function(t,e){this.position=t,this.before=e};function ca(t,e){return ea.call(this,t,"array-contains-any",e)||this}function la(t,e){return na.call(this,t,"not-in",e)||this}function fa(t,e){return ra.call(this,t,"in",e)||this}function pa(t,e){return ia.call(this,t,"array-contains",e)||this}function da(t){return(t.before?"b":"a")+":"+t.position.map(Fo).join(",")}function ya(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.g()?Gr.i(Gr.C(s.referenceValue),n.key):Mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function va(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Po(t.position[n],e.position[n]))return!1;return!0}var ga=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ma(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var wa=(Ia.prototype.reset=function(){this.mn=0},Ia.prototype.An=function(){this.mn=this.wn},Ia.prototype.In=function(t){var e=this;this.cancel();var n=Math.floor(this.mn+this.Rn()),r=Math.max(0,Date.now()-this.Tn),i=Math.max(0,n-r);0<i&&Or("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.mn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this.ln.yn(this._n,i,function(){return e.Tn=Date.now(),t()}),this.mn*=this.dn,this.mn<this.fn&&(this.mn=this.fn),this.mn>this.wn&&(this.mn=this.wn)},Ia.prototype.Pn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},Ia.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},Ia.prototype.Rn=function(){return(Math.random()-.5)*this.mn},Ia),ba=(Ea.prototype.catch=function(t){return this.next(void 0,t)},Ea.prototype.next=function(r,i){var o=this;return this.bn&&_r(),this.bn=!0,this.vn?this.error?this.Sn(i,this.error):this.Dn(r,this.result):new Ea(function(e,n){o.pn=function(t){o.Dn(r,t).next(e,n)},o.gn=function(t){o.Sn(i,t).next(e,n)}})},Ea.prototype.Cn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ea.prototype.Nn=function(t){try{var e=t();return e instanceof Ea?e:Ea.resolve(e)}catch(t){return Ea.reject(t)}},Ea.prototype.Dn=function(t,e){return t?this.Nn(function(){return t(e)}):Ea.resolve(e)},Ea.prototype.Sn=function(t,e){return t?this.Nn(function(){return t(e)}):Ea.reject(e)},Ea.resolve=function(n){return new Ea(function(t,e){t(n)})},Ea.reject=function(n){return new Ea(function(t,e){e(n)})},Ea.Fn=function(t){return new Ea(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ea.$n=function(t){for(var n=Ea.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Ea.resolve(t):e()})}(r[e]);return n},Ea.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Fn(i)},Ea);function Ea(t){var e=this;this.pn=null,this.gn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.bn=!1,t(function(t){e.vn=!0,e.result=t,e.pn&&e.pn(t)},function(t){e.vn=!0,e.error=t,e.gn&&e.gn(t)})}function Ia(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ln=t,this._n=e,this.fn=n,this.dn=r,this.wn=i,this.mn=0,this.En=null,this.Tn=Date.now(),this.reset()}function Ta(t){return"IndexedDbTransactionError"===t.name}function Aa(){return"undefined"!=typeof document?document:null}var Na=(Sa.Mn=function(t,e,n,r,i){i=new Sa(t,e,Date.now()+n,r,i);return i.start(n),i},Sa.prototype.start=function(t){var e=this;this.Un=setTimeout(function(){return e.qn()},t)},Sa.prototype.Vn=function(){return this.qn()},Sa.prototype.cancel=function(t){null!==this.Un&&(this.clearTimeout(),this.kn.reject(new Ar(Tr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Sa.prototype.qn=function(){var e=this;this.Ln.Bn(function(){return null!==e.Un?(e.clearTimeout(),e.op().then(function(t){return e.kn.resolve(t)})):Promise.resolve()})},Sa.prototype.clearTimeout=function(){null!==this.Un&&(this.xn(this),clearTimeout(this.Un),this.Un=null)},Sa),Ra=(Object.defineProperty(La.prototype,"Xn",{get:function(){return this.Wn},enumerable:!1,configurable:!0}),La.prototype.Bn=function(t){this.enqueue(t)},La.prototype.Zn=function(t){this.ts(),this.es(t)},La.prototype.ns=function(){var t;this.Wn||(this.Wn=!0,(t=Aa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Jn))},La.prototype.enqueue=function(t){return this.ts(),this.Wn?new Promise(function(t){}):this.es(t)},La.prototype.ss=function(t){var e=this;this.jn.push(t),this.Bn(function(){return e.rs()})},La.prototype.rs=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.jn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.jn[0]()];case 2:return t.sent(),this.jn.shift(),this.Yn.reset(),[3,4];case 3:if(!Ta(e=t.sent()))throw e;return Or("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.jn.length&&this.Yn.In(function(){return n.rs()}),t.label=5;case 5:return[2]}})})},La.prototype.es=function(t){var r=this,e=this.Qn.then(function(){return r.Kn=!0,t().catch(function(t){throw r.zn=t,r.Kn=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Kn=!1,t})});return this.Qn=e},La.prototype.yn=function(t,e,n){var r=this;this.ts(),-1<this.Hn.indexOf(t)&&(e=0);n=Na.Mn(this,t,e,n,function(t){return r.os(t)});return this.Gn.push(n),n},La.prototype.ts=function(){this.zn&&_r()},La.prototype.us=function(){},La.prototype.cs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Qn];case 1:t.sent(),t.label=2;case 2:if(e!==this.Qn)return[3,0];t.label=3;case 3:return[2]}})})},La.prototype.hs=function(t){for(var e=0,n=this.Gn;e<n.length;e++)if(n[e]._n===t)return!0;return!1},La.prototype.ls=function(r){var i=this;return this.cs().then(function(){i.Gn.sort(function(t,e){return t.On-e.On});for(var t=0,e=i.Gn;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n._n===r)break}return i.cs()})},La.prototype._s=function(t){this.Hn.push(t)},La.prototype.os=function(t){t=this.Gn.indexOf(t);this.Gn.splice(t,1)},La);function La(){var e=this;this.Qn=Promise.resolve(),this.jn=[],this.Wn=!1,this.Gn=[],this.zn=null,this.Kn=!1,this.Hn=[],this.Yn=new wa(this,"async_queue_retry"),this.Jn=function(){var t=Aa();t&&Or("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Yn.Pn()};var t=Aa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Jn)}function Sa(t,e,n,r,i){this.Ln=t,this._n=e,this.On=n,this.op=r,this.xn=i,this.kn=new ma,this.then=this.kn.promise.then.bind(this.kn.promise),this.kn.promise.catch(function(t){})}function Oa(t,e){if(Dr("AsyncQueue",e+": "+t),Ta(t))return new Ar(Tr.UNAVAILABLE,e+": "+t);throw t}function Da(){this.fs=void 0,this.listeners=[]}function Va(){this.queries=new Li(xu,Mu),this.onlineState="Unknown",this.ds=new Set}function ka(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Da),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ws(n)];case 2:return o.fs=t.sent(),[3,4];case 3:return o=t.sent(),o=Oa(o,"Initialization of query '"+Fu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Es(e.onlineState),i.fs&&u.Ts(i.fs)&&Ua(e),[2]}})})}function _a(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.As(n))]:[2]})})}function Ua(t){t.ds.forEach(function(t){t.next()})}var Pa=(xa.prototype.Ts=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new po(t.query,t.docs,t.Bt,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Rs?this.Ps(t)&&(this.Is.next(t),o=!0):this.Vs(t,this.onlineState)&&(this.ps(t),o=!0),this.ys=t,o},xa.prototype.onError=function(t){this.Is.error(t)},xa.prototype.Es=function(t){this.onlineState=t;var e=!1;return this.ys&&!this.Rs&&this.Vs(this.ys,t)&&(this.ps(this.ys),e=!0),e},xa.prototype.Vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.gs&&n||t.docs.m()&&"Offline"!==e)},xa.prototype.Ps=function(t){if(0<t.docChanges.length)return!0;var e=this.ys&&this.ys.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},xa.prototype.ps=function(t){t=po.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Rs=!0,this.Is.next(t)},xa),Ca=(Ma.prototype.vs=function(){return null!=this.uid},Ma.prototype.bs=function(){return this.vs()?"uid:"+this.uid:"anonymous-user"},Ma.prototype.isEqual=function(t){return t.uid===this.uid},Ma);function Ma(t){this.uid=t}function xa(t,e,n){this.query=t,this.Is=e,this.Rs=!1,this.ys=null,this.onlineState="Unknown",this.options=n||{}}Ca.UNAUTHENTICATED=new Ca(null),Ca.Ss=new Ca("google-credentials-uid"),Ca.Ds=new Ca("first-party-uid");var Fa=(ja.prototype.Ns=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ja.prototype.next=function(){var t=++this.previousValue;return this.Fs&&this.Fs(t),t},ja);function ja(t,e){var n=this;this.previousValue=t,e&&(e.Cs=function(t){return n.Ns(t)},this.Fs=function(t){return e.$s(t)})}Fa.Ls=-1;var Ba=(Wa.prototype.Os=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Wa.prototype.xs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Wa.prototype.ks=function(){var t={activeTargetIds:this.activeTargetIds.I(),updateTimeMs:Date.now()};return JSON.stringify(t)},Wa),qa=(Ya.prototype.Bs=function(t){},Ya.prototype.Qs=function(t,e,n){},Ya.prototype.js=function(t){return this.Ms.Os(t),this.Us[t]||"not-current"},Ya.prototype.Ws=function(t,e,n){this.Us[t]=e},Ya.prototype.Gs=function(t){this.Ms.xs(t)},Ya.prototype.zs=function(t){return this.Ms.activeTargetIds.has(t)},Ya.prototype.Ks=function(t){delete this.Us[t]},Ya.prototype.Hs=function(){return this.Ms.activeTargetIds},Ya.prototype.Ys=function(t){return this.Ms.activeTargetIds.has(t)},Ya.prototype.start=function(){return this.Ms=new Ba,Promise.resolve()},Ya.prototype.Js=function(t,e,n){},Ya.prototype.Xs=function(t){},Ya.prototype.Zs=function(){},Ya.prototype.$s=function(t){},Ya.prototype.ti=function(){},Ya),Ga=(Ha.prototype.ni=function(t,e,n){for(var r=n.si,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Qs(o,e,r[i]))}return e},Ha.prototype.ii=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Hs(i,e,e,this.ei))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Hs(a,e,o,this.ei))}return e},Ha.prototype.ri=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ii(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Ha.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ho())},Ha.prototype.isEqual=function(t){return this.batchId===t.batchId&&vi(this.mutations,t.mutations,Ys)&&vi(this.baseMutations,t.baseMutations,Ys)},Ha),za=(Qa.from=function(t,e,n){Ur(t.mutations.length===n.length);for(var r=uo,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new Qa(t,e,n,r)},Qa);function Qa(t,e,n,r){this.batch=t,this.oi=e,this.si=n,this.ui=r}function Ha(t,e,n,r){this.batchId=t,this.ei=e,this.baseMutations=n,this.mutations=r}function Ya(){this.Ms=new Ba,this.Us={},this.qs=null,this.Cs=null}function Wa(){this.activeTargetIds=co}function Ka(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{value:void 0,done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function Xa(t,e){if(t instanceof Uint8Array)return Ka(t,e);if(t instanceof ArrayBuffer)return Ka(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function $a(t){return new $o(t,!0)}var Ja=(rh.prototype.ai=function(){return"metadata"in this.payload},rh),Za=(nh._i=function(t,e){return new nh(Xa(t,10240),e)},nh.prototype.close=function(){return this.ci.cancel()},nh.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},nh.prototype.fi=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.li())]}})})},nh.prototype.li=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.di()];case 1:return null===(e=t.sent())?[2,null]:(r=this.hi.decode(e),n=Number(r),isNaN(n)&&this.wi("length string ("+r+") is not valid number"),[4,this.mi(n)]);case 2:return r=t.sent(),[2,new Ja(JSON.parse(r),e.length+n)]}})})},nh.prototype.Ei=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},nh.prototype.di=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.Ei()<0?[4,this.Ti()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Ei())<0&&this.wi("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},nh.prototype.mi=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Ti()]:[3,3];case 1:t.sent()&&this.wi("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.hi.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},nh.prototype.wi=function(t){throw this.ci.cancel(),new Error("Invalid bundle format: "+t)},nh.prototype.Ti=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.ci.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},nh),th=(eh.prototype.Ai=function(t){return us(this.serializer,t)},eh.prototype.Ii=function(t){return t.metadata.exists?(e=this.serializer,n=t.document,r=us(e,n.name),e=rs(n.updateTime),n=new cu({mapValue:{fields:n.fields}}),new wu(r,e,n,{hasCommittedMutations:!1})):new bu(this.Ai(t.metadata.name),this.Ri(t.metadata.readTime));var e,n,r},eh.prototype.Ri=rs,eh);function eh(t){this.serializer=t}function nh(t,e){var n=this;this.ci=t,this.serializer=e,this.metadata=new ma,this.buffer=new Uint8Array,this.hi=new TextDecoder("utf-8"),this.li().then(function(t){t&&t.ai()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function rh(t,e){this.payload=t,this.byteLength=e}function ih(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function oh(t,e){this.progress=t,this.yi=e}var sh=(ph.prototype.pi=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},ph.prototype.gi=function(t){for(var e=new Map,n=new th(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Ai(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var h=a[u],c=(e.get(h)||ho()).add(s);e.set(h,c)}}return e},ph.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c,l;return v(this,function(t){switch(t.label){case 0:for(e=new th((n=f).serializer),r=ho(),i=ro,o=uo,s=0,u=p;s<u.length;s++)a=u[s],h=e.Ai(a.metadata.name),a.document&&(r=r.add(h)),i=i.rt(h,e.Ii(a)),o=o.rt(h,e.Ri(a.metadata.readTime));return c=n.bi.vi({Si:!0}),[4,Sh(n,_u(Ru(jr.P("__bundle__/docs/"+d))))];case 1:return l=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Lh(e,c,i,Oi.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.Ci.Di(e,l.targetId).next(function(){return n.Ci.Ni(e,r,l.targetId)}).next(function(){return n.$i.Fi(e,t)})})})]}})})}(this.Vi,this.documents,this.Pi.id)];case 1:e=t.sent(),n=this.gi(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=ho()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Sh(e,_u(yh(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=rs(i.readTime);if(0<=n.et.M(e))return r.br.Jr(t,i);e=n.st(gi.U,e);return r.Rr=r.Rr.rt(e.targetId,e),r.Ci.Ur(t,e).next(function(){return r.Ci.Di(t,n.targetId)}).next(function(){return r.Ci.Ni(t,o,n.targetId)}).next(function(){return r.br.Jr(t,i)})})]}})})}(this.Vi,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new oh(Object.assign({},this.progress),e))]}})})},ph),uh=(fh.prototype.ki=function(e,n){var r=this;return this.Oi.Mi(e,n).next(function(t){return r.Ui(e,n,t)})},fh.prototype.Ui=function(t,r,i){return this.Li.qi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ii(r,t);return t})},fh.prototype.Bi=function(t,e,i){var o=ro;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ii(t,e);o=o.rt(t,e)}),o},fh.prototype.Qi=function(e,t){var n=this;return this.Li.getEntries(e,t).next(function(t){return n.Fi(e,t)})},fh.prototype.Fi=function(e,r){var i=this;return this.Oi.ji(e,r).next(function(t){var t=i.Bi(e,r,t),n=ro;return t.forEach(function(t,e){e=e||new bu(t,Oi.min()),n=n.rt(t,e)}),n})},fh.prototype.Wi=function(t,e,n){return r=e,Gr.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Gi(t,e.path):Vu(e)?this.zi(t,e,n):this.Ki(t,e,n);var r},fh.prototype.Gi=function(t,e){return this.ki(t,new Gr(e)).next(function(t){var e=so;return t instanceof wu&&(e=e.rt(t.key,t)),e})},fh.prototype.zi=function(n,r,i){var o=this,s=r.collectionGroup,u=so;return this.xi.Hi(n,s).next(function(t){return ba.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Iu(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Ki(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},fh.prototype.Ki=function(e,n,t){var h,c,r=this;return this.Li.Wi(e,n,t).next(function(t){return h=t,r.Oi.Yi(e,n)}).next(function(t){return c=t,r.Ji(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),a=Hs(s,a,a,r.ei);h=a instanceof wu?h.rt(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){ju(n,e)||(h=h.remove(t))}),h})},fh.prototype.Ji=function(t,e,n){for(var r=ho(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Js&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Li.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof wu&&(h=h.rt(t,e))}),h})},fh),ah=(lh.tr=function(t,e){for(var n=ho(),r=ho(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new lh(t,e.fromCache,n,r)},lh),hh=(ch.ir=function(t){return new ch(t,ch.rr,ch.ur)},ch);function ch(t,e,n){this.er=t,this.nr=e,this.sr=n}function lh(t,e,n,r){this.targetId=t,this.fromCache=e,this.Xi=n,this.Zi=r}function fh(t,e,n){this.Li=t,this.Oi=e,this.xi=n}function ph(t,e,n){this.Pi=t,this.Vi=e,this.serializer=n,this.queries=[],this.documents=[],this.progress=ih(t)}hh.ar=-1,hh.cr=1048576,hh.hr=41943040,hh.rr=10,hh.ur=1e3,hh.lr=new hh(hh.hr,hh.rr,hh.ur),hh._r=new hh(hh.ar,0,0);function dh(t){this.dr=t}function yh(t){var e=ds({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Uu(e,e.limit,"L"):e}var vh=(Th.prototype.mr=function(t,e){return this.wr.add(e),ba.resolve()},Th.prototype.Hi=function(t,e){return ba.resolve(this.wr.getEntries(e))},Th),gh=(Ih.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new eo(jr.i),t=!r.has(n);return this.index[e]=r.add(n),t},Ih.prototype.has=function(t){var e=t._(),t=t.h(),e=this.index[e];return e&&e.has(t)},Ih.prototype.getEntries=function(t){return(this.index[t]||new eo(jr.i)).I()},Ih),mh=(Eh.prototype.next=function(){return this.Er+=2,this.Er},Eh.Tr=function(){return new Eh(0)},Eh.Ar=function(){return new Eh(-1)},Eh),wh=(bh.prototype.Cr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Nr(t,n.Rr)})},bh);function bh(t,e,n,r){this.persistence=t,this.Ir=e,this.serializer=r,this.Rr=new Wi(yi),this.yr=new Li(Fi,ji),this.Pr=Oi.min(),this.Oi=t.Vr(n),this.bi=t.pr(),this.Ci=t.gr(),this.$i=new uh(this.bi,this.Oi,this.persistence.vr()),this.br=t.Sr(),this.Ir.Dr(this.$i)}function Eh(t){this.Er=t}function Ih(){this.index={}}function Th(){this.wr=new gh}function Ah(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=c.batch.keys(),h=l.bi.vi({Si:!0});return e=l,r=t,o=h,s=(i=c).batch,n=s.keys(),u=ba.resolve(),n.forEach(function(n){u=u.next(function(){return o.qi(r,n)}).next(function(t){var e=t,t=i.ui.get(n);Ur(null!==t),(!e||e.version.M(t)<0)&&(e=s.ni(n,e,i))&&o.Fr(e,i.oi)})}),u.next(function(){return e.Oi.$r(r,s)}).next(function(){return h.apply(t)}).next(function(){return l.Oi.Lr(t)}).next(function(){return l.$i.Qi(t,a)})})}function Nh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ci.Or(t)})}function Rh(t,r){var a=t,h=r.et,c=a.Rr;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.bi.vi({Si:!0});c=a.Rr;var u=[];r.zt.forEach(function(t,e){var n,r,i,o=c.get(e);o&&(u.push(a.Ci.kr(s,t.ne,e).next(function(){return a.Ci.Ni(s,t.te,e)})),0<(i=t.resumeToken).k()&&(n=o.st(i,h).nt(s.Mr),c=c.rt(e,n),r=o,i=t,Ur(0<(o=n).resumeToken.k()),(0===r.resumeToken.k()||3e8<=o.et.J()-r.et.J()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(a.Ci.Ur(s,n))))});var e,n=ro;return r.Ht.forEach(function(t,e){r.Yt.has(t)&&u.push(a.persistence.Br.qr(s,t))}),u.push(Lh(s,t,r.Ht,h,void 0).next(function(t){n=t})),h.isEqual(Oi.min())||(e=a.Ci.Or(s).next(function(t){return a.Ci.Qr(s,s.Mr,h)}),u.push(e)),ba.Fn(u).next(function(){return t.apply(s)}).next(function(){return a.$i.Fi(s,n)})}).then(function(t){return a.Rr=c,t})}function Lh(t,s,e,u,a){var n=ho();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=ro;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof bu&&e.version.isEqual(Oi.min())?(s.jr(t,r),o=o.rt(t,e)):null==n||0<e.version.M(n.version)||0===e.version.M(n.version)&&n.hasPendingWrites?(s.Fr(e,r),o=o.rt(t,e)):Or("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Sh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ci.Gr(e,r).next(function(t){return t?(n=t,ba.resolve(n)):i.Ci.zr(e).next(function(t){return n=new zi(r,t,0,e.Mr),i.Ci.Kr(e,n).next(function(){return n})})})}).then(function(t){var e=i.Rr.get(t.targetId);return(null===e||0<t.et.M(e.et))&&(i.Rr=i.Rr.rt(t.targetId,t),i.yr.set(r,t.targetId)),t})}function Oh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Rr.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Br.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ta(r=t.sent()))throw r;return Or("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Rr=e.Rr.remove(o),e.yr.delete(n.target),[2]}})})}function Dh(t,o,s){var u=t,a=Oi.min(),h=ho();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=_u(o),(void 0!==(t=(i=t).yr.get(r))?ba.resolve(i.Rr.get(t)):i.Ci.Gr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ci.Hr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Ir.Wi(e,o,s?a:Oi.min(),s?h:ho())}).next(function(t){return{documents:t,Yr:h}});var t,n,r,i})}function Vh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Tr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Or("LocalStore","Unexpectedly lost primary lease"),[2]})})}function kh(t,e){this.user=e,this.type="OAuth",this.fo={},this.fo.Authorization="Bearer "+t}function _h(t,e,n,r,i){var o=this;this.Vi=t,this.du=e,this.Ln=n,this.wu={},this.mu=[],this.Eu=new Map,this.Tu=new Set,this.Au=[],this.Iu=i,this.Iu.Ru(function(t){n.Bn(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return pc(this)?(Or("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Tu.add(4),[4,oc(e)];case 1:return t.sent(),e.yu.set("Unknown"),e.Tu.delete(4),[4,ic(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.yu=new Hh(n,r)}var Uh,Ph,Ch,Mh=(rc.prototype.m=function(){return this.Xr.m()},rc.prototype.so=function(t,e){e=new xh(t,e);this.Xr=this.Xr.add(e),this.eo=this.eo.add(e)},rc.prototype.io=function(t,e){var n=this;t.forEach(function(t){return n.so(t,e)})},rc.prototype.ro=function(t,e){this.oo(new xh(t,e))},rc.prototype.uo=function(t,e){var n=this;t.forEach(function(t){return n.ro(t,e)})},rc.prototype.ao=function(t){var e=this,n=new Gr(new jr([])),r=new xh(n,t),t=new xh(n,t+1),i=[];return this.eo.Nt([r,t],function(t){e.oo(t),i.push(t.key)}),i},rc.prototype.co=function(){var e=this;this.Xr.forEach(function(t){return e.oo(t)})},rc.prototype.oo=function(t){this.Xr=this.Xr.delete(t),this.eo=this.eo.delete(t)},rc.prototype.ho=function(t){var e=new Gr(new jr([])),n=new xh(e,t),t=new xh(e,t+1),r=ho();return this.eo.Nt([n,t],function(t){r=r.add(t.key)}),r},rc.prototype.lo=function(t){var e=new xh(t,0),e=this.Xr.$t(e);return null!==e&&t.isEqual(e.key)},rc),xh=(nc.Zr=function(t,e){return Gr.i(t.key,e.key)||yi(t._o,e._o)},nc.no=function(t,e){return yi(t._o,e._o)||Gr.i(t.key,e.key)},nc),Fh=(ec.prototype.getToken=function(){return Promise.resolve(null)},ec.prototype.mo=function(){},ec.prototype.Eo=function(t){(this.wo=t)(Ca.UNAUTHENTICATED)},ec.prototype.To=function(){this.wo=null},ec),jh=(tc.prototype.getToken=function(){var e=this,n=this.Ro,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Ro!==n?(Or("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ur("string"==typeof t.accessToken),new kh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},tc.prototype.mo=function(){this.forceRefresh=!0},tc.prototype.Eo=function(t){this.wo=t,this.Io&&t(this.currentUser)},tc.prototype.To=function(){this.auth&&this.auth.removeAuthTokenListener(this.Ao),this.Ao=null,this.wo=null},tc.prototype.yo=function(){var t=this.auth&&this.auth.getUid();return Ur(null===t||"string"==typeof t),new Ca(t)},tc),Bh=(Object.defineProperty(Zh.prototype,"fo",{get:function(){var t={"X-Goog-AuthUser":this.Vo},e=this.Po.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Zh),qh=(Jh.prototype.getToken=function(){return Promise.resolve(new Bh(this.Po,this.Vo))},Jh.prototype.Eo=function(t){t(Ca.Ds)},Jh.prototype.To=function(){},Jh.prototype.mo=function(){},Jh),l=($h.prototype.Co=function(){return 1===this.state||2===this.state||4===this.state},$h.prototype.No=function(){return 2===this.state},$h.prototype.start=function(){3!==this.state?this.auth():this.Fo()},$h.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Co()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},$h.prototype.$o=function(){this.state=0,this.Yn.reset()},$h.prototype.Lo=function(){var t=this;this.No()&&null===this.Do&&(this.Do=this.ln.yn(this.po,6e4,function(){return t.Oo()}))},$h.prototype.xo=function(t){this.ko(),this.stream.send(t)},$h.prototype.Oo=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.No()?[2,this.close(0)]:[2]})})},$h.prototype.ko=function(){this.Do&&(this.Do.cancel(),this.Do=null)},$h.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ko(),this.Yn.cancel(),this.So++,3!==e?this.Yn.reset():n&&n.code===Tr.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Yn.An()):n&&n.code===Tr.UNAUTHENTICATED&&this.bo.mo(),null!==this.stream&&(this.Mo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Uo(n)];case 1:return t.sent(),[2]}})})},$h.prototype.Mo=function(){},$h.prototype.auth=function(){var n=this;this.state=1;var t=this.qo(this.So),e=this.So;this.bo.getToken().then(function(t){n.So===e&&n.Bo(t)},function(e){t(function(){var t=new Ar(Tr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Qo(t)})})},$h.prototype.Bo=function(t){var e=this,n=this.qo(this.So);this.stream=this.jo(t),this.stream.Wo(function(){n(function(){return e.state=2,e.listener.Wo()})}),this.stream.Uo(function(t){n(function(){return e.Qo(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},$h.prototype.Fo=function(){var t=this;this.state=4,this.Yn.In(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},$h.prototype.Qo=function(t){return Or("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},$h.prototype.qo=function(e){var n=this;return function(t){n.ln.Bn(function(){return n.So===e?t():(Or("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},$h),Gh=(n(Xh,Ch=l),Xh.prototype.jo=function(t){return this.vo.Go("Listen",t)},Xh.prototype.onMessage=function(t){this.Yn.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:_r(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Be?(Ur(void 0===o||"string"==typeof o),gi.fromBase64String(o||"")):(Ur(void 0===o||o instanceof Uint8Array),gi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Tr.UNKNOWN:Yi(s.code),new Ar(o,s.message||"")),r=new wo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=us(t,u.document.name),a=rs(u.document.updateTime),s=new cu({mapValue:{fields:u.document.fields}}),a=new wu(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new go(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=us(t,u.document),h=u.readTime?rs(u.readTime):Oi.min(),h=new bu(a,h),u=u.removedTargetIds||[];r=new go([],u,h.key,h)}else if("documentRemove"in e){e.documentRemove;h=e.documentRemove;h.document;var c=us(t,h.document),h=h.removedTargetIds||[];r=new go([],h,c,null)}else{if(!("filter"in e))return _r();e.filter;c=e.filter;c.targetId;e=c.count||0,e=new qi(e),c=c.targetId;r=new mo(c,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return Oi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?rs(t.readTime):Oi.min()}(t);return this.listener.zo(e,t)},Xh.prototype.Ko=function(t){var e,n,r,i={};i.database=hs(this.serializer),i.addTarget=(e=this.serializer,(r=Bi(r=(n=t).target)?{documents:{documents:[as(e,r.path)]}}:{query:ps(e,r)}).targetId=n.targetId,0<n.resumeToken.k()?r.resumeToken=ns(e,n.resumeToken):0<n.et.M(Oi.min())&&(r.readTime=es(e,n.et.X())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _r()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.xo(i)},Xh.prototype.Ho=function(t){var e={};e.database=hs(this.serializer),e.removeTarget=t,this.xo(e)},Xh),zh=(n(Kh,Ph=l),Object.defineProperty(Kh.prototype,"Jo",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),Kh.prototype.start=function(){this.Yo=!1,this.lastStreamToken=void 0,Ph.prototype.start.call(this)},Kh.prototype.Mo=function(){this.Yo&&this.Xo([])},Kh.prototype.jo=function(t){return this.vo.Go("Write",t)},Kh.prototype.onMessage=function(t){if(Ur(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Yo){this.Yn.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Ur(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?rs(t.updateTime):rs(e);n.isEqual(Oi.min())&&(n=rs(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Bs(n,e)}(t,r)})):[]),n=rs(t.commitTime);return this.listener.Zo(n,e)}var n,r;return Ur(!t.writeResults||0===t.writeResults.length),this.Yo=!0,this.listener.tu()},Kh.prototype.eu=function(){var t={};t.database=hs(this.serializer),this.xo(t)},Kh.prototype.Xo=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return fs(e.serializer,t)})};this.xo(t)},Kh),Qh=(n(Wh,Uh=function(){}),Wh.prototype.su=function(){if(this.nu)throw new Ar(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},Wh.prototype.iu=function(e,n,r){var i=this;return this.su(),this.credentials.getToken().then(function(t){return i.vo.iu(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.mo(),t})},Wh.prototype.ru=function(e,n,r){var i=this;return this.su(),this.credentials.getToken().then(function(t){return i.vo.ru(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.mo(),t})},Wh.prototype.terminate=function(){this.nu=!1},Wh),Hh=(Yh.prototype.cu=function(){var t=this;0===this.ou&&(this.hu("Unknown"),this.uu=this.Ln.yn("online_state_timeout",1e4,function(){return t.uu=null,t.lu("Backend didn't respond within 10 seconds."),t.hu("Offline"),Promise.resolve()}))},Yh.prototype._u=function(t){"Online"===this.state?this.hu("Unknown"):(this.ou++,1<=this.ou&&(this.fu(),this.lu("Connection failed 1 times. Most recent error: "+t.toString()),this.hu("Offline")))},Yh.prototype.set=function(t){this.fu(),this.ou=0,"Online"===t&&(this.au=!1),this.hu(t)},Yh.prototype.hu=function(t){t!==this.state&&(this.state=t,this.qs(t))},Yh.prototype.lu=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.au?(Dr(t),this.au=!1):Or("OnlineStateTracker",t)},Yh.prototype.fu=function(){null!==this.uu&&(this.uu.cancel(),this.uu=null)},Yh);function Yh(t,e){this.Ln=t,this.qs=e,this.state="Unknown",this.ou=0,this.uu=null,this.au=!0}function Wh(t,e,n){var r=this;return(r=Uh.call(this)||this).credentials=t,r.vo=e,r.serializer=n,r.nu=!1,r}function Kh(t,e,n,r,i){var o=this;return(o=Ph.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Yo=!1,o}function Xh(t,e,n,r,i){var o=this;return(o=Ch.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function $h(t,e,n,r,i,o){this.ln=t,this.po=n,this.vo=r,this.bo=i,this.listener=o,this.state=0,this.So=0,this.Do=null,this.stream=null,this.Yn=new wa(t,e)}function Jh(t,e){this.Po=t,this.Vo=e}function Zh(t,e){this.Po=t,this.Vo=e,this.type="FirstParty",this.user=Ca.Ds}function tc(t){var e=this;this.Ao=null,this.currentUser=Ca.UNAUTHENTICATED,this.Io=!1,this.Ro=0,this.wo=null,this.forceRefresh=!1,this.Ao=function(){e.Ro++,e.currentUser=e.yo(),e.Io=!0,e.wo&&e.wo(e.currentUser)},this.Ro=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Ao):(this.Ao(null),t.get().then(function(t){e.auth=t,e.Ao&&e.auth.addAuthTokenListener(e.Ao)},function(){}))}function ec(){this.wo=null}function nc(t,e){this.key=t,this._o=e}function rc(){this.Xr=new eo(xh.Zr),this.eo=new eo(xh.no)}function ic(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!pc(r))return[3,4];e=0,n=r.Au,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function oc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Au,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function sc(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Or("RemoteStore","RemoteStore shutting down."),e.Tu.add(5),[4,oc(e)];case 1:return t.sent(),e.Iu.Zs(),e.yu.set("Unknown"),[2]}})})}function uc(t,e){t.Eu.has(e.targetId)||(t.Eu.set(e.targetId,e),fc(t)?lc(t):Ec(t).No()&&hc(t,e))}function ac(t,e){var n=t,t=Ec(n);n.Eu.delete(e),t.No()&&cc(n,e),0===n.Eu.size&&(t.No()?t.Lo():pc(n)&&n.yu.set("Unknown"))}function hc(t,e){t.Pu.Te(e.targetId),Ec(t).Ko(e)}function cc(t,e){t.Pu.Te(e),Ec(t).Ho(e)}function lc(e){e.Pu=new Eo({Ue:function(t){return e.wu.Ue(t)},qe:function(t){return e.Eu.get(t)||null}}),Ec(e).start(),e.yu.cu()}function fc(t){return pc(t)&&!Ec(t).Co()&&0<t.Eu.size}function pc(t){return 0===t.Tu.size}function dc(t){t.Pu=void 0}function yc(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.yu.set("Online"),!(u instanceof wo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Eu.has(i)?[4,o.wu.Vu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Eu.delete(i),o.Pu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Or("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,vc(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof go?s.Pu.ge(u):u instanceof mo?s.Pu.$e(u):s.Pu.Se(u),a.isEqual(Oi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Nh(s.Vi)];case 8:return o=t.sent(),0<=a.M(o)?[4,(i=a,(e=(r=s).Pu.xe(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.k()&&((n=r.Eu.get(e))&&r.Eu.set(e,n.st(t.resumeToken,i)))}),e.Kt.forEach(function(t){var e=r.Eu.get(t);e&&(r.Eu.set(t,e.st(gi.U,e.et)),cc(r,t),e=new zi(e.target,t,1,e.sequenceNumber),hc(r,e))}),r.wu.pu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Or("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,vc(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function vc(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ta(r))throw r;return n.Tu.add(1),[4,oc(n)];case 1:return t.sent(),n.yu.set("Offline"),i=i||function(){return Nh(n.Vi)},n.Ln.ss(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Or("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Tu.delete(1),[4,ic(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function gc(e,n){return n().catch(function(t){return vc(e,t,n)})}function mc(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Ic(i=a),s=0<i.mu.length?i.mu[i.mu.length-1].batchId:-1,t.label=1;case 1:if(!(pc(i)&&i.mu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Vi,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Oi.Wr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.mu.length&&o.Lo(),[3,7]):(s=u.batchId,function(t,e){t.mu.push(e);t=Ic(t);t.No()&&t.Jo&&t.Xo(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,vc(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return wc(i)&&bc(i),[2]}var e,n,r})})}function wc(t){return pc(t)&&!Ic(t).Co()&&0<t.mu.length}function bc(t){Ic(t).start()}function Ec(n){var t,e,r,i=this;return n.bu||(n.bu=(t=n.du,e=n.Ln,r={Wo:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Eu.forEach(function(t,e){hc(n,t)}),[2]})})}.bind(null,n),Uo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return dc(e),fc(e)?(e.yu._u(n),lc(e)):e.yu.set("Unknown"),[2]})})}.bind(null,n),zo:yc.bind(null,n)},t.su(),new Gh(e,t.vo,t.credentials,t.serializer,r)),n.Au.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.bu.$o(),fc(n)?lc(n):n.yu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.bu.stop()];case 2:t.sent(),dc(n),t.label=3;case 3:return[2]}})})})),n.bu}function Ic(n){var t,e,r,i=this;return n.Su||(n.Su=(t=n.du,e=n.Ln,r={Wo:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Ic(e).eu(),[2]})})}.bind(null,n),Uo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Ic(e).Jo?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Hi(n=i.code)&&n!==Tr.ABORTED?(e=r.mu.shift(),Ic(r).$o(),[4,gc(r,function(){return r.wu.vu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,mc(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return wc(e)&&bc(e),[2]}})})}.bind(null,n),tu:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Ic(o),n=0,r=o.mu;n<r.length;n++)i=r[n],e.Xo(i.mutations);return[2]})})}.bind(null,n),Zo:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.mu.shift(),n=za.from(e,i,o),[4,gc(r,function(){return r.wu.gu(n)})];case 1:return t.sent(),[4,mc(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.su(),new zh(e,t.vo,t.credentials,t.serializer,r)),n.Au.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Su.$o(),[4,mc(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Su.stop()];case 3:t.sent(),0<n.mu.length&&(Or("RemoteStore","Stopping write stream with "+n.mu.length+" pending writes"),n.mu=[]),t.label=4;case 4:return[2]}})})})),n.Su}function Tc(t,e,n){this.query=t,this.targetId=e,this.view=n}var Ac=function(t){this.key=t},Nc=function(t){this.key=t},Rc=(Object.defineProperty(Dc.prototype,"Lu",{get:function(){return this.Du},enumerable:!1,configurable:!0}),Dc.prototype.Ou=function(t,e){var s=this,u=e?e.xu:new fo,a=(e||this).$u,h=(e||this).Qt,c=a,l=!1,f=Lu(this.query)&&a.size===this.query.limit?a.last():null,p=Su(this.query)&&a.size===this.query.limit?a.first():null;if(t.ct(function(t,e){var n=a.get(t),r=(r=e instanceof wu?e:null)&&(ju(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.ku(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.Fu(r,f)||p&&s.Fu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),Lu(this.query)||Su(this.query))for(;c.size>this.query.limit;){var n=Lu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{$u:c,xu:u,Mu:l,Qt:h}},Dc.prototype.ku=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},Dc.prototype.Uu=function(t,e,n){var o=this,r=this.$u;this.$u=t.$u,this.Qt=t.Qt;var i=t.xu.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Fu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _r()}}var r,i}),this.qu(n);var s=e?this.Bu():[],n=0===this.Nu.size&&this.Zt?1:0,e=n!==this.Cu;return this.Cu=n,0!==i.length||e?{snapshot:new po(this.query,t.$u,r,i,t.Qt,0==n,e,!1),Qu:s}:{Qu:s}},Dc.prototype.Es=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.Uu({$u:this.$u,xu:new fo,Qt:this.Qt,Mu:!1},!1)):{Qu:[]}},Dc.prototype.ju=function(t){return!this.Du.has(t)&&!!this.$u.has(t)&&!this.$u.get(t).Ye},Dc.prototype.qu=function(t){var e=this;t&&(t.te.forEach(function(t){return e.Du=e.Du.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.Du=e.Du.delete(t)}),this.Zt=t.Zt)},Dc.prototype.Bu=function(){var e=this;if(!this.Zt)return[];var n=this.Nu;this.Nu=ho(),this.$u.forEach(function(t){e.ju(t.key)&&(e.Nu=e.Nu.add(t.key))});var r=[];return n.forEach(function(t){e.Nu.has(t)||r.push(new Nc(t))}),this.Nu.forEach(function(t){n.has(t)||r.push(new Ac(t))}),r},Dc.prototype.Wu=function(t){this.Du=t.Yr,this.Nu=ho();t=this.Ou(t.documents);return this.Uu(t,!0)},Dc.prototype.Gu=function(){return po.Gt(this.query,this.$u,this.Qt,0===this.Cu)},Dc),Lc=function(t){this.key=t,this.zu=!1},Sc=(Object.defineProperty(Oc.prototype,"ca",{get:function(){return!0===this.aa},enumerable:!1,configurable:!0}),Oc);function Oc(t,e,n,r,i,o){this.Vi=t,this.Ku=e,this.Hu=n,this.Yu=r,this.currentUser=i,this.Ju=o,this.Xu={},this.Zu=new Li(xu,Mu),this.ta=new Map,this.ea=[],this.na=new Wi(Gr.i),this.sa=new Map,this.ia=new Mh,this.ra={},this.oa=new Map,this.ua=mh.Ar(),this.onlineState="Unknown",this.aa=void 0}function Dc(t,e){this.query=t,this.Du=e,this.Cu=null,this.Zt=!1,this.Nu=ho(),this.Qt=ho(),this.Fu=Bu(t),this.$u=new lo(this.Fu)}function Vc(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).Ku.wu.pu=_c.bind(null,e),e.Ku.wu.Ue=function(t,e){var n=t,t=n.sa.get(e);if(t&&t.zu)return ho().add(t.key);var r=ho(),e=n.ta.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Zu.get(s);r=r.Lt(s.view.Lu)}return r}.bind(null,e),e.Ku.wu.Vu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Yu.Ws(s,"rejected",u),i=e.sa.get(s),(n=i&&i.key)?(r=(r=new Wi(Gr.i)).rt(n,new bu(n,Oi.min())),i=ho().add(n),i=new yo(Oi.min(),new Map,new eo(yi),r,i),[4,_c(e,i)]):[3,2];case 1:return t.sent(),e.na=e.na.remove(n),e.sa.delete(s),jc(e),[3,4];case 2:return[4,Oh(e.Vi,s,!1).then(function(){return Mc(e,s,u)}).catch(Vh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.Xu.zo=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Ts(s)&&(r=!0);u.fs=s}}r&&Ua(n)}.bind(null,e.Hu),e.Xu.ha=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Hu),(s=(n=e).Zu.get(a))?(r=s.targetId,n.Yu.js(r),i=s.view.Gu(),[3,4]):[3,1];case 1:return[4,Sh(n.Vi,_u(a))];case 2:return o=t.sent(),s=n.Yu.js(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.la=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Ou(o)).Mu?[4,Dh(r.Vi,i.query,!1).then(function(t){t=t.documents;return i.view.Ou(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Uu(e,r.ca,n),[2,(Fc(r,i.targetId,n.Qu),n.snapshot)]}})})}(i,t,e,n)},[4,Dh(i.Vi,o,!0)];case 1:return n=t.sent(),r=new Rc(o,n.Yr),e=r.Ou(n.documents),n=vo.Xt(s,u&&"Offline"!==i.onlineState),n=r.Uu(e,i.ca,n),Fc(i,s,n.Qu),r=new Tc(o,s,r),i.Zu.set(o,r),i.ta.has(s)?i.ta.get(s).push(o):i.ta.set(s,[o]),[2,n.snapshot]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n.ca&&uc(n.Ku,o),t.label=4;case 4:return[2,i]}var e})})}function kc(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Ku.wu.gu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ah(e.Vi,o)];case 2:return r=t.sent(),Cc(e,n,null),Pc(e,n),e.Yu.Qs(n,"acknowledged"),[4,Bc(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Vh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.Ku.wu.vu=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Vi,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Oi.da(e,r).next(function(t){return Ur(null!==t),n=t.keys(),i.Oi.$r(e,t)}).next(function(){return i.Oi.Lr(e)}).next(function(){return i.$i.Qi(e,n)})}))];case 2:return o=t.sent(),Cc(n,u,a),Pc(n,u),n.Yu.Qs(u,"rejected",a),[4,Bc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Vh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Vi,a=p,c=r,l=Si.now(),i=a.reduce(function(t,e){return t.add(e.key)},ho()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.$i.Qi(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof ru?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof wu?t.field(i.field):void 0,o=Es(i.transform,o||null);null!=o&&(e=(null==e?new lu:e).set(i.field,o))}return e?e.Je():null}(o):null);null!=o&&e.push(new Js(i.key,o,function s(t){var u=[];return Cr(t.fields||{},function(t,e){var n=new qr([t]);if(Wo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Fs(u)}(o.proto.mapValue),qs.exists(!0)))}return c.Oi._a(u,l,e,a)})}).then(function(t){var e=t.ri(h);return{batchId:t.batchId,fa:e}}))];case 2:return s=t.sent(),u.Yu.Bs(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.ra[e.currentUser.bs()])||new Wi(yi)).rt(n,o),e.ra[e.currentUser.bs()]=r,[4,Bc(u,s.fa)];case 3:return t.sent(),[4,mc(u.Ku)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Oa(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function _c(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Rh(n.Vi,i)];case 2:return e=t.sent(),i.zt.forEach(function(t,e){e=n.sa.get(e);e&&(Ur(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.zu=!0:0<t.ee.size?Ur(e.zu):0<t.ne.size&&(Ur(e.zu),e.zu=!1))}),[4,Bc(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Vh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Uc(t,n,e){var r,t=t;(t.ca&&0===e||!t.ca&&1===e)&&(r=[],t.Zu.forEach(function(t,e){e=e.view.Es(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Es(i)&&(o=!0)}),o&&Ua(t)}(t.Hu,n),r.length&&t.Xu.zo(r),t.onlineState=n,t.ca&&t.Yu.Xs(n))}function Pc(t,e){(t.oa.get(e)||[]).forEach(function(t){t.resolve()}),t.oa.delete(e)}function Cc(t,e,n){var r=t,i=r.ra[r.currentUser.bs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.ra[r.currentUser.bs()]=i)}function Mc(e,t,n){void 0===n&&(n=null),e.Yu.Gs(t);for(var r=0,i=e.ta.get(t);r<i.length;r++){var o=i[r];e.Zu.delete(o),n&&e.Xu.ha(o,n)}e.ta.delete(t),e.ca&&e.ia.ao(t).forEach(function(t){e.ia.lo(t)||xc(e,t)})}function xc(t,e){var n=t.na.get(e);null!==n&&(ac(t.Ku,n),t.na=t.na.remove(e),t.sa.delete(n),jc(t))}function Fc(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Ac?(t.ia.so(o.key,e),function(t,e){e=e.key;t.na.get(e)||(Or("SyncEngine","New document in limbo: "+e),t.ea.push(e),jc(t))}(t,o)):o instanceof Nc?(Or("SyncEngine","Document no longer in limbo: "+o.key),t.ia.ro(o.key,e),t.ia.lo(o.key)||xc(t,o.key)):_r()}}function jc(t){for(;0<t.ea.length&&t.na.size<t.Ju;){var e=t.ea.shift(),n=t.ua.next();t.sa.set(n,new Lc(e)),t.na=t.na.rt(e,n),uc(t.Ku,new zi(_u(Ru(e.path)),n,2,Fa.Ls))}}function Bc(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Zu.m()?[3,3]:(n.Zu.forEach(function(t,e){o.push(n.la(e,s,u).then(function(t){t&&(n.ca&&n.Yu.Ws(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ah.tr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Xu.zo(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ba.forEach(h,function(e){return ba.forEach(e.Xi,function(t){return r.persistence.Br.so(n,e.targetId,t)}).next(function(){return ba.forEach(e.Zi,function(t){return r.persistence.Br.ro(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ta(e=t.sent()))throw e;return Or("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Rr.get(o),u=s.et,u=s.it(u),r.Rr=r.Rr.rt(o,u));return[2]}})})}(n.Vi,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function qc(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Or("SyncEngine","User change. New user:",o.bs()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Oi,m=e.$i,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Oi.ma(v).next(function(t){return g=t,n=e.persistence.Vr(o),m=new uh(e.bi,n,e.persistence.vr()),n.ma(v)}).next(function(t){for(var e=[],n=[],r=ho(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Qi(v,r).next(function(t){return{Ea:t,Ta:e,Aa:n}})})})];case 1:return r=t.sent(),[2,(e.Oi=n,e.$i=m,e.Ir.Dr(e.$i),r)]}})})}(n.Vi,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).oa.forEach(function(t){t.forEach(function(t){t.reject(new Ar(Tr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.oa.clear(),n.Yu.Js(o,r.Ta,r.Aa),[4,Bc(n,r.Ea)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Gc(t,e,n){var r=t;(function(f,p,d){return y(this,void 0,void 0,function(){var u,a,h,c,l;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=f.Vi,i=u,s=new th((o=r).serializer).Ri(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.br.Ia(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.M(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Ra({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.ya(ih(u)),a=new sh(u,f.Vi,p.serializer),[4,p.fi()];case 5:h=t.sent(),t.label=6;case 6:return h?[4,a.pi(h)]:[3,10];case 7:return(c=t.sent())&&d.ya(c),[4,p.fi()];case 8:h=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return l=t.sent(),[4,Bc(f,l.yi,void 0)];case 12:return t.sent(),[4,(r=f.Vi,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.br.Pa(t,e)}))];case 13:return t.sent(),d.Ra(l.progress),[3,15];case 14:return l=t.sent(),d.Va(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.Yu.ti()})}var zc,Qc,Hc,Yc,Wc,Kc=(xl.prototype.Dr=function(t){this.pa=t},xl.prototype.Wi=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.g())||i.isEqual(Oi.min())?this.ga(e,r):this.pa.Qi(e,o).next(function(t){var n=s.va(r,t);return(Lu(r)||Su(r))&&s.Mu(r.limitType,n,o,i)?s.ga(e,r):(Sr()<=u.DEBUG&&Or("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Fu(r)),s.pa.Wi(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},xl.prototype.va=function(n,t){var r=new eo(Bu(n));return t.forEach(function(t,e){e instanceof wu&&ju(n,e)&&(r=r.add(e))}),r},xl.prototype.Mu=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.M(r))},xl.prototype.ga=function(t,e){return Sr()<=u.DEBUG&&Or("IndexFreeQueryEngine","Using full collection scan to execute query:",Fu(e)),this.pa.Wi(t,e,Oi.min())},xl),Xc=(Ml.prototype.Da=function(t){return ba.resolve(0===this.Oi.length)},Ml.prototype._a=function(t,e,n,r){var i=this.ba;this.ba++,0<this.Oi.length&&this.Oi[this.Oi.length-1];n=new Ga(i,e,n,r);this.Oi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Sa=this.Sa.add(new xh(u.key,i)),this.xi.mr(t,u.key.path.h())}return ba.resolve(n)},Ml.prototype.da=function(t,e){return ba.resolve(this.Ca(e))},Ml.prototype.Wr=function(t,e){e+=1,e=this.Na(e),e=e<0?0:e;return ba.resolve(this.Oi.length>e?this.Oi[e]:null)},Ml.prototype.wa=function(){return ba.resolve(0===this.Oi.length?-1:this.ba-1)},Ml.prototype.ma=function(t){return ba.resolve(this.Oi.slice())},Ml.prototype.Mi=function(t,e){var n=this,r=new xh(e,0),e=new xh(e,Number.POSITIVE_INFINITY),i=[];return this.Sa.Nt([r,e],function(t){t=n.Ca(t._o);i.push(t)}),ba.resolve(i)},Ml.prototype.ji=function(t,e){var n=this,r=new eo(yi);return e.forEach(function(t){var e=new xh(t,0),t=new xh(t,Number.POSITIVE_INFINITY);n.Sa.Nt([e,t],function(t){r=r.add(t._o)})}),ba.resolve(this.Fa(r))},Ml.prototype.Yi=function(t,e){var n=e.path,r=n.length+1,e=n;Gr.F(e)||(e=e.child(""));var e=new xh(new Gr(e),0),i=new eo(yi);return this.Sa.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t._o)),!0)},e),ba.resolve(this.Fa(i))},Ml.prototype.Fa=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Ca(t);null!==t&&n.push(t)}),n},Ml.prototype.$r=function(n,r){var i=this;Ur(0===this.$a(r.batchId,"removed")),this.Oi.shift();var o=this.Sa;return ba.forEach(r.mutations,function(t){var e=new xh(t.key,r.batchId);return o=o.delete(e),i.Br.La(n,t.key)}).next(function(){i.Sa=o})},Ml.prototype.Oa=function(t){},Ml.prototype.lo=function(t,e){var n=new xh(e,0),n=this.Sa.$t(n);return ba.resolve(e.isEqual(n&&n.key))},Ml.prototype.Lr=function(t){return this.Oi.length,ba.resolve()},Ml.prototype.$a=function(t,e){return this.Na(t)},Ml.prototype.Na=function(t){return 0===this.Oi.length?0:t-this.Oi[0].batchId},Ml.prototype.Ca=function(t){t=this.Na(t);return t<0||t>=this.Oi.length?null:this.Oi[t]},Ml),$c=(Cl.prototype.Fr=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.xa(e);return this.docs=this.docs.rt(r,{ka:e,size:i,readTime:n}),this.size+=i-o,this.xi.mr(t,r.path.h())},Cl.prototype.jr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Cl.prototype.qi=function(t,e){e=this.docs.get(e);return ba.resolve(e?e.ka:null)},Cl.prototype.getEntries=function(t,e){var n=this,r=ro;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.ka:null)}),ba.resolve(r)},Cl.prototype.Wi=function(t,e,n){for(var r=so,i=new Gr(e.path.child("")),o=this.docs._t(i);o.At();){var s=o.Tt(),u=s.key,a=s.value,s=a.ka,a=a.readTime;if(!e.path.T(u.path))break;a.M(n)<=0||s instanceof wu&&ju(e,s)&&(r=r.rt(s.key,s))}return ba.resolve(r)},Cl.prototype.Ma=function(t,e){return ba.forEach(this.docs,function(t){return e(t)})},Cl.prototype.vi=function(t){return new Jc(this)},Cl.prototype.Ua=function(t){return ba.resolve(this.size)},Cl),Jc=(Pl.prototype.Ba=function(t){t=this.fa.get(t);return t?t.readTime:Oi.min()},Pl.prototype.Fr=function(t,e){this.Qa(),this.fa.set(t.key,{ka:t,readTime:e})},Pl.prototype.jr=function(t,e){void 0===e&&(e=null),this.Qa(),this.fa.set(t,{ka:null,readTime:e})},Pl.prototype.qi=function(t,e){this.Qa();var n=this.fa.get(e);return void 0!==n?ba.resolve(n.ka):this.ja(t,e)},Pl.prototype.getEntries=function(t,e){return this.Wa(t,e)},Pl.prototype.apply=function(t){return this.Qa(),this.qa=!0,this.Uu(t)},Pl.prototype.Qa=function(){},n(Ul,Wc=Pl),Ul.prototype.Uu=function(n){var r=this,i=[];return this.fa.forEach(function(t,e){e&&e.ka?i.push(r.Ga.Fr(n,e.ka,r.Ba(t))):r.Ga.jr(t)}),ba.Fn(i)},Ul.prototype.ja=function(t,e){return this.Ga.qi(t,e)},Ul.prototype.Wa=function(t,e){return this.Ga.getEntries(t,e)},Ul),Zc=(_l.prototype.De=function(t,n){return this.za.forEach(function(t,e){return n(e)}),ba.resolve()},_l.prototype.Or=function(t){return ba.resolve(this.lastRemoteSnapshotVersion)},_l.prototype.Ja=function(t){return ba.resolve(this.Ka)},_l.prototype.zr=function(t){return this.highestTargetId=this.Ya.next(),ba.resolve(this.highestTargetId)},_l.prototype.Qr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ka&&(this.Ka=e),ba.resolve()},_l.prototype.Xa=function(t){this.za.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Ya=new mh(e),this.highestTargetId=e),t.sequenceNumber>this.Ka&&(this.Ka=t.sequenceNumber)},_l.prototype.Kr=function(t,e){return this.Xa(e),this.targetCount+=1,ba.resolve()},_l.prototype.Ur=function(t,e){return this.Xa(e),ba.resolve()},_l.prototype.Za=function(t,e){return this.za.delete(e.target),this.Ha.ao(e.targetId),--this.targetCount,ba.resolve()},_l.prototype.tc=function(n,r,i){var o=this,s=0,u=[];return this.za.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.za.delete(t),u.push(o.Di(n,e.targetId)),s++)}),ba.Fn(u).next(function(){return s})},_l.prototype.ec=function(t){return ba.resolve(this.targetCount)},_l.prototype.Gr=function(t,e){e=this.za.get(e)||null;return ba.resolve(e)},_l.prototype.Ni=function(t,e,n){return this.Ha.io(e,n),ba.resolve()},_l.prototype.kr=function(e,t,n){this.Ha.uo(t,n);var r=this.persistence.Br,i=[];return r&&t.forEach(function(t){i.push(r.La(e,t))}),ba.Fn(i)},_l.prototype.Di=function(t,e){return this.Ha.ao(e),ba.resolve()},_l.prototype.Hr=function(t,e){e=this.Ha.ho(e);return ba.resolve(e)},_l.prototype.lo=function(t,e){return ba.resolve(this.Ha.lo(e))},_l),tl=(kl.prototype.Ia=function(t,e){return ba.resolve(this.nc.get(e))},kl.prototype.Pa=function(t,e){return this.nc.set(e.id,{id:e.id,version:e.version,createTime:rs(e.createTime)}),ba.resolve()},kl.prototype.ic=function(t,e){return ba.resolve(this.sc.get(e))},kl.prototype.Jr=function(t,e){return this.sc.set(e.name,{name:(e=e).name,query:yh(e.bundledQuery),readTime:rs(e.readTime)}),ba.resolve()},kl),el=(Vl.prototype.start=function(){return Promise.resolve()},Vl.prototype.Zs=function(){return this.uc=!1,Promise.resolve()},Object.defineProperty(Vl.prototype,"cc",{get:function(){return this.uc},enumerable:!1,configurable:!0}),Vl.prototype.hc=function(){},Vl.prototype.lc=function(){},Vl.prototype.vr=function(){return this.xi},Vl.prototype.Vr=function(t){var e=this.rc[t.bs()];return e||(e=new Xc(this.xi,this.Br),this.rc[t.bs()]=e),e},Vl.prototype.gr=function(){return this.Ci},Vl.prototype.pr=function(){return this.Li},Vl.prototype.Sr=function(){return this.br},Vl.prototype.runTransaction=function(t,e,n){var r=this;Or("MemoryPersistence","Starting transaction:",t);var i=new nl(this.oc.next());return this.Br._c(),n(i).next(function(t){return r.Br.fc(i).next(function(){return t})}).Cn().then(function(t){return i.dc(),t})},Vl.prototype.wc=function(e,n){return ba.$n(Object.values(this.rc).map(function(t){return function(){return t.lo(e,n)}}))},Vl),nl=(Dl.prototype.Ec=function(t){this.mc.push(t)},Dl.prototype.dc=function(){this.mc.forEach(function(t){return t()})},n(Ol,Yc=Dl),Ol),rl=(Sl.Ic=function(t){return new Sl(t)},Object.defineProperty(Sl.prototype,"Rc",{get:function(){if(this.Ac)return this.Ac;throw _r()},enumerable:!1,configurable:!0}),Sl.prototype.so=function(t,e,n){return this.Tc.so(n,e),this.Rc.delete(n.toString()),ba.resolve()},Sl.prototype.ro=function(t,e,n){return this.Tc.ro(n,e),this.Rc.add(n.toString()),ba.resolve()},Sl.prototype.La=function(t,e){return this.Rc.add(e.toString()),ba.resolve()},Sl.prototype.removeTarget=function(t,e){var n=this;this.Tc.ao(e.targetId).forEach(function(t){return n.Rc.add(t.toString())});var r=this.persistence.gr();return r.Hr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Rc.add(t.toString())})}).next(function(){return r.Za(t,e)})},Sl.prototype._c=function(){this.Ac=new Set},Sl.prototype.fc=function(n){var r=this,i=this.persistence.pr().vi();return ba.forEach(this.Rc,function(t){var e=Gr.D(t);return r.yc(n,e).next(function(t){t||i.jr(e)})}).next(function(){return r.Ac=null,i.apply(n)})},Sl.prototype.qr=function(t,e){var n=this;return this.yc(t,e).next(function(t){t?n.Rc.delete(e.toString()):n.Rc.add(e.toString())})},Sl.prototype.ac=function(t){return 0},Sl.prototype.yc=function(t,e){var n=this;return ba.$n([function(){return ba.resolve(n.Tc.lo(e))},function(){return n.persistence.gr().lo(t,e)},function(){return n.persistence.wc(t,e)}])},Sl),il=(Ll.prototype.Wo=function(t){this.gc=t},Ll.prototype.Uo=function(t){this.vc=t},Ll.prototype.onMessage=function(t){this.bc=t},Ll.prototype.close=function(){this.Vc()},Ll.prototype.send=function(t){this.Pc(t)},Ll.prototype.Sc=function(){this.gc()},Ll.prototype.Dc=function(t){this.vc(t)},Ll.prototype.Cc=function(t){this.bc(t)},Ll),ol={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},sl=(Rl.prototype.iu=function(e,t,n,r){var i=this.Lc(e,t);Or("RestConnection","Sending: ",i,n);t={};return this.Oc(t,r),this.xc(e,i,t,n).then(function(t){return Or("RestConnection","Received: ",t),t},function(t){throw Vr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Rl.prototype.ru=function(t,e,n,r){return this.iu(t,e,n,r)},Rl.prototype.Oc=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.22.1-alpha.96ae6a5fe",t["Content-Type"]="text/plain",e)for(var n in e.fo)e.fo.hasOwnProperty(n)&&(t[n]=e.fo[n])},Rl.prototype.Lc=function(t,e){t=ol[t];return this.Fc+"/v1/"+e+":"+t},n(Nl,Hc=Rl),Nl.prototype.xc=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();Or("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:Or("Connection",'RPC "'+o+'" timed out'),r(new Ar(Tr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();Or("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Tr).indexOf(e)?e:Tr.UNKNOWN,r(new Ar(e,t.message))):r(new Ar(Tr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Ar(Tr.UNAVAILABLE,"Connection failed."));break;default:_r()}}finally{Or("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Nl.prototype.Go=function(t,e){var n,r=[this.Fc,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=yr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.B.projectId+"/databases/"+this.B.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Oc(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Or("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new il({Pc:function(t){u?Or("Connection","Not sending because WebChannel is closed:",t):(s||(Or("Connection","Opening WebChannel transport."),o.open(),s=!0),Or("Connection","WebChannel sending:",t),o.send(t))},Vc:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Or("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Or("Connection","WebChannel transport closed"),a.Dc())}),t(mr.EventType.ERROR,function(t){u||(u=!0,Vr("Connection","WebChannel transport errored:",t),a.Dc(new Ar(Tr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Ur(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Or("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Gi[r];if(void 0!==t)return Yi(t)}(),i=n.message,void 0===t&&(t=Tr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Dc(new Ar(t,i)),o.close()):(Or("Connection","WebChannel received:",e),a.Cc(e)))}),setTimeout(function(){a.Sc()},0),a},Nl),ul=(Al.prototype.Ru=function(t){this.Bc.push(t)},Al.prototype.Zs=function(){window.removeEventListener("online",this.kc),window.removeEventListener("offline",this.Uc)},Al.prototype.Qc=function(){window.addEventListener("online",this.kc),window.addEventListener("offline",this.Uc)},Al.prototype.Mc=function(){Or("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Bc;t<e.length;t++)(0,e[t])(0)},Al.prototype.qc=function(){Or("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Bc;t<e.length;t++)(0,e[t])(1)},Al.jc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Al),al=(Tl.prototype.Ru=function(t){},Tl.prototype.Zs=function(){},Tl),hl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",cl=(Il.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=$a(e.Nc.B),this.Yu=this.Wc(e),this.persistence=this.Gc(e),[4,this.persistence.start()];case 1:return t.sent(),this.zc=this.Kc(e),this.Vi=this.Hc(e),[2]}})})},Il.prototype.Kc=function(t){return null},Il.prototype.Hc=function(t){return e=this.persistence,n=new Kc,r=t.Yc,t=this.serializer,new wh(e,n,r,t);var e,n,r},Il.prototype.Gc=function(t){if(t.persistenceSettings.Jc)throw new Ar(Tr.FAILED_PRECONDITION,hl);return new el(rl.Ic,this.serializer)},Il.prototype.Wc=function(t){return new qa},Il.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zc&&this.zc.stop(),[4,this.Yu.Zs()];case 1:return t.sent(),[4,this.persistence.Zs()];case 2:return t.sent(),[2]}})})},Il.prototype.clearPersistence=function(t,e){throw new Ar(Tr.FAILED_PRECONDITION,hl)},Il),ll=(El.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Vi?[3,2]:(this.Vi=n.Vi,this.Yu=n.Yu,this.du=this.Xc(r),this.Ku=this.Zc(r),this.Hu=this.th(r),this.eh=this.nh(r),this.Yu.qs=function(t){return Uc(e.eh,t,1)},this.Ku.wu.sh=qc.bind(null,this.eh),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Tu.delete(2),[4,ic(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Tu.add(2),[4,oc(e)]);case 3:t.sent(),e.yu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Ku,this.eh.ca)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},El.prototype.th=function(t){return new Va},El.prototype.Xc=function(t){var e=$a(t.Nc.B),n=(n=t.Nc,new sl(n));return t=t.credentials,new Qh(t,n,e)},El.prototype.Zc=function(t){var e=this,n=this.Vi,r=this.du,i=t.Ln,o=function(t){return Uc(e.eh,t,0)},t=new(ul.jc()?ul:al);return new _h(n,r,i,o,t)},El.prototype.nh=function(t){return function(t,e,n,r,i,o,s){o=new Sc(t,e,n,r,i,o);return s&&(o.aa=!0),o}(this.Vi,this.Ku,this.Hu,this.Yu,t.Yc,t.Ju,!t.persistenceSettings.Jc||!t.persistenceSettings.synchronizeTabs)},El.prototype.terminate=function(){return sc(this.Ku)},El),fl=(bl.prototype.next=function(t){this.observer.next&&this.ih(this.observer.next,t)},bl.prototype.error=function(t){this.observer.error?this.ih(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},bl.prototype.rh=function(){this.muted=!0},bl.prototype.ih=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},bl),pl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Ar(Tr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Jr("FieldPath","string",e,t[e]),0===t[e].length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.oh=new qr(t)},dl=(n(wl,Qc=pl),wl.documentId=function(){return new wl(qr.v().R())},wl.prototype.isEqual=function(t){if(!(t instanceof wl))throw hi("isEqual","FieldPath",1,t);return this.oh.isEqual(t.oh)},wl),yl=new RegExp("[~\\*/\\[\\]]"),vl=function(t){this.uh=t},gl=(n(ml,zc=vl),ml.prototype.ah=function(t){if(2!==t.hh)throw 1===t.hh?t.lh(this.uh+"() can only appear at the top level of your update data"):t.lh(this.uh+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},ml.prototype.isEqual=function(t){return t instanceof ml},ml);function ml(){return null!==zc&&zc.apply(this,arguments)||this}function wl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Qc.call(this,t)||this}function bl(t){this.observer=t,this.muted=!1}function El(){}function Il(){}function Tl(){}function Al(){var t=this;this.kc=function(){return t.Mc()},this.Uc=function(){return t.qc()},this.Bc=[],this.Qc()}function Nl(t){var e=this;return(e=Hc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Rl(t){this.Nc=t,this.B=t.B;var e=t.ssl?"https":"http";this.Fc=e+"://"+t.host,this.$c="projects/"+this.B.projectId+"/databases/"+this.B.database+"/documents"}function Ll(t){this.Pc=t.Pc,this.Vc=t.Vc}function Sl(t){this.persistence=t,this.Tc=new Mh,this.Ac=null}function Ol(t){var e=this;return(e=Yc.call(this)||this).Mr=t,e}function Dl(){this.mc=[]}function Vl(t,e){var n=this;this.rc={},this.oc=new Fa(0),this.uc=!1,this.uc=!0,this.Br=t(this),this.Ci=new Zc(this),this.xi=new vh,this.Li=(t=this.xi,new $c(t,function(t){return n.Br.ac(t)})),this.serializer=new dh(e),this.br=new tl(this.serializer)}function kl(t){this.serializer=t,this.nc=new Map,this.sc=new Map}function _l(t){this.persistence=t,this.za=new Li(Fi,ji),this.lastRemoteSnapshotVersion=Oi.min(),this.highestTargetId=0,this.Ka=0,this.Ha=new Mh,this.targetCount=0,this.Ya=mh.Tr()}function Ul(t){var e=this;return(e=Wc.call(this)||this).Ga=t,e}function Pl(){this.fa=new Li(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.qa=!1}function Cl(t,e){this.xi=t,this.xa=e,this.docs=new Wi(Gr.i),this.size=0}function Ml(t,e){this.xi=t,this.Br=e,this.Oi=[],this.ba=1,this.Sa=new eo(xh.Zr)}function xl(){}function Fl(t,e,n){return new hf({hh:3,_h:e.settings._h,methodName:t.uh,fh:n},e.B,e.serializer,e.ignoreUndefinedProperties)}var jl,Bl,ql,Gl,zl=(n(uf,Gl=vl),uf.prototype.ah=function(t){return new xs(t.path,new As)},uf.prototype.isEqual=function(t){return t instanceof uf},uf),Ql=(n(sf,ql=vl),sf.prototype.ah=function(t){var e=Fl(this,t,!0),n=this.dh.map(function(t){return gf(t,e)}),n=new Ns(n);return new xs(t.path,n)},sf.prototype.isEqual=function(t){return this===t},sf),Hl=(n(of,Bl=vl),of.prototype.ah=function(t){var e=Fl(this,t,!0),n=this.dh.map(function(t){return gf(t,e)}),n=new Ds(n);return new xs(t.path,n)},of.prototype.isEqual=function(t){return this===t},of),Yl=(n(rf,jl=vl),rf.prototype.ah=function(t){var e=new Us(t.serializer,ts(t.serializer,this.wh));return new xs(t.path,e)},rf.prototype.isEqual=function(t){return this===t},rf),Wl=(Object.defineProperty(nf.prototype,"latitude",{get:function(){return this.mh},enumerable:!1,configurable:!0}),Object.defineProperty(nf.prototype,"longitude",{get:function(){return this.Eh},enumerable:!1,configurable:!0}),nf.prototype.isEqual=function(t){return this.mh===t.mh&&this.Eh===t.Eh},nf.prototype.toJSON=function(){return{latitude:this.mh,longitude:this.Eh}},nf.prototype.H=function(t){return yi(this.mh,t.mh)||yi(this.Eh,t.Eh)},nf),Kl=function(t){this.Th=t},Xl=/^__.*__$/,$l=function(t,e,n){this.Ah=t,this.Ih=e,this.Rh=n},Jl=(ef.prototype.yh=function(t,e){var n=[];return null!==this.Qe?n.push(new Js(t,this.data,this.Qe,e)):n.push(new $s(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new ru(t,this.fieldTransforms)),n},ef),Zl=(tf.prototype.yh=function(t,e){e=[new Js(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&e.push(new ru(t,this.fieldTransforms)),e},tf);function tf(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function ef(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function nf(t,e){if(Kr("GeoPoint",arguments,2),Jr("GeoPoint","number",1,t),Jr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ar(Tr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ar(Tr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.mh=t,this.Eh=e}function rf(t,e){var n=this;return(n=jl.call(this,t)||this).wh=e,n}function of(t,e){var n=this;return(n=Bl.call(this,t)||this).dh=e,n}function sf(t,e){var n=this;return(n=ql.call(this,t)||this).dh=e,n}function uf(){return null!==Gl&&Gl.apply(this,arguments)||this}function af(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw _r()}}var hf=(Object.defineProperty(ff.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"hh",{get:function(){return this.settings.hh},enumerable:!1,configurable:!0}),ff.prototype.Vh=function(t){return new ff(Object.assign(Object.assign({},this.settings),t),this.B,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},ff.prototype.ph=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Vh({path:e,fh:!1});return e.gh(t),e},ff.prototype.bh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Vh({path:t,fh:!1});return t.Ph(),t},ff.prototype.Sh=function(t){return this.Vh({path:void 0,fh:!0})},ff.prototype.lh=function(t){return Tf(t,this.settings.methodName,this.settings.Dh||!1,this.path,this.settings._h)},ff.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},ff.prototype.Ph=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.gh(this.path.get(t))},ff.prototype.gh=function(t){if(0===t.length)throw this.lh("Document fields must not be empty");if(af(this.hh)&&Xl.test(t))throw this.lh('Document fields cannot begin and end with "__"')},ff),cf=(lf.prototype.Ch=function(t,e,n,r){return void 0===r&&(r=!1),new hf({hh:t,methodName:e,_h:n,path:qr.V(),fh:!1,Dh:r},this.B,this.serializer,this.ignoreUndefinedProperties)},lf);function lf(t,e,n){this.B=t,this.ignoreUndefinedProperties=e,this.serializer=n||$a(t)}function ff(t,e,n,r,i,o){this.settings=t,this.B=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ph(),this.fieldTransforms=i||[],this.Qe=o||[]}function pf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Ch(o.merge||o.mergeFields?2:0,e,n,i);bf("Data must be an object, but it was:",s,r);var u,a,r=mf(r,s);if(o.merge)u=new Fs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof pl)p=f.oh;else{if("string"!=typeof f)throw _r();p=If(e,f,n)}if(!s.contains(p))throw new Ar(Tr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Af(h,p)||h.push(p)}u=new Fs(h),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new Jl(new cu(r),u,a)}function df(t,r,i,e){var o=t.Ch(1,r,i);bf("Data must be an object, but it was:",o,e);var s=[],u=new lu;Cr(e,function(t,e){var n=If(r,t,i),t=o.bh(n);e instanceof gl||e instanceof Kl&&e.Th instanceof gl?s.push(n):null!=(t=gf(e,t))&&(s.push(n),u.set(n,t))});e=new Fs(s);return new Zl(u.Je(),e,o.fieldTransforms)}function yf(t,e,n,r,i,o){var s=t.Ch(1,e,n),u=[Ef(e,r,n)],a=[i];if(o.length%2!=0)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Ef(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new lu,y=u.length-1;0<=y;--y){Af(p,u[y])||(c=u[y],l=a[y],f=s.bh(c),l instanceof gl||l instanceof Kl&&l.Th instanceof gl?p.push(c):null!=(f=gf(l,f))&&(p.push(c),d.set(c,f)))}i=new Fs(p);return new Zl(d.Je(),i,s.fieldTransforms)}function vf(t,e,n,r){return void 0===r&&(r=!1),gf(n,t.Ch(r?4:3,e))}function gf(s,t){if(s instanceof Kl&&(s=s.Th),wf(s))return bf("Unsupported field value:",t,s),mf(s,t);if(s instanceof vl)return function(t,e){if(!af(e.hh))throw e.lh(t.uh+"() can only be used with update() and set()");if(!e.path)throw e.lh(t.uh+"() is not currently supported inside arrays");t=t.ah(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.fh&&4!==t.hh)throw t.lh("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=gf(i[r],t.Sh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ts(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Si.fromDate(t);return{timestampValue:es(e.serializer,n)}}if(t instanceof Si){var r=new Si(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:es(e.serializer,r)}}if(t instanceof Wl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wi)return{bytesValue:ns(e.serializer,t.q)};if(t instanceof $l){n=e.B,r=t.Ah;if(!r.isEqual(n))throw e.lh("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:is(t.Ah||e.B,t.Ih.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.lh("Unsupported field value: "+si(t))}(s,t)}function mf(t,n){var r={};return Mr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Cr(t,function(t,e){e=gf(e,n.ph(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function wf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Si||t instanceof Wl||t instanceof wi||t instanceof $l||t instanceof vl)}function bf(t,e,n){if(!wf(n)||!oi(n)){n=si(n);throw"an object"===n?e.lh(t+" a custom object"):e.lh(t+" "+n)}}function Ef(t,e,n){if(e instanceof pl)return e.oh;if("string"==typeof e)return If(t,e);throw Tf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function If(t,e,n){try{return function(e){if(0<=e.search(yl))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(dl.bind.apply(dl,i([void 0],e.split("."))))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).oh}catch(e){throw Tf(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Tf(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Ar(Tr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Af(t,e){return t.some(function(t){return t.isEqual(e)})}var Nf=(Df.prototype.Oh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.xh(),0<this.mutations.length)throw new Ar(Tr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=hs((n=s).serializer)+"/documents",r={documents:u.map(function(t){return ss(n.serializer,t)})},[4,n.ru("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Ur(!!e.found),e.found.name,e.found.updateTime;var n=us(t,e.found.name),t=rs(e.found.updateTime),e=new cu({mapValue:{fields:e.found.fields}});return new wu(n,t,e,{})}(e,t):"missing"in t?function(t,e){Ur(!!e.missing),Ur(!!e.readTime);t=us(t,e.missing),e=rs(e.readTime);return new bu(t,e)}(e,t):_r());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Ur(!!t),o.push(t)}),o)]}})})}(this.du,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof bu||t instanceof wu?n.kh(t):_r()}),e)]}})})},Df.prototype.set=function(t,e){this.write(e.yh(t,this.Ge(t))),this.Lh.add(t.toString())},Df.prototype.update=function(t,e){try{this.write(e.yh(t,this.Mh(t)))}catch(t){this.$h=t}this.Lh.add(t.toString())},Df.prototype.delete=function(t){this.write([new au(t,this.Ge(t))]),this.Lh.add(t.toString())},Df.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.xh(),this.$h)throw this.$h;return e=this.Nh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Gr.D(e);n.mutations.push(new hu(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=hs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return fs(e.serializer,t)})},[4,e.iu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.du,this.mutations)];case 1:return t.sent(),this.Fh=!0,[2]}})})},Df.prototype.kh=function(t){var e;if(t instanceof wu)e=t.version;else{if(!(t instanceof bu))throw _r();e=Oi.min()}var n=this.Nh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ar(Tr.ABORTED,"Document version changed between two reads.")}else this.Nh.set(t.key.toString(),e)},Df.prototype.Ge=function(t){var e=this.Nh.get(t.toString());return!this.Lh.has(t.toString())&&e?qs.updateTime(e):qs.He()},Df.prototype.Mh=function(t){var e=this.Nh.get(t.toString());if(this.Lh.has(t.toString())||!e)return qs.exists(!0);if(e.isEqual(Oi.min()))throw new Ar(Tr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qs.updateTime(e)},Df.prototype.write=function(t){this.xh(),this.mutations=this.mutations.concat(t)},Df.prototype.xh=function(){},Df),Rf=(Of.prototype.run=function(){this.qh()},Of.prototype.qh=function(){var t=this;this.Yn.In(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Nf(this.du),(n=this.Bh(e))&&n.then(function(t){r.Ln.Bn(function(){return e.commit().then(function(){r.kn.resolve(t)}).catch(function(t){r.Qh(t)})})}).catch(function(t){r.Qh(t)}),[2]})})})},Of.prototype.Bh=function(t){try{var e=this.updateFunction(t);return!Pi(e)&&e.catch&&e.then?e:(this.kn.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.kn.reject(t),null}},Of.prototype.Qh=function(t){var e=this;0<this.Uh&&this.jh(t)?(--this.Uh,this.Ln.Bn(function(){return e.qh(),Promise.resolve()})):this.kn.reject(t)},Of.prototype.jh=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Hi(t)},Of),Lf=(Sf.prototype.start=function(t,e,n,r){var i=this;this.Gh(),this.Nc=t;var o=new ma,s=!1;return this.credentials.Eo(function(t){return s?void i.Ln.ss(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ln.us(),Or("RemoteStore","RemoteStore received new credentials"),n=pc(e),e.Tu.add(3),[4,oc(e)];case 1:return t.sent(),n&&e.yu.set("Unknown"),[4,e.wu.sh(i)];case 2:return t.sent(),e.Tu.delete(3),[4,ic(e)];case 3:return t.sent(),[2]}})})}(i.Ku,t)}):(s=!0,Or("FirestoreClient","Initializing. user=",t.uid),i.zh(e,n,r,t,o).then(i.Wh.resolve,i.Wh.reject))}),this.Ln.Bn(function(){return i.Wh.promise}),o.promise},Sf.prototype.enableNetwork=function(){var e=this;return this.Gh(),this.Ln.enqueue(function(){return e.persistence.lc(!0),(t=e.Ku).Tu.delete(0),ic(t);var t})},Sf.prototype.zh=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Ln:this.Ln,Nc:this.Nc,clientId:this.clientId,credentials:this.credentials,Yc:s,Ju:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Yu=r.Yu,this.Vi=r.Vi,this.zc=r.zc,this.du=i.du,this.Ku=i.Ku,this.eh=i.eh,this.Kh=i.Hu,this.Kh.ws=Vc.bind(null,this.eh),this.Kh.As=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Zu.get(o),1<(r=e.ta.get(n.targetId)).length?[2,(e.ta.set(n.targetId,r.filter(function(t){return!Mu(t,o)})),void e.Zu.delete(o))]:e.ca?(e.Yu.Gs(n.targetId),e.Yu.Ys(n.targetId)?[3,2]:[4,Oh(e.Vi,n.targetId,!1).then(function(){e.Yu.Ks(n.targetId),ac(e.Ku,n.targetId),Mc(e,n.targetId)}).catch(Vh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Mc(e,n.targetId),[4,Oh(e.Vi,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.eh),this.persistence.hc(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.Hh(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.zh(new cl,new ll,{Jc:!1},s,u))];case 4:return[2]}})})},Sf.prototype.Hh=function(t){return"FirebaseError"===t.name?t.code===Tr.FAILED_PRECONDITION||t.code===Tr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Sf.prototype.Gh=function(){if(this.Ln.Xn)throw new Ar(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},Sf.prototype.disableNetwork=function(){var t=this;return this.Gh(),this.Ln.enqueue(function(){return t.persistence.lc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Tu.add(0),[4,oc(e)];case 1:return t.sent(),e.yu.set("Offline"),[2]}})})}(t.Ku)})},Sf.prototype.terminate=function(){var t=this;this.Ln.ns();var n=new ma;return this.Ln.Zn(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.zc&&this.zc.stop(),[4,sc(this.Ku)];case 1:return t.sent(),[4,this.Yu.Zs()];case 2:return t.sent(),[4,this.persistence.Zs()];case 3:return t.sent(),this.credentials.To(),n.resolve(),[3,5];case 4:return e=t.sent(),e=Oa(e,"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},Sf.prototype.waitForPendingWrites=function(){var t=this;this.Gh();var e=new ma;return this.Ln.Bn(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:pc((n=o).Ku)||Or("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Vi).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Oi.wa(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.oa.get(r)||[]).push(s),n.oa.set(r,i),[3,4]);case 3:return i=t.sent(),i=Oa(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.eh,e)}),e.promise},Sf.prototype.listen=function(t,e,n){var r=this;this.Gh();var i=new fl(n),o=new Pa(t,i,e);return this.Ln.Bn(function(){return ka(r.Kh,o)}),function(){i.rh(),r.Ln.Bn(function(){return _a(r.Kh,o)})}},Sf.prototype.Yh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Gh(),[4,this.Wh.promise];case 1:return t.sent(),e=new ma,[2,(this.Ln.Bn(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.$i.ki(t,e)}))];case 1:return(r=t.sent())instanceof wu?s.resolve(r):r instanceof bu?s.resolve(null):s.reject(new Ar(Tr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Oa(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Vi,r,e)}),e.promise)]}})})},Sf.prototype.Jh=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.Gh(),[4,this.Wh.promise];case 1:return t.sent(),e=new ma,[2,(this.Ln.Bn(function(){return n=a.Kh,r=a.Ln,i=h,o=c,s=e,t=new fl({next:function(t){r.Bn(function(){return _a(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Ar(Tr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Ar(Tr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Pa(Ru(i.path),t,{includeMetadataChanges:!0,gs:!0}),ka(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},Sf.prototype.Xh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Gh(),[4,this.Wh.promise];case 1:return t.sent(),e=new ma,[2,(this.Ln.Bn(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Dh(r,i,!0)];case 1:return n=t.sent(),e=new Rc(i,n.Yr),n=e.Ou(n.documents),n=e.Uu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Oa(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Vi,r,e)}),e.promise)]}})})},Sf.prototype.Zh=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.Gh(),[4,this.Wh.promise];case 1:return t.sent(),u=new ma,[2,(this.Ln.Bn(function(){return e=a.Kh,n=a.Ln,t=h,r=c,i=u,o=new fl({next:function(t){n.Bn(function(){return _a(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Ar(Tr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Pa(t,o,{includeMetadataChanges:!0,gs:!0}),ka(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},Sf.prototype.write=function(t){var e=this;this.Gh();var n=new ma;return this.Ln.Bn(function(){return kc(e.eh,t,n)}),n.promise},Sf.prototype.B=function(){return this.Nc.B},Sf.prototype.tl=function(t){var e=this;this.Gh();var r=new fl(t);return this.Ln.Bn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Kh,n=r,e.ds.add(n),void n.next())];var e,n})})}),function(){r.rh(),e.Ln.Bn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Kh.ds.delete(r)]})})})}},Object.defineProperty(Sf.prototype,"el",{get:function(){return this.Ln.Xn},enumerable:!1,configurable:!0}),Sf.prototype.transaction=function(t){var e=this;this.Gh();var n=new ma;return this.Ln.Bn(function(){return new Rf(e.Ln,e.du,t,n).run(),Promise.resolve()}),n.promise},Sf.prototype.loadBundle=function(t,e){var n=this;this.Gh();var r=function(t,e){t="string"==typeof t?(new TextEncoder).encode(t):t;return new Za(Xa(t),e)}(t,$a(this.Nc.B));this.Ln.Bn(function(){return y(n,void 0,void 0,function(){return v(this,function(t){return[2,(Gc(this.eh,r,e),e.catch(function(t){Vr("FirestoreClient","Loading bundle failed with "+t)}))]})})})},Sf.prototype.ic=function(t){return this.Gh(),e=this.Vi,n=t,(r=e).persistence.runTransaction("Get named query","readonly",function(t){return r.br.ic(t,n)});var e,n,r},Sf);function Sf(t,e){this.credentials=t,this.Ln=e,this.clientId=pi.L(),this.Wh=new ma}function Of(t,e,n,r){this.Ln=t,this.du=e,this.updateFunction=n,this.kn=r,this.Uh=5,this.Yn=new wa(this.Ln,"transaction_retry")}function Df(t){this.du=t,this.Nh=new Map,this.mutations=[],this.Fh=!1,this.$h=null,this.Lh=new Set}function Vf(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var kf,_f,Uf=(tp.prototype.rl=function(t){switch(Uo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Bo(t.integerValue||t.doubleValue);case 3:return this.ol(t.timestampValue);case 4:return this.ul(t);case 5:return t.stringValue;case 6:return this.il(qo(t.bytesValue));case 7:return this.al(t.referenceValue);case 8:return this.cl(t.geoPointValue);case 9:return this.hl(t.arrayValue);case 10:return this.ll(t.mapValue);default:throw _r()}},tp.prototype.ll=function(t){var n=this,r={};return Cr(t.fields||{},function(t,e){r[t]=n.rl(e)}),r},tp.prototype.cl=function(t){return new Wl(Bo(t.latitude),Bo(t.longitude))},tp.prototype.hl=function(t){var e=this;return(t.values||[]).map(function(t){return e.rl(t)})},tp.prototype.ul=function(t){switch(this.nl){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return Vo(e)?t(e):e}(t);return null==e?null:this.rl(e);case"estimate":return this.ol(ko(t));default:return null}},tp.prototype.ol=function(t){t=jo(t),t=new Si(t.seconds,t.nanos);return this.timestampsInSnapshots?t:t.toDate()},tp.prototype.al=function(t){var e=jr.P(t);Ur(bs(e));t=new Ri(e.get(1),e.get(3)),e=new Gr(e.u(5));return t.isEqual(this.B)||Dr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.B.projectId+"/"+this.B.database+") instead."),this.sl(e)},tp),Pf=(Zf.prototype.onProgress=function(t,e,n){this._l={next:t,error:e,complete:n}},Zf.prototype.catch=function(t){return this.fl.promise.catch(t)},Zf.prototype.then=function(t,e){return this.fl.promise.then(t,e)},Zf.prototype.Ra=function(t){this.ya(t),this._l.complete&&this._l.complete(),this.fl.resolve(t)},Zf.prototype.Va=function(t){this.dl.taskState="Error",this._l.next&&this._l.next(this.dl),this._l.error&&this._l.error(t),this.fl.reject(t)},Zf.prototype.ya=function(t){this.dl=t,this._l.next&&this._l.next(t)},Zf),Cf=hh.ar,Mf=(Jf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Jf),xf=(Object.defineProperty($f.prototype,"pl",{get:function(){return this.gl||(this.gl=new cf(this.Ah,this.Vl.ignoreUndefinedProperties)),this.gl},enumerable:!1,configurable:!0}),$f.prototype.settings=function(t){Kr("Firestore.settings",arguments,1),Jr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Vl),t)).merge;t=new Mf(t);if(this.Il&&!this.Vl.isEqual(t))throw new Ar(Tr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Vl=t).credentials&&(this.Pl=function(t){if(!t)return new Fh;switch(t.type){case"gapi":var e=t.client;return Ur(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new qh(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ar(Tr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},$f.prototype.enableNetwork=function(){return this.Al(),this.Il.enableNetwork()},$f.prototype.disableNetwork=function(){return this.Al(),this.Il.disableNetwork()},$f.prototype.enablePersistence=function(t){var e;if(this.Il)throw new Ar(Tr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Dr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Ar(Tr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.vl(this.wl,this.ml,{Jc:!0,cacheSizeBytes:this.Vl.cacheSizeBytes,synchronizeTabs:n,bl:r})},$f.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Il&&!this.Il.el)throw new Ar(Tr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ma,[2,(this.Tl.Zn(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.wl.clearPersistence(this.Ah,this.yl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},$f.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty($f.prototype,"Sl",{get:function(){return this.Al(),this.Il.el},enumerable:!1,configurable:!0}),$f.prototype.waitForPendingWrites=function(){return this.Al(),this.Il.waitForPendingWrites()},$f.prototype.onSnapshotsInSync=function(t){if(this.Al(),Vf(t))return this.Il.tl(t);Jr("Firestore.onSnapshotsInSync","function",1,t);t={next:t};return this.Il.tl(t)},$f.prototype.loadBundle=function(t){this.Al();var e=new Pf;return this.Il.loadBundle(t,e),e},$f.prototype.namedQuery=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.Al(),[4,this.Il.ic(n)];case 1:return[2,(e=t.sent())?new sp(e.query,this,null):null]}})})},$f.prototype.Al=function(){return this.Il||this.vl(new cl,new ll,{Jc:!1}),this.Il},$f.prototype.Dl=function(){return new Ti(this.Ah,this.yl,this.Vl.host,this.Vl.ssl,this.Vl.experimentalForceLongPolling)},$f.prototype.vl=function(t,e,n){var r=this.Dl();return this.Il=new Lf(this.Pl,this.Tl),this.Il.start(r,t,e,n)},$f.Rl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ar(Tr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new Ar(Tr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ri(t)},Object.defineProperty($f.prototype,"app",{get:function(){if(!this.El)throw new Ar(Tr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.El},enumerable:!1,configurable:!0}),$f.prototype.collection=function(t){return Kr("Firestore.collection",arguments,1),Jr("Firestore.collection","non-empty string",1,t),this.Al(),new ap(jr.P(t),this,null)},$f.prototype.doc=function(t){return Kr("Firestore.doc",arguments,1),Jr("Firestore.doc","non-empty string",1,t),this.Al(),Bf.Cl(jr.P(t),this,null)},$f.prototype.collectionGroup=function(t){if(Kr("Firestore.collectionGroup",arguments,1),Jr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Al(),new sp((t=t,new Iu(jr.V(),t)),this,null)},$f.prototype.runTransaction=function(e){var n=this;return Kr("Firestore.runTransaction",arguments,1),Jr("Firestore.runTransaction","function",1,e),this.Al().transaction(function(t){return e(new Ff(n,t))})},$f.prototype.batch=function(){return this.Al(),new jf(this)},Object.defineProperty($f,"logLevel",{get:function(){switch(Sr()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),$f.setLogLevel=function(t){Kr("Firestore.setLogLevel",arguments,1),ri("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Rr.setLogLevel(t)},$f.prototype.Nl=function(){return this.Vl.timestampsInSnapshots},$f.prototype.Fl=function(){return this.Vl},$f),Ff=(Xf.prototype.get=function(t){var e=this;Kr("Transaction.get",arguments,1);var n=yp("Transaction.get",t,this.$l);return this.Ll.Oh([n.Ih]).then(function(t){if(!t||1!==t.length)return _r();t=t[0];if(t instanceof bu)return new Gf(e.$l,n.Ih,null,!1,!1,n.Rh);if(t instanceof wu)return new Gf(e.$l,n.Ih,t,!1,!1,n.Rh);throw _r()})},Xf.prototype.set=function(t,e,n){$r("Transaction.set",arguments,2,3);t=yp("Transaction.set",t,this.$l);n=fp("Transaction.set",n);e=vp(t.Rh,e,n),n=pf(this.$l.pl,"Transaction.set",t.Ih,e,null!==t.Rh,n);return this.Ll.set(t.Ih,n),this},Xf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof dl?(Xr("Transaction.update",arguments,3),r=yp("Transaction.update",t,this.$l),yf(this.$l.pl,"Transaction.update",r.Ih,e,n,i)):(Kr("Transaction.update",arguments,2),r=yp("Transaction.update",t,this.$l),df(this.$l.pl,"Transaction.update",r.Ih,e)),this.Ll.update(r.Ih,e),this},Xf.prototype.delete=function(t){Kr("Transaction.delete",arguments,1);t=yp("Transaction.delete",t,this.$l);return this.Ll.delete(t.Ih),this},Xf),jf=(Kf.prototype.set=function(t,e,n){$r("WriteBatch.set",arguments,2,3),this.kl();t=yp("WriteBatch.set",t,this.$l);n=fp("WriteBatch.set",n);e=vp(t.Rh,e,n),n=pf(this.$l.pl,"WriteBatch.set",t.Ih,e,null!==t.Rh,n);return this.Ol=this.Ol.concat(n.yh(t.Ih,qs.He())),this},Kf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.kl(),e="string"==typeof e||e instanceof dl?(Xr("WriteBatch.update",arguments,3),r=yp("WriteBatch.update",t,this.$l),yf(this.$l.pl,"WriteBatch.update",r.Ih,e,n,i)):(Kr("WriteBatch.update",arguments,2),r=yp("WriteBatch.update",t,this.$l),df(this.$l.pl,"WriteBatch.update",r.Ih,e)),this.Ol=this.Ol.concat(e.yh(r.Ih,qs.exists(!0))),this},Kf.prototype.delete=function(t){Kr("WriteBatch.delete",arguments,1),this.kl();t=yp("WriteBatch.delete",t,this.$l);return this.Ol=this.Ol.concat(new au(t.Ih,qs.He())),this},Kf.prototype.commit=function(){return this.kl(),this.xl=!0,0<this.Ol.length?this.$l.Al().write(this.Ol):Promise.resolve()},Kf.prototype.kl=function(){if(this.xl)throw new Ar(Tr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Kf),Bf=(n(Wf,_f=$l),Wf.Cl=function(t,e,n){if(t.length%2!=0)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new Wf(new Gr(t),e,n)},Object.defineProperty(Wf.prototype,"id",{get:function(){return this.Ih.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Wf.prototype,"parent",{get:function(){return new ap(this.Ih.path.h(),this.firestore,this.Rh)},enumerable:!1,configurable:!0}),Object.defineProperty(Wf.prototype,"path",{get:function(){return this.Ih.path.R()},enumerable:!1,configurable:!0}),Wf.prototype.collection=function(t){if(Kr("DocumentReference.collection",arguments,1),Jr("DocumentReference.collection","non-empty string",1,t),!t)throw new Ar(Tr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=jr.P(t);return new ap(this.Ih.path.child(t),this.firestore,null)},Wf.prototype.isEqual=function(t){if(!(t instanceof Wf))throw hi("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Ih.isEqual(t.Ih)&&this.Rh===t.Rh},Wf.prototype.set=function(t,e){$r("DocumentReference.set",arguments,1,2),e=fp("DocumentReference.set",e);t=vp(this.Rh,t,e),e=pf(this.firestore.pl,"DocumentReference.set",this.Ih,t,null!==this.Rh,e);return this.Il.write(e.yh(this.Ih,qs.He()))},Wf.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof dl?(Xr("DocumentReference.update",arguments,2),yf(this.firestore.pl,"DocumentReference.update",this.Ih,t,e,n)):(Kr("DocumentReference.update",arguments,1),df(this.firestore.pl,"DocumentReference.update",this.Ih,t)),this.Il.write(t.yh(this.Ih,qs.exists(!0)))},Wf.prototype.delete=function(){return Kr("DocumentReference.delete",arguments,0),this.Il.write([new au(this.Ih,qs.He())])},Wf.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];$r("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Vf(n[i])||(ai("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),ei("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};Vf(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Jr("DocumentReference.onSnapshot","function",i,n[i]),Zr("DocumentReference.onSnapshot","function",i+1,n[i+1]),Zr("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.Ml(t))},error:n[i+1],complete:n[i+2]};return this.Il.listen(Ru(this.Ih.path),o,s)},Wf.prototype.get=function(t){var e=this;$r("DocumentReference.get",arguments,0,1),dp("DocumentReference.get",t);var n=this.firestore.Al();return t&&"cache"===t.source?n.Yh(this.Ih).then(function(t){return new Gf(e.firestore,e.Ih,t,!0,t instanceof wu&&t.Ye,e.Rh)}):n.Jh(this.Ih,t).then(function(t){return e.Ml(t)})},Wf.prototype.withConverter=function(t){return new Wf(this.Ih,this.firestore,t)},Wf.prototype.Ml=function(t){var e=t.docs.get(this.Ih);return new Gf(this.firestore,this.Ih,e,t.fromCache,t.hasPendingWrites,this.Rh)},Wf),qf=(Yf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Yf),Gf=(Hf.prototype.data=function(t){var e=this;if($r("DocumentSnapshot.data",arguments,0,1),t=pp("DocumentSnapshot.data",t),this.Ul){if(this.Rh){var n=new zf(this.$l,this.Ih,this.Ul,this.ql,this.Bl,null);return this.Rh.fromFirestore(n,t)}return new Uf(this.$l.Ah,this.$l.Nl(),t.serverTimestamps||"none",function(t){return new Bf(t,e.$l,null)},function(t){return new Ni(t)}).rl(this.Ul.sn())}},Hf.prototype.get=function(t,e){var n=this;if($r("DocumentSnapshot.get",arguments,1,2),e=pp("DocumentSnapshot.get",e),this.Ul){t=this.Ul.data().field(Ef("DocumentSnapshot.get",t,this.Ih));if(null!==t)return new Uf(this.$l.Ah,this.$l.Nl(),e.serverTimestamps||"none",function(t){return new Bf(t,n.$l,n.Rh)},function(t){return new Ni(t)}).rl(t)}},Object.defineProperty(Hf.prototype,"id",{get:function(){return this.Ih.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"ref",{get:function(){return new Bf(this.Ih,this.$l,this.Rh)},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"exists",{get:function(){return null!==this.Ul},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"metadata",{get:function(){return new qf(this.Bl,this.ql)},enumerable:!1,configurable:!0}),Hf.prototype.isEqual=function(t){if(!(t instanceof Hf))throw hi("isEqual","DocumentSnapshot",1,t);return this.$l===t.$l&&this.ql===t.ql&&this.Ih.isEqual(t.Ih)&&(null===this.Ul?null===t.Ul:this.Ul.isEqual(t.Ul))&&this.Rh===t.Rh},Hf),zf=(n(Qf,kf=Gf),Qf.prototype.data=function(t){return kf.prototype.data.call(this,t)},Qf);function Qf(){return null!==kf&&kf.apply(this,arguments)||this}function Hf(t,e,n,r,i,o){this.$l=t,this.Ih=e,this.Ul=n,this.ql=r,this.Bl=i,this.Rh=o}function Yf(t,e){this.hasPendingWrites=t,this.fromCache=e}function Wf(t,e,n){var r=this;return(r=_f.call(this,e.Ah,t,n)||this).Ih=t,r.firestore=e,r.Rh=n,r.Il=r.firestore.Al(),r}function Kf(t){this.$l=t,this.Ol=[],this.xl=!1}function Xf(t,e){this.$l=t,this.Ll=e}function $f(t,e,n,r){var i=this;if(void 0===n&&(n=new cl),void 0===r&&(r=new ll),this.wl=n,this.ml=r,this.El=null,this.Tl=new Ra,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Al(),[4,this.Il.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){r=t;this.El=r,this.Ah=$f.Rl(r),this.yl=r.name,this.Pl=new jh(e)}else{t=t;if(!t.projectId)throw new Ar(Tr.INVALID_ARGUMENT,"Must provide projectId");this.Ah=new Ri(t.projectId,t.database),this.yl="[DEFAULT]",this.Pl=new Fh}this.Vl=new Mf({})}function Jf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ar(Tr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ti("settings","non-empty string","host",t.host),this.host=t.host,ei("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ai("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ei("settings","object","credentials",t.credentials),this.credentials=t.credentials,ei("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ei("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Dr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Dr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,ei("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=hh.hr;else{if(t.cacheSizeBytes!==Cf&&t.cacheSizeBytes<hh.cr)throw new Ar(Tr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+hh.cr);this.cacheSizeBytes=t.cacheSizeBytes}ei("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(t=t.experimentalForceLongPolling)&&void 0!==t&&t}function Zf(){this._l={},this.fl=new ma,this.dl={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function tp(t,e,n,r,i){this.B=t,this.timestampsInSnapshots=e,this.nl=n,this.sl=r,this.il=i}function ep(t,e,n){if("string"==typeof n){if(""===n)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vu(e)&&-1!==n.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(jr.P(n));if(!Gr.F(e))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Go(t,new Gr(e))}if(n instanceof $l)return Go(t,n.Ih);throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+si(n)+".")}function np(t,e){if(!Array.isArray(t)||0===t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function rp(t,e,n){if(!n.isEqual(e))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ip(t){if(Su(t)&&0===t.rn.length)throw new Ar(Tr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var op,sp=(lp.prototype.where=function(t,e,n){Kr("Query.where",arguments,3),ui("Query.where",3,n);e=ri("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=Ef("Query.where",t),e=function(t,e,n,r,i,o,s){if(i.g()){if("array-contains"===o||"array-contains-any"===o)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){np(s,o);for(var u=[],a=0,h=s;a<h.length;a++){var c=h[a];u.push(ep(r,t,c))}l={arrayValue:{values:u}}}else l=ep(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||np(s,o),l=vf(n,e,s,"in"===o||"not-in"===o);var l=Gu.create(i,o,l);return function(t,e){if(e.an()){var n=Du(t);if(null!==n&&!n.isEqual(e.field))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Ou(t);null!==n&&rp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,l),l}(this.Ql,"Query.where",this.firestore.pl,this.firestore.Ah,t,e,n);return new lp((n=this.Ql,e=n.filters.concat([e]),new Iu(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.Rh)},lp.prototype.orderBy=function(t,e){if($r("Query.orderBy",arguments,1,2),Zr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ar(Tr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Ef("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ga(e,n);return e=r,null!==Ou(n=t)||null!==(t=Du(n))&&rp(0,t,e.field),r}(this.Ql,t,n);return new lp((n=this.Ql,t=n.rn.concat([t]),new Iu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.Rh)},lp.prototype.limit=function(t){return Kr("Query.limit",arguments,1),Jr("Query.limit","number",1,t),ci("Query.limit",1,t),new lp(Uu(this.Ql,t,"F"),this.firestore,this.Rh)},lp.prototype.limitToLast=function(t){return Kr("Query.limitToLast",arguments,1),Jr("Query.limitToLast","number",1,t),ci("Query.limitToLast",1,t),new lp(Uu(this.Ql,t,"L"),this.firestore,this.Rh)},lp.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.startAt",arguments,1);t=this.jl("Query.startAt",t,e,!0);return new lp(Pu(this.Ql,t),this.firestore,this.Rh)},lp.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.startAfter",arguments,1);t=this.jl("Query.startAfter",t,e,!1);return new lp(Pu(this.Ql,t),this.firestore,this.Rh)},lp.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.endBefore",arguments,1);t=this.jl("Query.endBefore",t,e,!0);return new lp(Cu(this.Ql,t),this.firestore,this.Rh)},lp.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.endAt",arguments,1);t=this.jl("Query.endAt",t,e,!1);return new lp(Cu(this.Ql,t),this.firestore,this.Rh)},lp.prototype.isEqual=function(t){if(!(t instanceof lp))throw hi("isEqual","Query",1,t);return this.firestore===t.firestore&&Mu(this.Ql,t.Ql)&&this.Rh===t.Rh},lp.prototype.withConverter=function(t){return new lp(this.Ql,this.firestore,t)},lp.prototype.jl=function(h,t,e,n){if(ui(h,1,t),t instanceof Gf)return Kr(h,i([t],e),1),function(t,e,n,r){if(!n)throw new Ar(Tr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=ku(t);o<s.length;o++){var u=s[o];if(u.field.g())i.push(Go(e,n.key));else{var a=n.field(u.field);if(Vo(a))throw new Ar(Tr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.R();throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new ha(i,r)}(this.Ql,this.firestore.Ah,t.Ul,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Ar(Tr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.g()){if("string"!=typeof h)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Vu(t)&&-1!==h.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(jr.P(h));if(!Gr.F(c))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new Gr(c);u.push(Go(e,c))}else{h=vf(n,r,h);u.push(h)}}return new ha(u,o)}(this.Ql,this.firestore.Ah,this.firestore.pl,h,e,n)},lp.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];$r("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||Vf(n[o])||(ai("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),ei("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),Vf(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Jr("Query.onSnapshot","function",o,n[o]),Zr("Query.onSnapshot","function",o+1,n[o+1]),Zr("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new up(e.firestore,e.Ql,t,e.Rh))},error:n[o+1],complete:n[o+2]};return ip(this.Ql),this.firestore.Al().listen(this.Ql,i,s)},lp.prototype.get=function(t){var e=this;$r("Query.get",arguments,0,1),dp("Query.get",t),ip(this.Ql);var n=this.firestore.Al();return(t&&"cache"===t.source?n.Xh(this.Ql):n.Zh(this.Ql,t)).then(function(t){return new up(e.firestore,e.Ql,t,e.Rh)})},lp),up=(Object.defineProperty(cp.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(cp.prototype,"empty",{get:function(){return this.Gl.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(cp.prototype,"size",{get:function(){return this.Gl.docs.size},enumerable:!1,configurable:!0}),cp.prototype.forEach=function(e,n){var r=this;$r("QuerySnapshot.forEach",arguments,1,2),Jr("QuerySnapshot.forEach","function",1,e),this.Gl.docs.forEach(function(t){e.call(n,r.Hl(t,r.metadata.fromCache,r.Gl.Qt.has(t.key)))})},Object.defineProperty(cp.prototype,"query",{get:function(){return new sp(this.Wl,this.$l,this.Rh)},enumerable:!1,configurable:!0}),cp.prototype.docChanges=function(t){t&&(ai("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ei("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));t=!(!t||!t.includeMetadataChanges);if(t&&this.Gl.Wt)throw new Ar(Tr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.zl&&this.Kl===t||(this.zl=function(i,e,o){if(i.Bt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Bt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _r()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Gl,t,this.Hl.bind(this)),this.Kl=t),this.zl},cp.prototype.isEqual=function(t){if(!(t instanceof cp))throw hi("isEqual","QuerySnapshot",1,t);return this.$l===t.$l&&Mu(this.Wl,t.Wl)&&this.Gl.isEqual(t.Gl)&&this.Rh===t.Rh},cp.prototype.Hl=function(t,e,n){return new zf(this.$l,t.key,t,e,n,this.Rh)},cp),ap=(n(hp,op=sp),Object.defineProperty(hp.prototype,"id",{get:function(){return this.Ql.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(hp.prototype,"parent",{get:function(){var t=this.Ql.path.h();return t.m()?null:new Bf(new Gr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(hp.prototype,"path",{get:function(){return this.Ql.path.R()},enumerable:!1,configurable:!0}),hp.prototype.doc=function(t){$r("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=pi.L()),Jr("CollectionReference.doc","non-empty string",1,t);t=jr.P(t);return Bf.Cl(this.Ql.path.child(t),this.firestore,this.Rh)},hp.prototype.add=function(t){Kr("CollectionReference.add",arguments,1);t=this.Rh?this.Rh.toFirestore(t):t;Jr("CollectionReference.add","object",1,t);var e=this.doc();return new Bf(e.Ih,this.firestore,null).set(t).then(function(){return e})},hp.prototype.withConverter=function(t){return new hp(this.Yl,this.firestore,t)},hp);function hp(t,e,n){var r=this;if(((r=op.call(this,Ru(t),e,n)||this).Yl=t).length%2!=1)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function cp(t,e,n,r){this.$l=t,this.Wl=e,this.Gl=n,this.Rh=r,this.zl=null,this.Kl=null,this.metadata=new qf(n.hasPendingWrites,n.fromCache)}function lp(t,e,n){this.Ql=t,this.firestore=e,this.Rh=n}function fp(t,e){if(void 0===e)return{merge:!1};if(ai(t,e,["merge","mergeFields"]),ei(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+si(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+si(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof dl}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function pp(t,e){return void 0===e?{}:(ai(t,e,["serverTimestamps"]),ni(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function dp(t,e){Zr(t,"object",1,e),e&&(ai(t,e,["source"]),ni(t,0,"source",e.source,["default","server","cache"]))}function yp(t,e,n){if(e instanceof $l){if(e.firestore!==n)throw new Ar(Tr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw hi(t,"DocumentReference",1,e)}function vp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var gp,mp,l=(n(bp,gp=Kl),bp.serverTimestamp=function(){Wr("FieldValue.serverTimestamp",arguments);var t=new zl("serverTimestamp");return t.uh="FieldValue.serverTimestamp",new bp(t)},bp.delete=function(){Wr("FieldValue.delete",arguments);var t=new gl("deleteField");return t.uh="FieldValue.delete",new bp(t)},bp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayUnion()",arguments,1),new Ql("arrayUnion",t)}.apply(void 0,t);return n.uh="FieldValue.arrayUnion",new bp(n)},bp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayRemove()",arguments,1),new Hl("arrayRemove",t)}.apply(void 0,t);return n.uh="FieldValue.arrayRemove",new bp(n)},bp.increment=function(t){Jr("FieldValue.increment","number",1,t),Kr("FieldValue.increment",arguments,1);t=new Yl("increment",t);return t.uh="FieldValue.increment",new bp(t)},bp.prototype.isEqual=function(t){return this.Th.isEqual(t.Th)},bp),wp={Firestore:xf,GeoPoint:Wl,Timestamp:Si,Blob:Ni,Transaction:Ff,WriteBatch:jf,DocumentReference:Bf,DocumentSnapshot:Gf,Query:sp,QueryDocumentSnapshot:zf,QuerySnapshot:up,CollectionReference:ap,FieldPath:dl,FieldValue:l,setLogLevel:xf.setLogLevel,CACHE_SIZE_UNLIMITED:Cf};function bp(){return null!==gp&&gp.apply(this,arguments)||this}(mp=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new xf(e,t,new cl,new ll);var e},"PUBLIC").setServiceProps(Object.assign({},wp))),mp.registerVersion("@firebase/firestore","1.18.0-alpha.96ae6a5fe")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
