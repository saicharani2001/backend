!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Qy){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var f,e=t(Qy),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=f=f||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u={debug:f.DEBUG,verbose:f.VERBOSE,info:f.INFO,warn:f.WARN,error:f.ERROR,silent:f.SILENT},a=f.INFO,c=((Ie={})[f.DEBUG]="log",Ie[f.VERBOSE]="log",Ie[f.INFO]="info",Ie[f.WARN]="warn",Ie[f.ERROR]="error",Ie),h=(Object.defineProperty(l.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in f))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),l.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(l.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),l.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.DEBUG],t)),this._logHandler.apply(this,s([this,f.DEBUG],t))},l.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.VERBOSE],t)),this._logHandler.apply(this,s([this,f.VERBOSE],t))},l.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.INFO],t)),this._logHandler.apply(this,s([this,f.INFO],t))},l.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.WARN],t)),this._logHandler.apply(this,s([this,f.WARN],t))},l.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.ERROR],t)),this._logHandler.apply(this,s([this,f.ERROR],t))},l);function l(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){e=d.call(this,e)||this;return e.code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var c=a[u];"_"!==c.slice(-1)&&(c in s&&console.warn('Overwriting FirebaseError base field "'+c+'" can cause unexpected behavior.'),s[c]=i[c])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},x=N||self;function R(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),L=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:U).apply(null,arguments)}function V(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++L))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function W(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var K,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}t:{var J=x.navigator;if(J){J=J.userAgent;if(J){K=J;break t}}K=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=R;var rt,it=X(K,"Opera"),ot=X(K,"Trident")||X(K,"MSIE"),st=X(K,"Edge"),ut=st||ot,at=X(K,"Gecko")&&!(X(K.toLowerCase(),"webkit")&&!X(K,"Edge"))&&!(X(K,"Trident")||X(K,"MSIE"))&&!X(K,"Edge"),ct=X(K.toLowerCase(),"webkit")&&!X(K,"Edge");function ht(){var t=x.document;return t?t.documentMode:void 0}t:{var lt="",ft=(ft=K,at?/rv:([^\);]+)(\)|;)/.exec(ft):st?/Edge\/([\d\.]+)/.exec(ft):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):ct?/WebKit\/(\S+)/.exec(ft):it?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(lt=ft?ft[1]:""),ot){ft=ht();if(null!=ft&&ft>parseFloat(lt)){rt=String(ft);break t}}rt=lt}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=H(String(rt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=x.document&&ot?ht()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!x.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{x.addEventListener("test",R,e),x.removeEventListener("test",R,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},F(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Rt="closure_lm_"+(1e6*Math.random()|0),Dt={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=jt(r);return e&&e[It]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Ot(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[It]?t.va(e,n,O(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,c=Mt(t);if(c||(t[Rt]=c=new Nt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ut,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Lt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?St(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Lt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(St(n,t),0==n.b&&(n.src=null,e[Rt]=null)):At(t)))}function Lt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Ut(t,e){if(t.Y)return!0;if(vt)return Ct(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=x,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new bt(e,this))}function Mt(t){return(t=t[Rt])instanceof Nt?t:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==D(e)?e:(e[Vt]||(e[Vt]=function(t){return e.handleEvent(t)}),e[Vt])}function Ft(){q.call(this),this.c=new Nt(this),(this.J=this).C=null}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&St(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,q),Ft.prototype[It]=!0,(A=Ft.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=jt(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new wt(t,n):t instanceof wt?t.target=t.target||n:(s=t,et(t=new wt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=qt(o,r,!0,t)&&s;if(s=qt(o=t.a=n,r,!0,t)&&s,s=qt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=qt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(Ft.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=x.JSON.stringify;function Gt(){this.b=this.a=null}var Wt,zt=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Kt},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Ht(t,e){var n;Wt||(n=x.Promise.resolve(void 0),Wt=function(){n.then(Jt)}),Xt||(Wt(),Xt=!0),Yt.add(t,e)}Gt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),Yt=new Gt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){x.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function $t(t,e){Ft.call(this),this.b=t||1,this.a=e||x,this.f=M(this.Ya,this),this.g=j()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==D(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:x.setTimeout(t,e||0)}F($t,Ft),(A=$t.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},A.G=function(){$t.S.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(x.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e,n){var r=ee.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ue(t){q.call(this),this.b=t,this.a={}}F(ue,q);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function le(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.S.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var pe=null;function de(){return pe=pe||new Ft}function ye(t){wt.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){wt.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){wt.call(this,"timingevent",t)}function be(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return x.setTimeout(function(){t()},e)}F(ye,wt),F(ge,wt),F(we,wt);var Ee={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Te(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Te.prototype.a=null;var Ne,N={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Se(){wt.call(this,"d")}function xe(){wt.call(this,"c")}function Re(){}function De(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ue(this),this.P=ke,t=ut?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Se,wt),F(xe,wt),F(Re,Te),Ne=new Re;var ke=45e3,Oe={},Pe={};function Le(t,e,n){t.H=1,t.i=en(Xe(e)),t.j=n,t.I=!0,Ce(t,null)}function Ce(t,e){t.u=j(),Me(t),t.l=Xe(t.i);var s,u,a,c,h,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(M(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Pe:(i=Number(u.substring(i,o)),isNaN(i)?Oe:(o+=1)+i>u.length?Pe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Pe){4==e&&(t.h=4,me(14),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Oe){t.h=4,me(15),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),Fe(t))}function Me(t){t.U=j()+t.P,Ve(t,t.P)}function Ve(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(M(t.Ua,t),e)}function je(t){t.o&&(x.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||rr(t.g,t)}function qe(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),zn(u)}Zn(u),me(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(M(u.Ra,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!Q(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=j()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(_n(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),Me(o)),n.a=i):$n(n),0<u.g.length&&Hn(u)):"stop"!=c[0]&&"close"!=c[0]||or(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?or(u,7):Wn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ve(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof We)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=De.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),je(this);var i=this.a.X();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,me(12),qe(this),Fe(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,s)}this.I?(Ue(this,e,n),ut&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),Be(this,n)),4==e&&qe(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),qe(this),Fe(this)}}}catch(t){}var u,a,c,h,l,f},A.Va=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(je(this),Ue(this,t,e),this.b&&4!=t&&Me(this)))},A.cancel=function(){this.A=!0,qe(this)},A.Ua=function(){this.o=null;var t,e,n=j();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),qe(this),this.h=2,Fe(this)):Ve(this,this.U-n)},(A=We.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return ze(this),this.a.concat()},A.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},A.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof He?(this.a=void 0!==e?e:t.a,Ye(this,t.f),this.j=t.j,Je(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new We(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(Ke))?(this.a=!!e,Ye(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),$e(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Xe(t){return new He(t)}function Ye(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,cn)),t.b=new ln(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}He.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,hn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(n){n.a||(n.a=new We,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){fn(t),e=vn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function dn(t,e){return fn(t),e=vn(t,e),Qe(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),z(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=x.PerformanceNavigationTiming?0<(t=x.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(x.ia&&x.ia.ya&&x.ia.ya()&&x.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=ln.prototype).add=function(t,e){fn(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){fn(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=W(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},A.set=function(t,e){return fn(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Sn(){this.a=new Nn}function xn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return x.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return x.JSON.parse(t,void 0)};var Rn=x.JSON.parse;function Dn(t){Ft.call(this),this.headers=new We,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=kn,this.D=this.F=!1}F(Dn,Ft);var kn="",On=/^https?$/i,Pn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Cn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),Vn(t)}function Un(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Mn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=Fn(t)||2!=t.X()))if(t.l&&4==Fn(t))te(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ke)[1]||null)&&x.self&&x.self.location&&(i=(r=x.self.location.protocol).substr(0,r.length-1)),n=!On.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Un(t)}}finally{Vn(t)}}}function Vn(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?R:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(x.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Bn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Bn("baseRetryDelayMs",5e3,t),this.Ma=Bn("retryDelaySeedMs",1e4,t),this.Ja=Bn("forwardChannelMaxRetries",2,t),this.ma=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Wn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,tn(n=Xe(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Yn(t,n),(e=new De(t,t.c,e,void 0)).H=2,e.i=en(Xe(n)),n=!1,x.navigator&&x.navigator.sendBeacon&&(n=x.navigator.sendBeacon(e.i.toString(),"")),!n&&x.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=j(),Me(e)),sr(t)}function zn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Qn(t){zn(t),t.j&&(x.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&x.clearTimeout(t.h),t.h=null)}function Kn(t,e){t.g.push(new gn(t.La++,e)),3==t.v&&Hn(t)}function Hn(t){bn(t.b)||t.h||(t.h=!0,Ht(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Yn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new De(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Le(n,r,e)}function Yn(t,n){t.f&&Ge({},function(t,e){tn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;O(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.U=1,Ht(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=be(M(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(x.clearTimeout(t.s),t.s=null)}function er(t){t.a=new De(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Yn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Xe(e)),n.j=null,n.I=!0,Ce(n,t)}function nr(t){null!=t.m&&(x.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r=null;if(t.a==e){nr(t),tr(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,_n(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,(i=de()).dispatchEvent(new we(i)),Hn(t)):$n(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=be(M(t.Ba,t,e),ir(t,t.u)),t.u++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=M(t.Xa,t),r||(r=new He("//www.google.com/images/cleardot.gif"),x.location&&"http"==x.location.protocol||Ye(r,"https"),en(r)),n=r.toString(),r=o,o=new le,x.Image?((i=new Image).onload=V(xn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(xn,o,i,"TestLoadImage: error",!1,r),i.onabort=V(xn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(xn,o,i,"TestLoadImage: timeout",!1,r),x.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Qn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof He?Xe(s):new He(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),$e(a,a.h)):(u=x.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new He(null,void 0),r&&Ye(u,r),i&&Je(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.W&&$(t.W,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Yn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Ka)).F=t.C,e}function cr(){}function hr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){Ft.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function fr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){xe.call(this),this.status=1}function dr(t){this.a=t}(A=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Ne),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Cn(this,t)}t=n||"";var i,o=new We(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=x.FormData&&t instanceof x.FormData,0<=B(Pn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Cn(this,t)}},A.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Vn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vn(this,!0)),Dn.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ta())},A.Ta=function(){Mn(this)},A.X=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Gn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new De(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),tn(i=Xe(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Yn(this,i),this.i&&r&&qn(i,this.i,r),Tn(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||bn(this.b)||Xn(this))},A.Aa=function(){var t;this.j=null,er(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(M(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),er(this))},A.Ra=function(){null!=this.m&&(this.m=null,zn(this),Zn(this),me(19))},A.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(A=cr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},hr.prototype.a=function(t,e){return new lr(t,e)},F(lr,Ft),(A=lr.prototype).addEventListener=function(t,e,n,r){lr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){lr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=ur(t,null,t.fa),Hn(t)},A.close=function(){Wn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Kn(this.a,e)):this.g?((e={}).__data__=Bt(t),Kn(this.a,e)):Kn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Wn(this.a),delete this.a,lr.S.G.call(this)},F(fr,Se),F(pr,xe),F(dr,cr),dr.prototype.ta=function(){this.a.dispatchEvent("a")},dr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},dr.prototype.ra=function(t){this.a.dispatchEvent(new pr)},dr.prototype.qa=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,lr.prototype.send=lr.prototype.Pa,lr.prototype.open=lr.prototype.Oa,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ae.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Qa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.X,Dn.prototype.getResponseJson=Dn.prototype.Na,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var Ee={createWebChannelTransport:function(){return new hr},ErrorCode:Ee,EventType:Ie,WebChannel:Ae,XhrIo:Dn},yr=Ee.createWebChannelTransport,vr=Ee.ErrorCode,gr=Ee.EventType,mr=Ee.WebChannel,wr=Ee.XhrIo,br=(Er.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Er.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Er.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Er);function Er(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir,Tr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},_r=(n(Sr,Ir=Error),Sr),Ar="7.22.1-alpha.96ae6a5fe",Nr=new h("@firebase/firestore");function Sr(t,e){var n=this;return(n=Ir.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function xr(){return Nr.logLevel}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=f.DEBUG&&(e=n.map(Or),Nr.debug.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=f.ERROR&&(e=n.map(Or),Nr.error.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=f.WARN&&(e=n.map(Or),Nr.warn.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Or(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Ar+") INTERNAL ASSERTION FAILED: "+t;throw Dr(t),new Error(t)}function Lr(t){t||Pr()}function Cr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Ur(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Mr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Vr,jr,Ie=(Object.defineProperty(Kr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Kr.prototype.isEqual=function(t){return 0===Kr.i(this,t)},Kr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Kr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Kr.prototype.limit=function(){return this.offset+this.length},Kr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Kr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Kr.prototype.l=function(){return this.segments[this.offset]},Kr.prototype._=function(){return this.get(this.length-1)},Kr.prototype.get=function(t){return this.segments[this.offset+t]},Kr.prototype.m=function(){return 0===this.length},Kr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Kr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Kr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Kr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},Kr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Kr),Fr=(n(Qr,jr=Ie),Qr.prototype.o=function(t,e,n){return new Qr(t,e,n)},Qr.prototype.R=function(){return this.A().join("/")},Qr.prototype.toString=function(){return this.R()},Qr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Qr(n)},Qr.g=function(){return new Qr([])},Qr),qr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Br=(n(zr,Vr=Ie),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.V=function(t){return qr.test(t)},zr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),zr.V(t)||(t="`"+t+"`"),t}).join(".")},zr.prototype.toString=function(){return this.R()},zr.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},zr.v=function(){return new zr(["__name__"])},zr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new _r(Tr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new _r(Tr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new _r(Tr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zr(e)},zr.g=function(){return new zr([])},zr),Gr=(Wr.D=function(t){return new Wr(Fr.P(t))},Wr.C=function(t){return new Wr(Fr.P(t).u(5))},Wr.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Wr.prototype.isEqual=function(t){return null!==t&&0===Fr.i(this.path,t.path)},Wr.prototype.toString=function(){return this.path.toString()},Wr.i=function(t,e){return Fr.i(t.path,e.path)},Wr.F=function(t){return t.length%2==0},Wr.$=function(t){return new Wr(new Fr(t.slice()))},Wr);function Wr(t){this.path=t}function zr(){return null!==Vr&&Vr.apply(this,arguments)||this}function Qr(){return null!==jr&&jr.apply(this,arguments)||this}function Kr(t,e,n){void 0===e?e=0:e>t.length&&Pr(),void 0===n?n=t.length-e:n>t.length-e&&Pr(),this.segments=t,this.offset=e,this.t=n}function Hr(t,e){if(0!==e.length)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+fi(e.length,"argument")+".")}function Xr(t,e,n){if(e.length!==n)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Yr(t,e,n){if(e.length<n)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Jr(t,e,n,r){if(e.length<n||e.length>r)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+fi(e.length,"argument")+".")}function $r(t,e,n,r){ii(t,e,li(n)+" argument",r)}function Zr(t,e,n,r){void 0!==r&&$r(t,e,n,r)}function ti(t,e,n,r){ii(t,e,n+" option",r)}function ei(t,e,n,r){void 0!==r&&ti(t,e,n,r)}function ni(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(si(s))}var u=si(n);throw new _r(Tr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ri(t,e,n,r){if(!e.some(function(t){return t===r}))throw new _r(Tr.INVALID_ARGUMENT,"Invalid value "+si(r)+" provided to function "+t+"() for its "+li(n)+" argument. Acceptable values: "+e.join(", "));return r}function ii(t,e,n,r){if(!("object"===e?oi(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){r=si(r);throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function oi(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function si(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ui(t,e,n){if(void 0===n)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+li(e)+" argument, but it was undefined.")}function ai(n,t,r){Ur(t,function(t,e){if(r.indexOf(t)<0)throw new _r(Tr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ci(t,e,n,r){r=si(r);return new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+li(n)+" argument to be a "+e+", but it was: "+r)}function hi(t,e,n){if(n<=0)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+li(e)+" argument to be a positive number, but it was: "+n+".")}function li(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function fi(t,e){return t+" "+e+(1===t?"":"s")}var pi=(di.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},di);function di(){}function yi(t,e){return t<e?-1:e<t?1:0}function vi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function gi(t){return t+"\0"}var mi=(wi.fromBase64String=function(t){return new wi(atob(t))},wi.fromUint8Array=function(t){return new wi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},wi.prototype.toBase64=function(){return t=this.M,btoa(t);var t},wi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},wi.prototype.O=function(){return 2*this.M.length},wi.prototype.L=function(t){return yi(this.M,t.M)},wi.prototype.isEqual=function(t){return this.M===t.M},wi);function wi(t){this.M=t}mi.B=new mi("");var bi=(Ei.fromBase64String=function(t){try{return new Ei(mi.fromBase64String(t))}catch(t){throw new _r(Tr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Ei.fromUint8Array=function(t){return new Ei(mi.fromUint8Array(t))},Ei.prototype.toBase64=function(){return this.q.toBase64()},Ei.prototype.toUint8Array=function(){return this.q.toUint8Array()},Ei.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Ei.prototype.isEqual=function(t){return this.q.isEqual(t.q)},Ei);function Ei(t){this.q=t}function Ii(){if("undefined"==typeof Uint8Array)throw new _r(Tr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ti(){if("undefined"==typeof atob)throw new _r(Tr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function _i(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ai,Ni=(n(Ci,Ai=bi),Ci.fromBase64String=function(t){Xr("Blob.fromBase64String",arguments,1),$r("Blob.fromBase64String","string",1,t),Ti();try{return new Ci(mi.fromBase64String(t))}catch(t){throw new _r(Tr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Ci.fromUint8Array=function(t){if(Xr("Blob.fromUint8Array",arguments,1),Ii(),!(t instanceof Uint8Array))throw ci("Blob.fromUint8Array","Uint8Array",1,t);return new Ci(mi.fromUint8Array(t))},Ci.prototype.toBase64=function(){return Xr("Blob.toBase64",arguments,0),Ti(),Ai.prototype.toBase64.call(this)},Ci.prototype.toUint8Array=function(){return Xr("Blob.toUint8Array",arguments,0),Ii(),Ai.prototype.toUint8Array.call(this)},Ci.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Ci),Si=(Object.defineProperty(Li.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Li.prototype.isEqual=function(t){return t instanceof Li&&t.projectId===this.projectId&&t.database===this.database},Li.prototype.L=function(t){return yi(this.projectId,t.projectId)||yi(this.database,t.database)},Li),xi=(Pi.prototype.get=function(t){var e=this.j(t),e=this.G[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.K(o,t))return i}},Pi.prototype.has=function(t){return void 0!==this.get(t)},Pi.prototype.set=function(t,e){var n=this.j(t),r=this.G[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.G[n]=[[t,e]]},Pi.prototype.delete=function(t){var e=this.j(t),n=this.G[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.G[e]:n.splice(r,1),!0;return!1},Pi.prototype.forEach=function(s){Ur(this.G,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},Pi.prototype.m=function(){return Mr(this.G)},Pi),Ri=(Oi.now=function(){return Oi.fromMillis(Date.now())},Oi.fromDate=function(t){return Oi.fromMillis(t.getTime())},Oi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Oi(e,1e6*(t-1e3*e))},Oi.prototype.toDate=function(){return new Date(this.toMillis())},Oi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Oi.prototype.H=function(t){return this.seconds===t.seconds?yi(this.nanoseconds,t.nanoseconds):yi(this.seconds,t.seconds)},Oi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Oi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Oi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Oi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Oi),Di=(ki.J=function(t){return new ki(t)},ki.min=function(){return new ki(new Ri(0,0))},ki.prototype.L=function(t){return this.timestamp.H(t.timestamp)},ki.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ki.prototype.Y=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ki.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ki.prototype.X=function(){return this.timestamp},ki);function ki(t){this.timestamp=t}function Oi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Pi(t,e){this.j=t,this.K=e,this.G={}}function Li(t,e){this.projectId=t,this.database=e||"(default)"}function Ci(){return null!==Ai&&Ai.apply(this,arguments)||this}function Ui(t){return null==t}function Mi(t){return 0===t&&1/t==-1/0}function Vi(t){return"number"==typeof t&&Number.isInteger(t)&&!Mi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var ji=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Fi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ji(t,e,n,r,i,o,s)}function qi(t){var e=t;return null===e.Z&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+qo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Ui(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Ea(e.startAt)),e.endAt&&(t+="|ub:",t+=Ea(e.endAt)),e.Z=t),e.Z}function Bi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Mo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ta(t.startAt,e.startAt)&&Ta(t.endAt,e.endAt)}function Gi(t){return Gr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Wi(t){this.count=t}var zi,Qi=(Ki.prototype.nt=function(t){return new Ki(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ki.prototype.st=function(t,e){return new Ki(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ki.prototype.it=function(t){return new Ki(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},Ki);function Ki(t,e,n,r,i,o,s){void 0===i&&(i=Di.min()),void 0===o&&(o=Di.min()),void 0===s&&(s=mi.B),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Hi(t){switch(t){case Tr.OK:return Pr(),0;case Tr.CANCELLED:case Tr.UNKNOWN:case Tr.DEADLINE_EXCEEDED:case Tr.RESOURCE_EXHAUSTED:case Tr.INTERNAL:case Tr.UNAVAILABLE:case Tr.UNAUTHENTICATED:return;case Tr.INVALID_ARGUMENT:case Tr.NOT_FOUND:case Tr.ALREADY_EXISTS:case Tr.PERMISSION_DENIED:case Tr.FAILED_PRECONDITION:case Tr.ABORTED:case Tr.OUT_OF_RANGE:case Tr.UNIMPLEMENTED:case Tr.DATA_LOSS:return 1;default:return Pr(),0}}function Xi(t){if(void 0===t)return Dr("GRPC error has no .code"),Tr.UNKNOWN;switch(t){case zi.OK:return Tr.OK;case zi.CANCELLED:return Tr.CANCELLED;case zi.UNKNOWN:return Tr.UNKNOWN;case zi.DEADLINE_EXCEEDED:return Tr.DEADLINE_EXCEEDED;case zi.RESOURCE_EXHAUSTED:return Tr.RESOURCE_EXHAUSTED;case zi.INTERNAL:return Tr.INTERNAL;case zi.UNAVAILABLE:return Tr.UNAVAILABLE;case zi.UNAUTHENTICATED:return Tr.UNAUTHENTICATED;case zi.INVALID_ARGUMENT:return Tr.INVALID_ARGUMENT;case zi.NOT_FOUND:return Tr.NOT_FOUND;case zi.ALREADY_EXISTS:return Tr.ALREADY_EXISTS;case zi.PERMISSION_DENIED:return Tr.PERMISSION_DENIED;case zi.FAILED_PRECONDITION:return Tr.FAILED_PRECONDITION;case zi.ABORTED:return Tr.ABORTED;case zi.OUT_OF_RANGE:return Tr.OUT_OF_RANGE;case zi.UNIMPLEMENTED:return Tr.UNIMPLEMENTED;case zi.DATA_LOSS:return Tr.DATA_LOSS;default:return Pr()}}(Ee=zi=zi||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var Yi=(eo.prototype.rt=function(t,e){return new eo(this.i,this.root.rt(t,e,this.i).copy(null,null,$i.ot,null,null))},eo.prototype.remove=function(t){return new eo(this.i,this.root.remove(t,this.i).copy(null,null,$i.ot,null,null))},eo.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},eo.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},eo.prototype.m=function(){return this.root.m()},Object.defineProperty(eo.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),eo.prototype.at=function(){return this.root.at()},eo.prototype.ut=function(){return this.root.ut()},eo.prototype.ct=function(t){return this.root.ct(t)},eo.prototype.forEach=function(n){this.ct(function(t,e){return n(t,e),!1})},eo.prototype.toString=function(){var n=[];return this.ct(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},eo.prototype.ht=function(t){return this.root.ht(t)},eo.prototype.lt=function(){return new Ji(this.root,null,this.i,!1)},eo.prototype._t=function(t){return new Ji(this.root,t,this.i,!1)},eo.prototype.ft=function(){return new Ji(this.root,null,this.i,!0)},eo.prototype.dt=function(t){return new Ji(this.root,t,this.i,!0)},eo),Ji=(to.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},to.prototype.It=function(){return 0<this.Tt.length},to.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},to),$i=(Zi.prototype.copy=function(t,e,n,r,i){return new Zi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Zi.prototype.m=function(){return!1},Zi.prototype.ct=function(t){return this.left.ct(t)||t(this.key,this.value)||this.right.ct(t)},Zi.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Zi.prototype.min=function(){return this.left.m()?this:this.left.min()},Zi.prototype.at=function(){return this.min().key},Zi.prototype.ut=function(){return this.right.m()?this.key:this.right.ut()},Zi.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},Zi.prototype.Pt=function(){if(this.left.m())return Zi.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},Zi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.yt()||r.left.left.yt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.yt()&&(r=r.Vt()),r.right.m()||r.right.yt()||r.right.left.yt()||(r=r.bt()),0===e(t,r.key)){if(r.right.m())return Zi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},Zi.prototype.yt=function(){return this.color},Zi.prototype.Rt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.vt()),t.left.yt()&&t.left.left.yt()&&(t=t.Vt()),t.left.yt()&&t.right.yt()&&(t=t.St()),t},Zi.prototype.gt=function(){var t=this.St();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).vt()).St()),t},Zi.prototype.bt=function(){var t=this.St();return t.left.left.yt()&&(t=(t=t.Vt()).St()),t},Zi.prototype.vt=function(){var t=this.copy(null,null,Zi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Zi.prototype.Vt=function(){var t=this.copy(null,null,Zi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Zi.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Zi.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},Zi.prototype.Ct=function(){if(this.yt()&&this.left.yt())throw Pr();if(this.right.yt())throw Pr();var t=this.left.Ct();if(t!==this.right.Ct())throw Pr();return t+(this.yt()?0:1)},Zi);function Zi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Zi.RED,this.left=null!=r?r:Zi.EMPTY,this.right=null!=i?i:Zi.EMPTY,this.size=this.left.size+1+this.right.size}function to(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function eo(t,e){this.i=t,this.root=e||$i.EMPTY}function no(){this.size=0}$i.EMPTY=null,$i.RED=!0,$i.ot=!1,$i.EMPTY=(Object.defineProperty(no.prototype,"key",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"value",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"color",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"left",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"right",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),no.prototype.copy=function(t,e,n,r,i){return this},no.prototype.rt=function(t,e,n){return new $i(t,e)},no.prototype.remove=function(t,e){return this},no.prototype.m=function(){return!0},no.prototype.ct=function(t){return!1},no.prototype.ht=function(t){return!1},no.prototype.at=function(){return null},no.prototype.ut=function(){return null},no.prototype.yt=function(){return!1},no.prototype.Dt=function(){return!0},no.prototype.Ct=function(){return 0},new no);var ro=(uo.prototype.has=function(t){return null!==this.data.get(t)},uo.prototype.first=function(){return this.data.at()},uo.prototype.last=function(){return this.data.ut()},Object.defineProperty(uo.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),uo.prototype.indexOf=function(t){return this.data.indexOf(t)},uo.prototype.forEach=function(n){this.data.ct(function(t,e){return n(t),!1})},uo.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},uo.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},uo.prototype.$t=function(t){t=this.data._t(t);return t.It()?t.Et().key:null},uo.prototype.lt=function(){return new io(this.data.lt())},uo.prototype._t=function(t){return new io(this.data._t(t))},uo.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},uo.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},uo.prototype.m=function(){return this.data.m()},uo.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},uo.prototype.isEqual=function(t){if(!(t instanceof uo))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},uo.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},uo.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},uo.prototype.copy=function(t){var e=new uo(this.i);return e.data=t,e},uo),io=(so.prototype.Et=function(){return this.kt.Et().key},so.prototype.It=function(){return this.kt.It()},so),oo=new Yi(Gr.i);function so(t){this.kt=t}function uo(t){this.i=t,this.data=new Yi(this.i)}var ao=new Yi(Gr.i);var co=new Yi(Gr.i);var ho=new ro(Gr.i);function lo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ho,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var fo=new ro(yi);var po=(Do.Lt=function(t){return new Do(t.i)},Do.prototype.has=function(t){return null!=this.Mt.get(t)},Do.prototype.get=function(t){return this.Mt.get(t)},Do.prototype.first=function(){return this.Ot.at()},Do.prototype.last=function(){return this.Ot.ut()},Do.prototype.m=function(){return this.Ot.m()},Do.prototype.indexOf=function(t){t=this.Mt.get(t);return t?this.Ot.indexOf(t):-1},Object.defineProperty(Do.prototype,"size",{get:function(){return this.Ot.size},enumerable:!1,configurable:!0}),Do.prototype.forEach=function(n){this.Ot.ct(function(t,e){return n(t),!1})},Do.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.rt(t.key,t),e.Ot.rt(t,null))},Do.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Ot.remove(e)):this},Do.prototype.isEqual=function(t){if(!(t instanceof Do))return!1;if(this.size!==t.size)return!1;for(var e=this.Ot.lt(),n=t.Ot.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Do.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Do.prototype.copy=function(t,e){var n=new Do;return n.i=this.i,n.Mt=t,n.Ot=e,n},Do),yo=(Ro.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);!n||0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):Pr()},Ro.prototype.qt=function(){var n=[];return this.Bt.ct(function(t,e){n.push(e)}),n},Ro),vo=(xo.Kt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new xo(t,e,po.Lt(e),i,n,r,!0,!1)},Object.defineProperty(xo.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),xo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&Wu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},xo),go=(So.Yt=function(t,e){var n=new Map;return n.set(t,mo.Xt(t,e)),new So(Di.min(),n,fo,oo,lo())},So),mo=(No.Xt=function(t,e){return new No(mi.B,e,lo(),lo(),lo())},No),wo=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},bo=function(t,e){this.targetId=t,this.re=e},Eo=function(t,e,n,r){void 0===n&&(n=mi.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Io=(Object.defineProperty(Ao.prototype,"Zt",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Ao.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(Ao.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Ao.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Ao.prototype.fe=function(t){0<t.O()&&(this.he=!0,this.ue=t)},Ao.prototype.de=function(){var n=lo(),r=lo(),i=lo();return this.ae.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Pr()}}),new mo(this.ue,this.ce,n,r,i)},Ao.prototype.we=function(){this.he=!1,this.ae=Oo()},Ao.prototype.me=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},Ao.prototype.Te=function(t){this.he=!0,this.ae=this.ae.remove(t)},Ao.prototype.Ee=function(){this.oe+=1},Ao.prototype.Ie=function(){--this.oe},Ao.prototype.Ae=function(){this.he=!0,this.ce=!0},Ao),To=(_o.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Au?this.be(r,t.ie):t.ie instanceof Nu&&this.ve(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ve(s,t.key,t.ie)}},_o.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.Fe(t),e.fe(n.resumeToken));break;default:Pr()}})},_o.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},_o.prototype.$e=function(t){var e=t.targetId,n=t.re.count,t=this.xe(e);t&&(Gi(t=t.target)?0===n?(t=new Gr(t.path),this.ve(e,t,new Nu(t,Di.min()))):Lr(1===n):this.ke(e)!==n&&(this.Fe(e),this.Ve=this.Ve.add(e)))},_o.prototype.Me=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.xe(e);n&&(t.Zt&&Gi(n.target)&&(n=new Gr(n.target.path),null!==i.ye.get(n)||i.Oe(e,n)||i.ve(e,n,new Nu(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=lo();this.ge.forEach(function(t,e){var n=!0;e.Ft(function(t){t=i.xe(t);return!t||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new go(r,o,this.Ve,this.ye,s);return this.ye=oo,this.ge=ko(),this.Ve=new ro(yi),t},_o.prototype.be=function(t,e){var n;this.Ne(t)&&(n=this.Oe(t,e.key)?2:0,this.Ce(t).me(e.key,n),this.ye=this.ye.rt(e.key,e),this.ge=this.ge.rt(e.key,this.Le(e.key).add(t)))},_o.prototype.ve=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.Oe(t,e)?r.me(e,1):r.Te(e),this.ge=this.ge.rt(e,this.Le(e).delete(t)),n&&(this.ye=this.ye.rt(e,n)))},_o.prototype.removeTarget=function(t){this.Pe.delete(t)},_o.prototype.ke=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},_o.prototype.Ee=function(t){this.Ce(t).Ee()},_o.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new Io,this.Pe.set(t,e)),e},_o.prototype.Le=function(t){var e=this.ge.get(t);return e||(e=new ro(yi),this.ge=this.ge.rt(t,e)),e},_o.prototype.Ne=function(t){var e=null!==this.xe(t);return e||Rr("WatchChangeAggregator","Detected inactive target",t),e},_o.prototype.xe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},_o.prototype.Fe=function(e){var n=this;this.Pe.set(e,new Io),this.Re.Be(e).forEach(function(t){n.ve(e,t,null)})},_o.prototype.Oe=function(t,e){return this.Re.Be(t).has(e)},_o);function _o(t){this.Re=t,this.Pe=new Map,this.ye=oo,this.ge=ko(),this.Ve=new ro(yi)}function Ao(){this.oe=0,this.ae=Oo(),this.ue=mi.B,this.ce=!1,this.he=!0}function No(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function So(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Jt=i}function xo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function Ro(){this.Bt=new Yi(Gr.i)}function Do(n){this.i=n?function(t,e){return n(t,e)||Gr.i(t.key,e.key)}:function(t,e){return Gr.i(t.key,e.key)},this.Mt=ao,this.Ot=new Yi(this.i)}function ko(){return new Yi(Gr.i)}function Oo(){return new Yi(Gr.i)}function Po(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Lo(t){t=Bo(t.mapValue.fields.__local_write_time__.timestampValue);return new Ri(t.seconds,t.nanos)}var Co=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Uo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Po(t)?4:10:Pr()}function Mo(r,i){var t,e=Uo(r);if(e!==Uo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Lo(r).isEqual(Lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Bo(r.timestampValue),t=Bo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Wo(r.bytesValue).isEqual(Wo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Go((t=r).geoPointValue.latitude)===Go(e.geoPointValue.latitude)&&Go(t.geoPointValue.longitude)===Go(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Go(t.integerValue)===Go(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Go(t.doubleValue),e=Go(e.doubleValue);return t===e?Mi(t)===Mi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return vi(r.arrayValue.values||[],i.arrayValue.values||[],Mo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Cr(e)!==Cr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Mo(e[t],n[t])))return!1;return!0}();default:return Pr()}}function Vo(t,e){return void 0!==(t.values||[]).find(function(t){return Mo(t,e)})}function jo(t,e){var n,r,i=Uo(t),o=Uo(e);if(i!==o)return yi(i,o);switch(i){case 0:return 0;case 1:return yi(t.booleanValue,e.booleanValue);case 2:return n=e,r=Go(t.integerValue||t.doubleValue),n=Go(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Fo(t.timestampValue,e.timestampValue);case 4:return Fo(Lo(t),Lo(e));case 5:return yi(t.stringValue,e.stringValue);case 6:return function(t,e){t=Wo(t),e=Wo(e);return t.L(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=yi(n[i],r[i]);if(0!==o)return o}return yi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=yi(Go(i.latitude),Go(r.latitude)))?n:yi(Go(i.longitude),Go(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=jo(n[i],r[i]);if(o)return o}return yi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=yi(r[s],o[s]);if(0!==u)return u;u=jo(n[r[s]],i[o[s]]);if(0!==u)return u}return yi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Pr()}}function Fo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return yi(t,e);var n=Bo(t),t=Bo(e),e=yi(n.seconds,t.seconds);return 0!==e?e:yi(n.nanos,t.nanos)}function qo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Bo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Wo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Gr.C(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Pr();var e}(t)}function Bo(t){if(Lr(!!t),"string"!=typeof t)return{seconds:Go(t.seconds),nanos:Go(t.nanos)};var e=0,n=Co.exec(t);Lr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Go(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Wo(t){return"string"==typeof t?mi.fromBase64String(t):mi.fromUint8Array(t)}function zo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Qo(t){return t&&"integerValue"in t}function Ko(t){return!!t&&"arrayValue"in t}function Ho(t){return t&&"nullValue"in t}function Xo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yo(t){return t&&"mapValue"in t}var Jo={asc:"ASCENDING",desc:"DESCENDING"},$o={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Zo=function(t,e){this.U=t,this.Ue=e};function ts(t){return{integerValue:""+t}}function es(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mi(e)?"-0":e}}function ns(t,e){return Vi(e)?ts(e):es(t,e)}function rs(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function is(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function os(t){return Lr(!!t),Di.J((t=Bo(t),new Ri(t.seconds,t.nanos)))}function ss(t,e){return new Fr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function us(t){t=Fr.P(t);return Lr(Ns(t)),t}function as(t,e){return ss(t.U,e.path)}function cs(t,e){e=us(e);return Lr(e.get(1)===t.U.projectId),Lr(!e.get(3)&&!t.U.database||e.get(3)===t.U.database),new Gr(ps(e))}function hs(t,e){return ss(t.U,e)}function ls(t){t=us(t);return 4===t.length?Fr.g():ps(t)}function fs(t){return new Fr(["projects",t.U.projectId,"databases",t.U.database]).R()}function ps(t){return Lr(4<t.length&&"documents"===t.get(4)),t.u(5)}function ds(t,e,n){return{name:as(t,e),fields:n.proto.mapValue.fields}}function ys(t,e,n){var r=cs(t,e.name),t=os(e.updateTime),e=new vu({mapValue:{fields:e.fields}});return new Au(r,t,e,{hasCommittedMutations:!!n})}function vs(t,e){var n,r,i;if(e instanceof ru)n={update:ds(t,e.key,e.value)};else if(e instanceof du)n={delete:as(t,e.key)};else if(e instanceof iu)n={update:ds(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof cu)n={transform:{document:as(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ds)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof ks)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Us)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Fs)return{fieldPath:t.field.R(),increment:e.We};throw Pr()})}};else{if(!(e instanceof yu))return Pr();n={verify:as(t,e.key)}}return e.Ke.je||(n.currentDocument=void 0!==(i=e.Ke).updateTime?{updateTime:(e=t,t=i.updateTime,rs(e,t.X()))}:void 0!==i.exists?{exists:i.exists}:Pr()),n}function gs(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Hs.updateTime(os(o.updateTime)):void 0!==o.exists?Hs.exists(o.exists):Hs.Ge():Hs.Ge();if(t.update){t.update.name;var r=cs(e,t.update.name),i=new vu({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new Ws(o.map(function(t){return Br.S(t)})));return new iu(r,i,o,n)}return new ru(r,i,n)}if(t.delete){var s=cs(e,t.delete);return new du(s,n)}if(t.transform){i=cs(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Lr("REQUEST_TIME"===e.setToServerValue),r=new Ds):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new ks(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new Us(n)):"increment"in e?r=new Fs(t,e.increment):Pr();e=Br.S(e.fieldPath);return new zs(e,r)}(e,t)});return Lr(!0===n.exists),new cu(i,s)}if(t.verify){t=cs(e,t.verify);return new yu(t,n)}return Pr()}function ms(t,e){return{documents:[hs(t,e.path)]}}function ws(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=hs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=hs(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Xo(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NAN"}};if(Ho(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Xo(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NOT_NAN"}};if(Ho(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ts(t.field),op:(e=t.op,$o[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Ts((t=t).field),direction:(t=t.dir,Jo[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Ue||Ui(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Es(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Es(e.endAt)),n}function bs(t){var e=ls(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Lr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[As(t)]:void 0!==t.fieldFilter?[(n=t,Yu.create(_s(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Pr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Pr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new _a(_s((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Ui(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Is(n.startAt));var u=null;return n.endAt&&(u=Is(n.endAt)),Ou(e,i,t,o,r,"F",s,u)}function Es(t){return{before:t.before,values:t.position}}function Is(t){var e=!!t.before,t=t.values||[];return new va(t,e)}function Ts(t){return{fieldPath:t.R()}}function _s(t){return Br.S(t.fieldPath)}function As(t){switch(t.unaryFilter.op){case"IS_NAN":var e=_s(t.unaryFilter.field);return Yu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=_s(t.unaryFilter.field);return Yu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=_s(t.unaryFilter.field);return Yu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=_s(t.unaryFilter.field);return Yu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Pr()}}function Ns(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.ze=void 0};function Ss(t,e){return t instanceof Fs?Qo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var xs,Rs,Ds=(n(Ps,Rs=h),Ps),ks=(n(Os,xs=h),Os);function Os(t){var e=this;return(e=xs.call(this)||this).elements=t,e}function Ps(){return null!==Rs&&Rs.apply(this,arguments)||this}function Ls(t,e){for(var n=Gs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Mo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Cs,Us=(n(Ms,Cs=h),Ms);function Ms(t){var e=this;return(e=Cs.call(this)||this).elements=t,e}function Vs(t,e){for(var n=Gs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Mo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var js,Fs=(n(qs,js=h),qs);function qs(t,e){var n=this;return(n=js.call(this)||this).serializer=t,n.We=e,n}function Bs(t){return Go(t.integerValue||t.doubleValue)}function Gs(t){return Ko(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ws=(Qs.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Qs.prototype.isEqual=function(t){return vi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Qs),zs=function(t,e){this.field=t,this.transform=e};function Qs(t){(this.fields=t).sort(Br.i)}function Ks(t,e){this.version=t,this.transformResults=e}var Hs=(Xs.Ge=function(){return new Xs},Xs.exists=function(t){return new Xs(void 0,t)},Xs.updateTime=function(t){return new Xs(t)},Object.defineProperty(Xs.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Xs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Xs);function Xs(t,e){this.updateTime=t,this.exists=e}function Ys(t,e){return void 0!==t.updateTime?e instanceof Au&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Au}Ie=function(){};function Js(t,e,n){return t instanceof ru?new Au(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof iu?function(t,e,n){if(!Ys(t.Ke,e))return new Su(t.key,n.version);e=uu(t,e);return new Au(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof cu?function(t,e,n){if(Lr(null!=n.transformResults),!Ys(t.Ke,e))return new Su(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Lr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Au&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ks?Ls(o,s):o instanceof Us?Vs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=lu(t,r.data(),e);return new Au(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new Nu(t.key,n.version,{hasCommittedMutations:!0})}function $s(t,e,n,r){return t instanceof ru?function(t,e){if(!Ys(t.Ke,e))return e;e=tu(e);return new Au(t.key,e,t.value,{Je:!0})}(t,e):t instanceof iu?function(t,e){if(!Ys(t.Ke,e))return e;var n=tu(e),e=uu(t,e);return new Au(t.key,n,e,{Je:!0})}(t,e):t instanceof cu?function(t,e,n,r){if(!Ys(t.Ke,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof Au&&(h=n.field(a.field)),null===h&&r instanceof Au&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof Ds?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof ks?Ls(c,i):c instanceof Us?Vs(c,i):(c=Ss(h=c,i),i=Bs(c)+Bs(h.We),Qo(c)&&Qo(h.We)?ts(i):es(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=lu(t,i.data(),r);return new Au(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,Ys((t=t).Ke,e)?new Nu(t.key,Di.min()):e)}function Zs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ke.isEqual(e.Ke)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||vi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ks&&e instanceof ks||t instanceof Us&&e instanceof Us?vi(t.elements,e.elements,Mo):t instanceof Fs&&e instanceof Fs?Mo(t.We,e.We):t instanceof Ds&&e instanceof Ds)}))}function tu(t){return t instanceof Au?t.version:Di.min()}var eu,nu,ru=(n(su,nu=Ie),su),iu=(n(ou,eu=Ie),ou);function ou(t,e,n,r){var i=this;return(i=eu.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ke=r,i.type=1,i}function su(t,e,n){var r=this;return(r=nu.call(this)||this).key=t,r.value=e,r.Ke=n,r.type=0,r}function uu(t,e){return n=t,e=e instanceof Au?e.data():vu.empty(),r=new gu(e),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Ye();var n,r}var au,cu=(n(hu,au=Ie),hu);function hu(t,e){var n=this;return(n=au.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ke=Hs.exists(!0),n}function lu(t,e,n){for(var r=new gu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ye()}var fu,pu,du=(n(Eu,pu=Ie),Eu),yu=(n(bu,fu=Ie),bu),vu=(wu.empty=function(){return new wu({mapValue:{}})},wu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Yo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},wu.prototype.isEqual=function(t){return Mo(this.proto,t.proto)},wu),gu=(mu.prototype.set=function(t,e){return this.tn(t,e),this},mu.prototype.delete=function(t){return this.tn(t,null),this},mu.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Uo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},mu.prototype.Ye=function(){var t=this.en(Br.g(),this.Ze);return null!=t?new vu(t):this.Xe},mu.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Yo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},mu);function mu(t){void 0===t&&(t=vu.empty()),this.Xe=t,this.Ze=new Map}function wu(t){this.proto=t}function bu(t,e){var n=this;return(n=fu.call(this)||this).key=t,n.Ke=e,n.type=4,n}function Eu(t,e){var n=this;return(n=pu.call(this)||this).key=t,n.Ke=e,n.type=3,n}var Iu,Tu,_u,Ee=function(t,e){this.key=t,this.version=e},Au=(n(ku,_u=Ee),ku.prototype.field=function(t){return this.nn.field(t)},ku.prototype.data=function(){return this.nn},ku.prototype.sn=function(){return this.nn.proto},ku.prototype.isEqual=function(t){return t instanceof ku&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},ku.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ku.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),ku),Nu=(n(Du,Tu=Ee),Du.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Du.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Du.prototype.isEqual=function(t){return t instanceof Du&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Du),Su=(n(Ru,Iu=Ee),Ru.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ru.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Ru.prototype.isEqual=function(t){return t instanceof Ru&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ru),xu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.on=null,this.an=null,this.startAt,this.endAt};function Ru(){return null!==Iu&&Iu.apply(this,arguments)||this}function Du(t,e,n){var r=this;return(r=Tu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function ku(t,e,n,r){var i=this;return(i=_u.call(this,t,e)||this).nn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Ou(t,e,n,r,i,o,s,u){return new xu(t,e,n,r,i,o,s,u)}function Pu(t){return new xu(t)}function Lu(t){return!Ui(t.limit)&&"F"===t.limitType}function Cu(t){return!Ui(t.limit)&&"L"===t.limitType}function Uu(t){return 0<t.rn.length?t.rn[0].field:null}function Mu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function Vu(t){return null!==t.collectionGroup}function ju(t){var e=t;if(null===e.on){e.on=[];var n=Mu(e),t=Uu(e);if(null!==n&&null===t)n.p()||e.on.push(new _a(n)),e.on.push(new _a(Br.v(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.on.push(s),s.field.p()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.on.push(new _a(Br.v(),n)))}}return e.on}function Fu(t){var e=t;if(!e.an)if("F"===e.limitType)e.an=Fi(e.path,e.collectionGroup,ju(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ju(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new _a(o.field,s))}var u=e.endAt?new va(e.endAt.position,!e.endAt.before):null,t=e.startAt?new va(e.startAt.position,!e.startAt.before):null;e.an=Fi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.an}function qu(t,e,n){return new xu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Bu(t,e){return new xu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function Gu(t,e){return new xu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function Wu(t,e){return Bi(Fu(t),Fu(e))&&t.limitType===e.limitType}function zu(t){return qi(Fu(t))+"|lt:"+t.limitType}function Qu(t){return"Query(target="+(e=Fu(t),n=e.path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+qo(t.value)}).join(", ")+"]"),Ui(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ea(e.startAt)),e.endAt&&(n+=", endAt: "+Ea(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Ku(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):Gr.F(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.p()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Ia(t.startAt,ju(t),n))&&(!t.endAt||!Ia(t.endAt,ju(t),n)));var e,n}function Hu(u){return function(t,e){for(var n=!1,r=0,i=ju(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.p()?Gr.i(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?jo(n,t):Pr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Pr()}}(o,t,e);if(0!==s)return s;n=n||o.field.p()}return 0}}var Xu,Yu=(n(Ju,Xu=function(){}),Ju.create=function(t,e,n){if(t.p())return"in"===e||"not-in"===e?this.cn(t,e,n):new ea(t,e,n);if(Ho(n)){if("=="!==e&&"!="!==e)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Ju(t,e,n)}if(Xo(n)){if("=="!==e&&"!="!==e)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Ju(t,e,n)}return"array-contains"===e?new fa(t,n):"in"===e?new pa(t,n):"not-in"===e?new da(t,n):"array-contains-any"===e?new ya(t,n):new Ju(t,e,n)},Ju.cn=function(t,e,n){return new("in"===e?na:ra)(t,n)},Ju.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.hn(jo(t,this.value)):null!==t&&Uo(this.value)===Uo(t)&&this.hn(jo(t,this.value))},Ju.prototype.hn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Pr()}},Ju.prototype.un=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Ju);function Ju(t,e,n){var r=this;return(r=Xu.call(this)||this).field=t,r.op=e,r.value=n,r}var $u,Zu,ta,ea=(n(sa,ta=Yu),sa.prototype.matches=function(t){t=Gr.i(t.key,this.key);return this.hn(t)},sa),na=(n(oa,Zu=Yu),oa.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},oa),ra=(n(ia,$u=Yu),ia.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},ia);function ia(t,e){var n=this;return(n=$u.call(this,t,"not-in",e)||this).keys=ua(0,e),n}function oa(t,e){var n=this;return(n=Zu.call(this,t,"in",e)||this).keys=ua(0,e),n}function sa(t,e,n){var r=this;return(r=ta.call(this,t,e,n)||this).key=Gr.C(n.referenceValue),r}function ua(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Gr.C(t.referenceValue)})}var aa,ca,ha,la,fa=(n(ba,la=Yu),ba.prototype.matches=function(t){t=t.field(this.field);return Ko(t)&&Vo(t.arrayValue,this.value)},ba),pa=(n(wa,ha=Yu),wa.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Vo(this.value.arrayValue,t)},wa),da=(n(ma,ca=Yu),ma.prototype.matches=function(t){if(Vo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Vo(this.value.arrayValue,t)},ma),ya=(n(ga,aa=Yu),ga.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Ko(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Vo(e.value.arrayValue,t)})},ga),va=function(t,e){this.position=t,this.before=e};function ga(t,e){return aa.call(this,t,"array-contains-any",e)||this}function ma(t,e){return ca.call(this,t,"not-in",e)||this}function wa(t,e){return ha.call(this,t,"in",e)||this}function ba(t,e){return la.call(this,t,"array-contains",e)||this}function Ea(t){return(t.before?"b":"a")+":"+t.position.map(qo).join(",")}function Ia(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.p()?Gr.i(Gr.C(s.referenceValue),n.key):jo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ta(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Mo(t.position[n],e.position[n]))return!1;return!0}var _a=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Aa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Na,Sa=(Ua.prototype.reset=function(){this.mn=0},Ua.prototype.In=function(){this.mn=this.wn},Ua.prototype.An=function(t){var e=this;this.cancel();var n=Math.floor(this.mn+this.Rn()),r=Math.max(0,Date.now()-this.En),i=Math.max(0,n-r);0<i&&Rr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.mn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Tn=this.ln.Pn(this._n,i,function(){return e.En=Date.now(),t()}),this.mn*=this.dn,this.mn<this.fn&&(this.mn=this.fn),this.mn>this.wn&&(this.mn=this.wn)},Ua.prototype.yn=function(){null!==this.Tn&&(this.Tn.gn(),this.Tn=null)},Ua.prototype.cancel=function(){null!==this.Tn&&(this.Tn.cancel(),this.Tn=null)},Ua.prototype.Rn=function(){return(Math.random()-.5)*this.mn},Ua),xa=(Ca.prototype.catch=function(t){return this.next(void 0,t)},Ca.prototype.next=function(r,i){var o=this;return this.vn&&Pr(),this.vn=!0,this.bn?this.error?this.Sn(i,this.error):this.Dn(r,this.result):new Ca(function(e,n){o.Vn=function(t){o.Dn(r,t).next(e,n)},o.pn=function(t){o.Sn(i,t).next(e,n)}})},Ca.prototype.Cn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ca.prototype.Nn=function(t){try{var e=t();return e instanceof Ca?e:Ca.resolve(e)}catch(t){return Ca.reject(t)}},Ca.prototype.Dn=function(t,e){return t?this.Nn(function(){return t(e)}):Ca.resolve(e)},Ca.prototype.Sn=function(t,e){return t?this.Nn(function(){return t(e)}):Ca.reject(e)},Ca.resolve=function(n){return new Ca(function(t,e){t(n)})},Ca.reject=function(n){return new Ca(function(t,e){e(n)})},Ca.Fn=function(t){return new Ca(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ca.$n=function(t){for(var n=Ca.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Ca.resolve(t):e()})}(r[e]);return n},Ca.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Fn(i)},Ca),Ra=(La.delete=function(t){return Rr("SimpleDb","Removing database:",t),Ba(window.indexedDB.deleteDatabase(t)).Cn()},La.Mn=function(){if("undefined"==typeof indexedDB)return!1;if(La.On())return!0;var t=p(),e=La.kn(t),n=0<e&&e<10,e=La.Ln(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},La.On=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Bn)},La.qn=function(t,e){return t.store(e)},La.kn=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},La.Ln=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},La.prototype.Un=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Rr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new ka(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new _r(Tr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ka(o,t))},r.onupgradeneeded=function(t){Rr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.xn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Rr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Qn&&(this.db.onversionchange=function(t){return i.Qn(t)}),this.db)]}})})},La.prototype.Wn=function(e){this.Qn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},La.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Un(u)];case 2:return s.db=t.sent(),e=Va.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),xa.reject(t)}).Cn(),r={},n.catch(function(){}),[4,e.jn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Rr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},La.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},La),Da=(Object.defineProperty(Pa.prototype,"bn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Object.defineProperty(Pa.prototype,"Hn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(Pa.prototype,"cursor",{set:function(t){this.Kn=t},enumerable:!1,configurable:!0}),Pa.prototype.done=function(){this.Gn=!0},Pa.prototype.Jn=function(t){this.zn=t},Pa.prototype.delete=function(){return Ba(this.Kn.delete())},Pa),ka=(n(Oa,Na=_r),Oa);function Oa(t,e){var n=this;return(n=Na.call(this,Tr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Pa(t){this.Kn=t,this.Gn=!1,this.zn=null}function La(t,e,n){this.name=t,this.version=e,this.xn=n,12.2===La.kn(p())&&Dr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ca(t){var e=this;this.Vn=null,this.pn=null,this.result=void 0,this.error=void 0,this.bn=!1,this.vn=!1,t(function(t){e.bn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.bn=!0,e.error=t,e.pn&&e.pn(t)})}function Ua(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ln=t,this._n=e,this.fn=n,this.dn=r,this.wn=i,this.mn=0,this.Tn=null,this.En=Date.now(),this.reset()}function Ma(t){return"IndexedDbTransactionError"===t.name}var Va=(qa.open=function(t,e,n,r){try{return new qa(e,t.transaction(r,n))}catch(t){throw new ka(e,t)}},Object.defineProperty(qa.prototype,"jn",{get:function(){return this.Yn.promise},enumerable:!1,configurable:!0}),qa.prototype.abort=function(t){t&&this.Yn.reject(t),this.aborted||(Rr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},qa.prototype.store=function(t){t=this.transaction.objectStore(t);return new ja(t)},qa),ja=(Fa.prototype.put=function(t,e){t=void 0!==e?(Rr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Rr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Ba(t)},Fa.prototype.add=function(t){return Rr("SimpleDb","ADD",this.store.name,t,t),Ba(this.store.add(t))},Fa.prototype.get=function(e){var n=this;return Ba(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Rr("SimpleDb","GET",n.store.name,e,t),t})},Fa.prototype.delete=function(t){return Rr("SimpleDb","DELETE",this.store.name,t),Ba(this.store.delete(t))},Fa.prototype.count=function(){return Rr("SimpleDb","COUNT",this.store.name),Ba(this.store.count())},Fa.prototype.Xn=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.Zn(e,function(t,e){n.push(e)}).next(function(){return n})},Fa.prototype.ts=function(t,e){Rr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.es=!1;e=this.cursor(e);return this.Zn(e,function(t,e,n){return n.delete()})},Fa.prototype.ns=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.Zn(n,e)},Fa.prototype.ss=function(r){var t=this.cursor({});return new xa(function(n,e){t.onerror=function(t){t=Wa(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Fa.prototype.Zn=function(t,i){var o=[];return new xa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Da(n),(t=i(n.primaryKey,n.value,e))instanceof xa&&(t=t.catch(function(t){return e.done(),xa.reject(t)}),o.push(t)),e.bn?r():null===e.Hn?n.continue():n.continue(e.Hn)):r()}}).next(function(){return xa.Fn(o)})},Fa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Fa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.es?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Fa);function Fa(t){this.store=t}function qa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Yn=new Aa,this.transaction.oncomplete=function(){n.Yn.resolve()},this.transaction.onabort=function(){t.error?n.Yn.reject(new ka(e,t.error)):n.Yn.resolve()},this.transaction.onerror=function(t){t=Wa(t.target.error);n.Yn.reject(new ka(e,t))}}function Ba(t){return new xa(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Wa(t.target.error);n(t)}})}var Ga=!1;function Wa(t){var e=Ra.kn(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new _r("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ga||(Ga=!0,setTimeout(function(){throw n},0)),n}}return t}function za(){return"undefined"!=typeof window?window:null}function Qa(){return"undefined"!=typeof document?document:null}var Ka=(Ya.hs=function(t,e,n,r,i){i=new Ya(t,e,Date.now()+n,r,i);return i.start(n),i},Ya.prototype.start=function(t){var e=this;this.ls=setTimeout(function(){return e._s()},t)},Ya.prototype.gn=function(){return this._s()},Ya.prototype.cancel=function(t){null!==this.ls&&(this.clearTimeout(),this.cs.reject(new _r(Tr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ya.prototype._s=function(){var e=this;this.rs.fs(function(){return null!==e.ls?(e.clearTimeout(),e.op().then(function(t){return e.cs.resolve(t)})):Promise.resolve()})},Ya.prototype.clearTimeout=function(){null!==this.ls&&(this.us(this),clearTimeout(this.ls),this.ls=null)},Ya),Ha=(Object.defineProperty(Xa.prototype,"gs",{get:function(){return this.Ts},enumerable:!1,configurable:!0}),Xa.prototype.fs=function(t){this.enqueue(t)},Xa.prototype.Vs=function(t){this.ps(),this.bs(t)},Xa.prototype.vs=function(){var t;this.Ts||(this.Ts=!0,(t=Qa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys))},Xa.prototype.enqueue=function(t){return this.ps(),this.Ts?new Promise(function(t){}):this.bs(t)},Xa.prototype.Ss=function(t){var e=this;this.ws.push(t),this.fs(function(){return e.Ds()})},Xa.prototype.Ds=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.ws.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ws[0]()];case 2:return t.sent(),this.ws.shift(),this.Ps.reset(),[3,4];case 3:if(!Ma(e=t.sent()))throw e;return Rr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ws.length&&this.Ps.An(function(){return n.Ds()}),t.label=5;case 5:return[2]}})})},Xa.prototype.bs=function(t){var r=this,e=this.ds.then(function(){return r.As=!0,t().catch(function(t){throw r.Is=t,r.As=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.As=!1,t})});return this.ds=e},Xa.prototype.Pn=function(t,e,n){var r=this;this.ps(),-1<this.Rs.indexOf(t)&&(e=0);n=Ka.hs(this,t,e,n,function(t){return r.Cs(t)});return this.Es.push(n),n},Xa.prototype.ps=function(){this.Is&&Pr()},Xa.prototype.Ns=function(){},Xa.prototype.Fs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.ds];case 1:t.sent(),t.label=2;case 2:if(e!==this.ds)return[3,0];t.label=3;case 3:return[2]}})})},Xa.prototype.$s=function(t){for(var e=0,n=this.Es;e<n.length;e++)if(n[e]._n===t)return!0;return!1},Xa.prototype.xs=function(r){var i=this;return this.Fs().then(function(){i.Es.sort(function(t,e){return t.os-e.os});for(var t=0,e=i.Es;t<e.length;t++){var n=e[t];if(n.gn(),"all"!==r&&n._n===r)break}return i.Fs()})},Xa.prototype.ks=function(t){this.Rs.push(t)},Xa.prototype.Cs=function(t){t=this.Es.indexOf(t);this.Es.splice(t,1)},Xa);function Xa(){var e=this;this.ds=Promise.resolve(),this.ws=[],this.Ts=!1,this.Es=[],this.Is=null,this.As=!1,this.Rs=[],this.Ps=new Sa(this,"async_queue_retry"),this.ys=function(){var t=Qa();t&&Rr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Ps.yn()};var t=Qa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ys)}function Ya(t,e,n,r,i){this.rs=t,this._n=e,this.os=n,this.op=r,this.us=i,this.cs=new Aa,this.then=this.cs.promise.then.bind(this.cs.promise),this.cs.promise.catch(function(t){})}function Ja(t,e){if(Dr("AsyncQueue",e+": "+t),Ma(t))return new _r(Tr.UNAVAILABLE,e+": "+t);throw t}function $a(){this.Ms=void 0,this.listeners=[]}function Za(){this.queries=new xi(zu,Wu),this.onlineState="Unknown",this.Os=new Set}function tc(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new $a),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ls(n)];case 2:return o.Ms=t.sent(),[3,4];case 3:return o=t.sent(),o=Ja(o,"Initialization of query '"+Qu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Bs(e.onlineState),i.Ms&&u.qs(i.Ms)&&nc(e),[2]}})})}function ec(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Us(n))]:[2]})})}function nc(t){t.Os.forEach(function(t){t.next()})}var rc=(sc.prototype.qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new vo(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Ws?this.Ks(t)&&(this.Qs.next(t),o=!0):this.Gs(t,this.onlineState)&&(this.zs(t),o=!0),this.js=t,o},sc.prototype.onError=function(t){this.Qs.error(t)},sc.prototype.Bs=function(t){this.onlineState=t;var e=!1;return this.js&&!this.Ws&&this.Gs(this.js,t)&&(this.zs(this.js),e=!0),e},sc.prototype.Gs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Hs&&n||t.docs.m()&&"Offline"!==e)},sc.prototype.Ks=function(t){if(0<t.docChanges.length)return!0;var e=this.js&&this.js.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},sc.prototype.zs=function(t){t=vo.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Ws=!0,this.Qs.next(t)},sc),ic=(oc.prototype.Js=function(){return null!=this.uid},oc.prototype.Ys=function(){return this.Js()?"uid:"+this.uid:"anonymous-user"},oc.prototype.isEqual=function(t){return t.uid===this.uid},oc);function oc(t){this.uid=t}function sc(t,e,n){this.query=t,this.Qs=e,this.Ws=!1,this.js=null,this.onlineState="Unknown",this.options=n||{}}ic.UNAUTHENTICATED=new ic(null),ic.Xs=new ic("google-credentials-uid"),ic.Zs=new ic("first-party-uid");var uc=(ac.prototype.ei=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ac.prototype.next=function(){var t=++this.previousValue;return this.ni&&this.ni(t),t},ac);function ac(t,e){var n=this;this.previousValue=t,e&&(e.ti=function(t){return n.ei(t)},this.ni=function(t){return e.si(t)})}function cc(t,e){return"firestore_clients_"+t+"_"+e}function hc(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.Js()&&(n+="_"+e.uid),n}function lc(t,e){return"firestore_targets_"+t+"_"+e}uc.ii=-1;var fc=(Dc.ri=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new _r(r.error.code,r.error.message)),i?new Dc(t,e,r.state,o):(Dr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Dc.prototype.oi=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Dc),pc=(Rc.ri=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new _r(n.error.code,n.error.message)),r?new Rc(t,n.state,i):(Dr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Rc.prototype.oi=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Rc),dc=(xc.ri=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=fo,o=0;r&&o<n.activeTargetIds.length;++o)r=Vi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new xc(t,i):(Dr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},xc),yc=(Sc.ri=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Sc(e.clientId,e.onlineState):(Dr("SharedClientState","Failed to parse online state: "+t),null)},Sc),vc=(Nc.prototype.ai=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Nc.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Nc.prototype.oi=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Nc),gc=(Ac.Mn=function(t){return!(!t||!t.localStorage)},Ac.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this.hi.gi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.ci&&(i=this.getItem(cc(this.persistenceKey,r)))&&(o=dc.ri(r,i))&&(this.di=this.di.rt(o.clientId,o));for(this.Vi(),(s=this.storage.getItem(this.Pi))&&(u=this.pi(s))&&this.bi(u),a=0,c=this.mi;a<c.length;a++)h=c[a],this.fi(h);return this.mi=[],this.window.addEventListener("unload",function(){return l.vi()}),this.wi=!0,[2]}})})},Ac.prototype.si=function(t){this.setItem(this.Ei,JSON.stringify(t))},Ac.prototype.Si=function(){return this.Di(this.di)},Ac.prototype.Ci=function(n){var r=!1;return this.di.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Ac.prototype.Ni=function(t){this.Fi(t,"pending")},Ac.prototype.$i=function(t,e,n){this.Fi(t,e,n),this.xi(t)},Ac.prototype.ki=function(t){var e,n="not-current";return this.Ci(t)&&(!(e=this.storage.getItem(lc(this.persistenceKey,t)))||(e=pc.ri(t,e))&&(n=e.state)),this.Mi.ai(t),this.Vi(),n},Ac.prototype.Oi=function(t){this.Mi.ui(t),this.Vi()},Ac.prototype.Li=function(t){return this.Mi.activeTargetIds.has(t)},Ac.prototype.Bi=function(t){this.removeItem(lc(this.persistenceKey,t))},Ac.prototype.qi=function(t,e,n){this.Ui(t,e,n)},Ac.prototype.Qi=function(t,e,n){var r=this;e.forEach(function(t){r.xi(t)}),this.currentUser=t,n.forEach(function(t){r.Ni(t)})},Ac.prototype.Wi=function(t){this.ji(t)},Ac.prototype.Ki=function(){this.Gi()},Ac.prototype.vi=function(){this.wi&&(this.window.removeEventListener("storage",this._i),this.removeItem(this.Ti),this.wi=!1)},Ac.prototype.getItem=function(t){var e=this.storage.getItem(t);return Rr("SharedClientState","READ",t,e),e},Ac.prototype.setItem=function(t,e){Rr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Ac.prototype.removeItem=function(t){Rr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Ac.prototype.fi=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(Rr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.Ti)return void Dr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ln.Ss(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.wi){if(null!==o.key)if(this.Ii.test(o.key)){if(null==o.newValue)return e=this.zi(o.key),[2,this.Hi(e,null)];if(e=this.Ji(o.key,o.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.Ai.test(o.key)){if(null!==o.newValue&&(n=this.Yi(o.key,o.newValue)))return[2,this.Xi(n)]}else if(this.Ri.test(o.key)){if(null!==o.newValue&&(r=this.Zi(o.key,o.newValue)))return[2,this.tr(r)]}else if(o.key===this.Pi){if(null!==o.newValue&&(i=this.pi(o.newValue)))return[2,this.bi(i)]}else if(o.key===this.Ei)(i=function(t){var e=uc.ii;if(null!=t)try{var n=JSON.parse(t);Lr("number"==typeof n),e=n}catch(t){Dr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==uc.ii&&this.ti(i);else if(o.key===this.yi)return[2,this.hi.er()]}else this.mi.push(o);return[2]})})})}},Object.defineProperty(Ac.prototype,"Mi",{get:function(){return this.di.get(this.ci)},enumerable:!1,configurable:!0}),Ac.prototype.Vi=function(){this.setItem(this.Ti,this.Mi.oi())},Ac.prototype.Fi=function(t,e,n){n=new fc(this.currentUser,t,e,n),t=hc(this.persistenceKey,this.currentUser,t);this.setItem(t,n.oi())},Ac.prototype.xi=function(t){t=hc(this.persistenceKey,this.currentUser,t);this.removeItem(t)},Ac.prototype.ji=function(t){t={clientId:this.ci,onlineState:t};this.storage.setItem(this.Pi,JSON.stringify(t))},Ac.prototype.Ui=function(t,e,n){var r=lc(this.persistenceKey,t),n=new pc(t,e,n);this.setItem(r,n.oi())},Ac.prototype.Gi=function(){this.setItem(this.yi,"value-not-used")},Ac.prototype.zi=function(t){t=this.Ii.exec(t);return t?t[1]:null},Ac.prototype.Ji=function(t,e){t=this.zi(t);return dc.ri(t,e)},Ac.prototype.Yi=function(t,e){var n=this.Ai.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return fc.ri(new ic(n),t,e)},Ac.prototype.Zi=function(t,e){t=this.Ri.exec(t),t=Number(t[1]);return pc.ri(t,e)},Ac.prototype.pi=function(t){return yc.ri(t)},Ac.prototype.Xi=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.hi.nr(e.batchId,e.state,e.error)]:(Rr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Ac.prototype.tr=function(t){return this.hi.sr(t.targetId,t.state,t.error)},Ac.prototype.Hi=function(t,e){var n=this,r=e?this.di.rt(t,e):this.di.remove(t),i=this.Di(this.di),o=this.Di(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.hi.ir(s,u).then(function(){n.di=r})},Ac.prototype.bi=function(t){this.di.get(t.clientId)&&this.li(t.onlineState)},Ac.prototype.Di=function(t){var n=fo;return t.forEach(function(t,e){n=n.xt(e.activeTargetIds)}),n},Ac),mc=(_c.prototype.Ni=function(t){},_c.prototype.$i=function(t,e,n){},_c.prototype.ki=function(t){return this.rr.ai(t),this.ar[t]||"not-current"},_c.prototype.qi=function(t,e,n){this.ar[t]=e},_c.prototype.Oi=function(t){this.rr.ui(t)},_c.prototype.Li=function(t){return this.rr.activeTargetIds.has(t)},_c.prototype.Bi=function(t){delete this.ar[t]},_c.prototype.Si=function(){return this.rr.activeTargetIds},_c.prototype.Ci=function(t){return this.rr.activeTargetIds.has(t)},_c.prototype.start=function(){return this.rr=new vc,Promise.resolve()},_c.prototype.Qi=function(t,e,n){},_c.prototype.Wi=function(t){},_c.prototype.vi=function(){},_c.prototype.si=function(t){},_c.prototype.Ki=function(){},_c),wc=(Tc.prototype.cr=function(t,e,n){for(var r=n.hr,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Js(o,e,r[i]))}return e},Tc.prototype.lr=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=$s(i,e,e,this.ur))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=$s(a,e,o,this.ur))}return e},Tc.prototype._r=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.lr(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Tc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},lo())},Tc.prototype.isEqual=function(t){return this.batchId===t.batchId&&vi(this.mutations,t.mutations,Zs)&&vi(this.baseMutations,t.baseMutations,Zs)},Tc),bc=(Ic.from=function(t,e,n){Lr(t.mutations.length===n.length);for(var r=co,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new Ic(t,e,n,r)},Ic),h=(Ec.prototype.Er=function(t){t=this.mr.get(t);return t?t.readTime:Di.min()},Ec.prototype.Ir=function(t,e){this.Ar(),this.mr.set(t.key,{Rr:t,readTime:e})},Ec.prototype.Pr=function(t,e){void 0===e&&(e=null),this.Ar(),this.mr.set(t,{Rr:null,readTime:e})},Ec.prototype.yr=function(t,e){this.Ar();var n=this.mr.get(e);return void 0!==n?xa.resolve(n.Rr):this.gr(t,e)},Ec.prototype.getEntries=function(t,e){return this.Vr(t,e)},Ec.prototype.apply=function(t){return this.Ar(),this.Tr=!0,this.pr(t)},Ec.prototype.Ar=function(){},Ec);function Ec(){this.mr=new xi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Tr=!1}function Ic(t,e,n,r){this.batch=t,this.dr=e,this.hr=n,this.wr=r}function Tc(t,e,n,r){this.batchId=t,this.ur=e,this.baseMutations=n,this.mutations=r}function _c(){this.rr=new vc,this.ar={},this.li=null,this.ti=null}function Ac(t,e,n,r,i){this.window=t,this.ln=e,this.persistenceKey=n,this.ci=r,this.hi=null,this.li=null,this.ti=null,this._i=this.fi.bind(this),this.di=new Yi(yi),this.wi=!1,this.mi=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ti=cc(this.persistenceKey,this.ci),this.Ei="firestore_sequence_number_"+this.persistenceKey,this.di=this.di.rt(this.ci,new vc),this.Ii=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Ai=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Ri=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.Pi="firestore_online_state_"+this.persistenceKey,this.yi="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this._i)}function Nc(){this.activeTargetIds=fo}function Sc(t,e){this.clientId=t,this.onlineState=e}function xc(t,e){this.clientId=t,this.activeTargetIds=e}function Rc(t,e,n){this.targetId=t,this.state=e,this.error=n}function Dc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function kc(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{value:void 0,done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function Oc(t,e){if(t instanceof Uint8Array)return kc(t,e);if(t instanceof ArrayBuffer)return kc(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function Pc(t){return new Zo(t,!0)}var Lc=(jc.prototype.br=function(){return"metadata"in this.payload},jc),Cc=(Vc.Cr=function(t,e){return new Vc(Oc(t,10240),e)},Vc.prototype.close=function(){return this.vr.cancel()},Vc.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Vc.prototype.Nr=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Dr())]}})})},Vc.prototype.Dr=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.Fr()];case 1:return null===(e=t.sent())?[2,null]:(r=this.Sr.decode(e),n=Number(r),isNaN(n)&&this.$r("length string ("+r+") is not valid number"),[4,this.kr(n)]);case 2:return r=t.sent(),[2,new Lc(JSON.parse(r),e.length+n)]}})})},Vc.prototype.Mr=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Vc.prototype.Fr=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.Mr()<0?[4,this.Or()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Mr())<0&&this.$r("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Vc.prototype.kr=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Or()]:[3,3];case 1:t.sent()&&this.$r("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.Sr.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Vc.prototype.$r=function(t){throw this.vr.cancel(),new Error("Invalid bundle format: "+t)},Vc.prototype.Or=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.vr.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Vc),Uc=(Mc.prototype.Lr=function(t){return cs(this.serializer,t)},Mc.prototype.Br=function(t){return t.metadata.exists?ys(this.serializer,t.document,!1):new Nu(this.Lr(t.metadata.name),this.qr(t.metadata.readTime))},Mc.prototype.qr=os,Mc);function Mc(t){this.serializer=t}function Vc(t,e){var n=this;this.vr=t,this.serializer=e,this.metadata=new Aa,this.buffer=new Uint8Array,this.Sr=new TextDecoder("utf-8"),this.Dr().then(function(t){t&&t.br()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function jc(t,e){this.payload=t,this.byteLength=e}function Fc(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function qc(t,e){this.progress=t,this.Ur=e}var Bc=(Xc.prototype.jr=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Xc.prototype.Kr=function(t){for(var e=new Map,n=new Uc(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Lr(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||lo()).add(s);e.set(c,h)}}return e},Xc.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h,l;return v(this,function(t){switch(t.label){case 0:for(e=new Uc((n=f).serializer),r=lo(),i=oo,o=co,s=0,u=p;s<u.length;s++)a=u[s],c=e.Lr(a.metadata.name),a.document&&(r=r.add(c)),i=i.rt(c,e.Br(a)),o=o.rt(c,e.qr(a.metadata.readTime));return h=n.zr.Gr({Hr:!0}),[4,Fl(n,Fu(Pu(Fr.P("__bundle__/docs/"+d))))];case 1:return l=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return jl(e,h,i,Di.min(),o).next(function(t){return h.apply(e),t}).next(function(t){return n.Yr.Jr(e,l.targetId).next(function(){return n.Yr.Xr(e,r,l.targetId)}).next(function(){return n.eo.Zr(e,t)})})})]}})})}(this.Wr,this.documents,this.Qr.id)];case 1:e=t.sent(),n=this.Kr(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=lo()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Fl(e,Fu(wh(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=os(i.readTime);if(0<=n.et.L(e))return r.Au.Ba(t,i);e=n.st(mi.B,e);return r.ec=r.ec.rt(e.targetId,e),r.Yr.tu(t,e).next(function(){return r.Yr.Jr(t,n.targetId)}).next(function(){return r.Yr.Xr(t,o,n.targetId)}).next(function(){return r.Au.Ba(t,i)})})]}})})}(this.Wr,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new qc(Object.assign({},this.progress),e))]}})})},Xc),Gc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ie=(Hc.prototype.so=function(t){this.no.push(t)},Hc.prototype.io=function(){this.no.forEach(function(t){return t()})},Hc),Wc=(Kc.prototype.uo=function(e,n){var r=this;return this.oo.co(e,n).next(function(t){return r.ho(e,n,t)})},Kc.prototype.ho=function(t,r,i){return this.ro.yr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].lr(r,t);return t})},Kc.prototype.lo=function(t,e,i){var o=oo;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].lr(t,e);o=o.rt(t,e)}),o},Kc.prototype._o=function(e,t){var n=this;return this.ro.getEntries(e,t).next(function(t){return n.Zr(e,t)})},Kc.prototype.Zr=function(e,r){var i=this;return this.oo.fo(e,r).next(function(t){var t=i.lo(e,r,t),n=oo;return t.forEach(function(t,e){e=e||new Nu(t,Di.min()),n=n.rt(t,e)}),n})},Kc.prototype.wo=function(t,e,n){return r=e,Gr.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.mo(t,e.path):Vu(e)?this.To(t,e,n):this.Eo(t,e,n);var r},Kc.prototype.mo=function(t,e){return this.uo(t,new Gr(e)).next(function(t){var e=ao;return t instanceof Au&&(e=e.rt(t.key,t)),e})},Kc.prototype.To=function(n,r,i){var o=this,s=r.collectionGroup,u=ao;return this.ao.Io(n,s).next(function(t){return xa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new xu(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Eo(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},Kc.prototype.Eo=function(e,n,t){var c,h,r=this;return this.ro.wo(e,n,t).next(function(t){return c=t,r.oo.Ao(e,n)}).next(function(t){return h=t,r.Ro(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=$s(s,a,a,r.ur);c=a instanceof Au?c.rt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Ku(n,e)||(c=c.remove(t))}),c})},Kc.prototype.Ro=function(t,e,n){for(var r=lo(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof iu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ro.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Au&&(c=c.rt(t,e))}),c})},Kc),zc=(Qc.Vo=function(t,e){for(var n=lo(),r=lo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Qc(t,e.fromCache,n,r)},Qc);function Qc(t,e,n,r){this.targetId=t,this.fromCache=e,this.Po=n,this.yo=r}function Kc(t,e,n){this.ro=t,this.oo=e,this.ao=n}function Hc(){this.no=[]}function Xc(t,e,n){this.Qr=t,this.Wr=e,this.serializer=n,this.queries=[],this.documents=[],this.progress=Fc(t)}function Yc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=yi(n,t);return 0===t?yi(r,e):t}var Jc=(eh.prototype.vo=function(){return++this.bo},eh.prototype.So=function(t){var e=[t,this.vo()];this.buffer.size<this.po?this.buffer=this.buffer.add(e):Yc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(eh.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),eh),$c={Do:!1,Co:0,No:0,Fo:0},Zc=(th.Mo=function(t){return new th(t,th.Oo,th.Lo)},th);function th(t,e,n){this.$o=t,this.xo=e,this.ko=n}function eh(t){this.po=t,this.buffer=new ro(Yc),this.bo=0}Zc.Bo=-1,Zc.qo=1048576,Zc.Uo=41943040,Zc.Oo=10,Zc.Lo=1e3,Zc.Qo=new Zc(Zc.Uo,Zc.Oo,Zc.Lo),Zc.Wo=new Zc(Zc.Bo,0,0);var nh=(oh.prototype.start=function(t){this.jo.params.$o!==Zc.Bo&&this.zo(t)},oh.prototype.stop=function(){this.Go&&(this.Go.cancel(),this.Go=null)},Object.defineProperty(oh.prototype,"wi",{get:function(){return null!==this.Go},enumerable:!1,configurable:!0}),oh.prototype.zo=function(n){var t=this,e=this.Ko?3e5:6e4;Rr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Go=this.rs.Pn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Go=null,this.Ko=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Ho(this.jo)];case 2:return t.sent(),[3,7];case 3:return Ma(e=t.sent())?(Rr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ql(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.zo(n)];case 8:return t.sent(),[2]}})})})},oh),rh=(ih.prototype.Yo=function(t,e){return this.Jo.Xo(t).next(function(t){return Math.floor(e/100*t)})},ih.prototype.Zo=function(t,e){var n=this;if(0===e)return xa.resolve(uc.ii);var r=new Jc(e);return this.Jo.De(t,function(t){return r.So(t.sequenceNumber)}).next(function(){return n.Jo.ta(t,function(t){return r.So(t)})}).next(function(){return r.maxValue})},ih.prototype.ea=function(t,e,n){return this.Jo.ea(t,e,n)},ih.prototype.na=function(t,e){return this.Jo.na(t,e)},ih.prototype.sa=function(e,n){var r=this;return this.params.$o===Zc.Bo?(Rr("LruGarbageCollector","Garbage collection skipped; disabled"),xa.resolve($c)):this.ia(e).next(function(t){return t<r.params.$o?(Rr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.$o),$c):r.ra(e,n)})},ih.prototype.ia=function(t){return this.Jo.ia(t)},ih.prototype.ra=function(e,n){var r,i,o,s,u,a,c,h=this,l=Date.now();return this.Yo(e,this.params.xo).next(function(t){return i=t>h.params.ko?(Rr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.ko+" from "+t),h.params.ko):t,s=Date.now(),h.Zo(e,i)}).next(function(t){return r=t,u=Date.now(),h.ea(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.na(e,r)}).next(function(t){return c=Date.now(),xr()<=f.DEBUG&&Rr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-l)+"ms"),xa.resolve({Do:!0,Co:i,No:o,Fo:t})})},ih);function ih(t,e){this.Jo=t,this.params=e}function oh(t,e){this.jo=t,this.rs=e,this.Ko=!1,this.Go=null}function sh(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=uh(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return uh(e)}function uh(t){return t+"\x01\x01"}function ah(t){var e=t.length;if(Lr(2<=e),2===e)return Lr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Fr.g();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Pr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Pr()}o=s+2}return new Fr(r)}var ch=function(t){this.oa=t};function hh(t,e){if(e.document)return ys(t.oa,e.document,!!e.hasCommittedMutations);if(e.noDocument){var t=Gr.$(e.noDocument.path),n=yh(e.noDocument.readTime);return new Nu(t,n,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){n=Gr.$(e.unknownDocument.path),e=yh(e.unknownDocument.version);return new Su(n,e)}return Pr()}function lh(t,e,n){var r=fh(n),n=e.key.path.h().A();if(e instanceof Au){var i={name:as(i=t.oa,(o=e).key),fields:o.sn().mapValue.fields,updateTime:rs(i,o.version.X())},o=e.hasCommittedMutations;return new Yh(null,null,i,o,r,n)}if(e instanceof Nu){var i=e.key.path.A(),o=dh(e.version),s=e.hasCommittedMutations;return new Yh(null,new Hh(i,o),null,s,r,n)}if(e instanceof Su){s=e.key.path.A(),e=dh(e.version);return new Yh(new Xh(s,e),null,null,!0,r,n)}return Pr()}function fh(t){t=t.X();return[t.seconds,t.nanoseconds]}function ph(t){t=new Ri(t[0],t[1]);return Di.J(t)}function dh(t){t=t.X();return new jh(t.seconds,t.nanoseconds)}function yh(t){t=new Ri(t.seconds,t.nanoseconds);return Di.J(t)}function vh(e,t){var n=(t.baseMutations||[]).map(function(t){return gs(e.oa,t)}),r=t.mutations.map(function(t){return gs(e.oa,t)}),i=Ri.fromMillis(t.localWriteTimeMs);return new wc(t.batchId,i,n,r)}function gh(t){var e=yh(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?yh(t.lastLimboFreeSnapshotVersion):Di.min(),r=void 0!==t.query.documents?(Lr(1===(r=t.query).documents.length),Fu(Pu(ls(r.documents[0])))):Fu(bs(t.query));return new Qi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,mi.fromBase64String(t.resumeToken))}function mh(t,e){var n=dh(e.et),r=dh(e.lastLimboFreeSnapshotVersion),i=(Gi(e.target)?ms:ws)(t.oa,e.target),t=e.resumeToken.toBase64();return new $h(e.targetId,qi(e.target),n,t,e.sequenceNumber,r,i)}function wh(t){var e=bs({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?qu(e,e.limit,"L"):e}var bh=(Eh.ca=function(t,e,n,r){return Lr(""!==t.uid),new Eh(t.Js()?t.uid:"",e,n,r)},Eh.prototype.ha=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return _h(t).ns({index:zh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Eh.prototype.la=function(d,y,v,g){var m=this,w=Ah(d),b=_h(d);return b.add({}).next(function(t){Lr("number"==typeof t);for(var e,n,r,i,o,s=new wc(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return vs(e.oa,t)}),o=r.mutations.map(function(t){return vs(e.oa,t)}),new zh(n,r.batchId,r.ur.toMillis(),i,o)),a=[],c=new ro(function(t,e){return yi(t.R(),e.R())}),h=0,l=g;h<l.length;h++){var f=l[h],p=Qh.key(m.userId,f.key.path,t),c=c.add(f.key.path.h());a.push(b.put(u)),a.push(w.put(p,Qh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.ao._a(d,t))}),d.so(function(){m.ua[t]=s.keys()}),xa.Fn(a).next(function(){return s})})},Eh.prototype.fa=function(t,e){var n=this;return _h(t).get(e).next(function(t){return t?(Lr(t.userId===n.userId),vh(n.serializer,t)):null})},Eh.prototype.da=function(t,e){var n=this;return this.ua[e]?xa.resolve(this.ua[e]):this.fa(t,e).next(function(t){if(t){t=t.keys();return n.ua[e]=t}return null})},Eh.prototype.wa=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return _h(t).ns({index:zh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Lr(e.batchId>=i),o=vh(r.serializer,e)),n.done()}).next(function(){return o})},Eh.prototype.ma=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return _h(t).ns({index:zh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Eh.prototype.Ta=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return _h(t).Xn(zh.userMutationsIndex,n).next(function(t){return t.map(function(t){return vh(e.serializer,t)})})},Eh.prototype.co=function(o,s){var u=this,t=Qh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Ah(o).ns({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ah(i);if(r===u.userId&&s.path.isEqual(i))return _h(o).get(t).next(function(t){if(!t)throw Pr();Lr(t.userId===u.userId),a.push(vh(u.serializer,t))});n.done()}).next(function(){return a})},Eh.prototype.fo=function(e,t){var s=this,u=new ro(yi),n=[];return t.forEach(function(o){var t=Qh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Ah(e).ns({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ah(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),xa.Fn(n).next(function(){return s.Ea(e,u)})},Eh.prototype.Ao=function(t,e){var o=this,s=e.path,u=s.length+1,e=Qh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new ro(yi);return Ah(t).ns({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ah(i);r===o.userId&&s.T(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Ea(t,a)})},Eh.prototype.Ea=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(_h(e).get(t).next(function(t){if(null===t)throw Pr();Lr(t.userId===n.userId),r.push(vh(n.serializer,t))}))}),xa.Fn(i).next(function(){return r})},Eh.prototype.Ia=function(e,n){var r=this;return Th(e.Aa,this.userId,n).next(function(t){return e.so(function(){r.Ra(n.batchId)}),xa.forEach(t,function(t){return r.aa.Pa(e,t)})})},Eh.prototype.Ra=function(t){delete this.ua[t]},Eh.prototype.ya=function(e){var i=this;return this.ha(e).next(function(t){if(!t)return xa.resolve();var t=IDBKeyRange.lowerBound(Qh.prefixForUser(i.userId)),r=[];return Ah(e).ns({range:t},function(t,e,n){t[0]===i.userId?(t=ah(t[1]),r.push(t)):n.done()}).next(function(){Lr(0===r.length)})})},Eh.prototype.ga=function(t,e){return Ih(t,this.userId,e)},Eh.prototype.Va=function(t){var e=this;return Nh(t).get(this.userId).next(function(t){return t||new Wh(e.userId,-1,"")})},Eh);function Eh(t,e,n,r){this.userId=t,this.serializer=e,this.ao=n,this.aa=r,this.ua={}}function Ih(t,o,e){var e=Qh.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Ah(t).ns({range:e,es:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Th(t,e,n){var r=t.store(zh.store),i=t.store(Qh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.ns({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Lr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],l=Qh.key(e,h.key.path,n.batchId);o.push(i.delete(l)),u.push(h.key)}return xa.Fn(o).next(function(){return u})}function _h(t){return _l.qn(t,zh.store)}function Ah(t){return _l.qn(t,Qh.store)}function Nh(t){return _l.qn(t,Wh.store)}var Sh,xh=(kh.prototype.Ir=function(t,e,n){return Ph(t).put(Lh(e),n)},kh.prototype.Pr=function(t,e){t=Ph(t),e=Lh(e);return t.delete(e)},kh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.pa(e,t)})},kh.prototype.yr=function(t,e){var n=this;return Ph(t).get(Lh(e)).next(function(t){return n.ba(t)})},kh.prototype.va=function(t,e){var n=this;return Ph(t).get(Lh(e)).next(function(t){var e=n.ba(t);return e?{Rr:e,size:Ch(t)}:null})},kh.prototype.getEntries=function(t,e){var n=this,r=oo;return this.Sa(t,e,function(t,e){e=n.ba(e);r=r.rt(t,e)}).next(function(){return r})},kh.prototype.Da=function(t,e){var r=this,i=oo,o=new Yi(Gr.i);return this.Sa(t,e,function(t,e){var n=r.ba(e);o=n?(i=i.rt(t,n),o.rt(t,Ch(e))):(i=i.rt(t,null),o.rt(t,0))}).next(function(){return{Ca:i,Na:o}})},kh.prototype.Sa=function(t,e,i){if(e.m())return xa.resolve();var n=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),o=e.lt(),s=o.Et();return Ph(t).ns({range:n},function(t,e,n){for(var r=Gr.$(t);s&&Gr.i(s,r)<0;)i(s,null),s=o.Et();s&&s.isEqual(r)&&(i(s,e),s=o.It()?o.Et():null),s?n.Jn(s.path.A()):n.done()}).next(function(){for(;s;)i(s,null),s=o.It()?o.Et():null})},kh.prototype.wo=function(t,r,e){var n,i=this,o=ao,s=r.path.length+1,u={};return e.isEqual(Di.min())?(n=r.path.A(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.A(),e=fh(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Yh.collectionReadTimeIndex),Ph(t).ns(u,function(t,e,n){t.length===s&&(e=hh(i.serializer,e),r.path.T(e.key.path)?e instanceof Au&&Ku(r,e)&&(o=o.rt(e.key,e)):n.done())}).next(function(){return o})},kh.prototype.Gr=function(t){return new Rh(this,!!t&&t.Hr)},kh.prototype.Fa=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},kh.prototype.getMetadata=function(t){return Oh(t).get(Jh.key).next(function(t){return Lr(!!t),t})},kh.prototype.pa=function(t,e){return Oh(t).put(Jh.key,e)},kh.prototype.ba=function(t){if(t){t=hh(this.serializer,t);return t instanceof Nu&&t.version.isEqual(Di.min())?null:t}return null},kh),Rh=(n(Dh,Sh=h),Dh.prototype.pr=function(i){var o=this,s=[],u=0,a=new ro(function(t,e){return yi(t.R(),e.R())});return this.mr.forEach(function(t,e){var n,r=o.xa.get(t);e.Rr?(n=lh(o.$a.serializer,e.Rr,o.Er(t)),a=a.add(t.path.h()),e=Ch(n),u+=e-r,s.push(o.$a.Ir(i,t,n))):(u-=r,o.Hr?(r=lh(o.$a.serializer,new Nu(t,Di.min()),o.Er(t)),s.push(o.$a.Ir(i,t,r))):s.push(o.$a.Pr(i,t)))}),a.forEach(function(t){s.push(o.$a.ao._a(i,t))}),s.push(this.$a.updateMetadata(i,u)),xa.Fn(s)},Dh.prototype.gr=function(t,e){var n=this;return this.$a.va(t,e).next(function(t){return null===t?(n.xa.set(e,0),null):(n.xa.set(e,t.size),t.Rr)})},Dh.prototype.Vr=function(t,e){var n=this;return this.$a.Da(t,e).next(function(t){var e=t.Ca;return t.Na.forEach(function(t,e){n.xa.set(t,e)}),e})},Dh);function Dh(t,e){var n=this;return(n=Sh.call(this)||this).$a=t,n.Hr=e,n.xa=new xi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function kh(t,e){this.serializer=t,this.ao=e}function Oh(t){return _l.qn(t,Jh.store)}function Ph(t){return _l.qn(t,Yh.store)}function Lh(t){return t.path.A()}function Ch(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Pr();e=t.noDocument}return JSON.stringify(e).length}var Uh=(Gh.prototype._a=function(t,e){return this.ka.add(e),xa.resolve()},Gh.prototype.Io=function(t,e){return xa.resolve(this.ka.getEntries(e))},Gh),Mh=(Bh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new ro(Fr.i),t=!r.has(n);return this.index[e]=r.add(n),t},Bh.prototype.has=function(t){var e=t._(),t=t.h(),e=this.index[e];return e&&e.has(t)},Bh.prototype.getEntries=function(t){return(this.index[t]||new ro(Fr.i)).A()},Bh),Vh=(qh.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Lr(t<r&&0<=t&&r<=11);var o=new Va("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Fh.store),(s=e).createObjectStore(Wh.store,{keyPath:Wh.keyPath}),s.createObjectStore(zh.store,{keyPath:zh.keyPath,autoIncrement:!0}).createIndex(zh.userMutationsIndex,zh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Qh.store),nl(e),e.createObjectStore(Yh.store));var s,u=xa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Zh.store),s.deleteObjectStore($h.store),s.deleteObjectStore(tl.store),nl(e)),u=u.next(function(){return t=o.store(tl.store),e=new tl(0,0,Di.min().X(),0),t.put(tl.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(zh.store).Xn().next(function(t){n.deleteObjectStore(zh.store),n.createObjectStore(zh.store,{keyPath:zh.keyPath,autoIncrement:!0}).createIndex(zh.userMutationsIndex,zh.userMutationsKeyPath,{unique:!0});var e=r.store(zh.store),t=t.map(function(t){return e.put(t)});return xa.Fn(t)});var n,r})),u=u.next(function(){e.createObjectStore(rl.store,{keyPath:rl.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Jh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Yh.store)).createIndex(Yh.readTimeIndex,Yh.readTimeIndexPath,{unique:!1}),t.createIndex(Yh.collectionReadTimeIndex,Yh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(il.store,{keyPath:il.keyPath}),e.createObjectStore(ol.store,{keyPath:ol.keyPath})})),u},qh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Yh.store).ns(function(t,e){n+=Ch(e)}).next(function(){var t=new Jh(n);return e.store(Jh.store).put(Jh.key,t)})},qh.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Wh.store),i=n.store(zh.store);return t.Xn().next(function(t){return xa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.Xn(zh.userMutationsIndex,t).next(function(t){return xa.forEach(t,function(t){Lr(t.userId===e.userId);t=vh(r.serializer,t);return Th(n,e.userId,t).next(function(){})})})})})},qh.prototype.ensureSequenceNumbers=function(t){var o=t.store(Zh.store),e=t.store(Yh.store);return t.store(tl.store).get(tl.key).next(function(r){var i=[];return e.ns(function(t,e){var n=new Fr(t),t=[0,sh(n)];i.push(o.get(t).next(function(t){return t?xa.resolve():o.put(new Zh(0,sh(n),r.highestListenSequenceNumber))}))}).next(function(){return xa.Fn(i)})})},qh.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(el.store,{keyPath:el.keyPath});function r(t){if(i.add(t)){var e=t._(),t=t.h();return n.put({collectionId:e,parent:sh(t)})}}var n=e.store(el.store),i=new Mh;return e.store(Yh.store).ns({es:!0},function(t,e){t=new Fr(t);return r(t.h())}).next(function(){return e.store(Qh.store).ns({es:!0},function(t,e){t[0];var n=t[1],n=(t[2],ah(n));return r(n.h())})})},qh.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store($h.store);return r.ns(function(t,e){e=gh(e),e=mh(n.serializer,e);return r.put(e)})},qh),jh=function(t,e){this.seconds=t,this.nanoseconds=e},Fh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function qh(t){this.serializer=t}function Bh(){this.index={}}function Gh(){this.ka=new Mh}Fh.store="owner",Fh.key="owner";var Wh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Wh.store="mutationQueues",Wh.keyPath="userId";var zh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};zh.store="mutations",zh.keyPath="batchId",zh.userMutationsIndex="userMutationsIndex",zh.userMutationsKeyPath=["userId","batchId"];var Qh=(Kh.prefixForUser=function(t){return[t]},Kh.prefixForPath=function(t,e){return[t,sh(e)]},Kh.key=function(t,e,n){return[t,sh(e),n]},Kh);function Kh(){}Qh.store="documentMutations",Qh.PLACEHOLDER=new Qh;var Hh=function(t,e){this.path=t,this.readTime=e},Xh=function(t,e){this.path=t,this.version=e},Yh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Yh.store="remoteDocuments",Yh.readTimeIndex="readTimeIndex",Yh.readTimeIndexPath="readTime",Yh.collectionReadTimeIndex="collectionReadTimeIndex",Yh.collectionReadTimeIndexPath=["parentPath","readTime"];var Jh=function(t){this.byteSize=t};Jh.store="remoteDocumentGlobal",Jh.key="remoteDocumentGlobalKey";var $h=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};$h.store="targets",$h.keyPath="targetId",$h.queryTargetsIndexName="queryTargetsIndex",$h.queryTargetsKeyPath=["canonicalId","targetId"];var Zh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Zh.store="targetDocuments",Zh.keyPath=["targetId","path"],Zh.documentTargetsIndex="documentTargetsIndex",Zh.documentTargetsKeyPath=["path","targetId"];var tl=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};tl.key="targetGlobalKey",tl.store="targetGlobal";var el=function(t,e){this.collectionId=t,this.parent=e};function nl(t){t.createObjectStore(Zh.store,{keyPath:Zh.keyPath}).createIndex(Zh.documentTargetsIndex,Zh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore($h.store,{keyPath:$h.keyPath}).createIndex($h.queryTargetsIndexName,$h.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(tl.store)}el.store="collectionParents",el.keyPath=["collectionId","parent"];var rl=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};rl.store="clientMetadata",rl.keyPath="clientId";var il=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};il.store="bundles",il.keyPath="bundleId";var ol=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ol.store="namedQueries",ol.keyPath="name";var sl=i(i(i(i([Wh.store,zh.store,Qh.store,Yh.store,$h.store,Fh.store,tl.store,Zh.store],[rl.store]),[Jh.store]),[el.store]),[il.store,ol.store]),ul=(al.prototype.Ma=function(t,e){return cl(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:yh(t.createTime),version:t.version}})},al.prototype.Oa=function(t,e){return cl(t).put({bundleId:(e=e).id,createTime:dh(os(e.createTime)),version:e.version})},al.prototype.La=function(t,e){return hl(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:wh(t.bundledQuery),readTime:yh(t.readTime)}})},al.prototype.Ba=function(t,e){return hl(t).put({name:(e=e).name,readTime:dh(os(e.readTime)),bundledQuery:e.bundledQuery})},al);function al(t){this.serializer=t}function cl(t){return _l.qn(t,il.store)}function hl(t){return _l.qn(t,ol.store)}var ll=(fl.prototype._a=function(t,e){var n=this;if(this.qa.has(e))return xa.resolve();var r=e._(),i=e.h();t.so(function(){n.qa.add(e)});i={collectionId:r,parent:sh(i)};return pl(t).put(i)},fl.prototype.Io=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[gi(i),""],!1,!0);return pl(t).Xn(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(ah(r.parent))}return o})},fl);function fl(){this.qa=new Mh}function pl(t){return _l.qn(t,el.store)}var dl=(gl.prototype.next=function(){return this.Ua+=2,this.Ua},gl.Qa=function(){return new gl(0)},gl.Wa=function(){return new gl(-1)},gl),yl=(vl.prototype.ja=function(n){var r=this;return this.Ka(n).next(function(t){var e=new dl(t.highestTargetId);return t.highestTargetId=e.next(),r.Ga(n,t).next(function(){return t.highestTargetId})})},vl.prototype.za=function(t){return this.Ka(t).next(function(t){return Di.J(new Ri(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},vl.prototype.Ha=function(t){return this.Ka(t).next(function(t){return t.highestListenSequenceNumber})},vl.prototype.Ja=function(e,n,r){var i=this;return this.Ka(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.X()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ga(e,t)})},vl.prototype.Ya=function(e,n){var r=this;return this.Xa(e,n).next(function(){return r.Ka(e).next(function(t){return t.targetCount+=1,r.Za(n,t),r.Ga(e,t)})})},vl.prototype.tu=function(t,e){return this.Xa(t,e)},vl.prototype.eu=function(e,t){var n=this;return this.Jr(e,t.targetId).next(function(){return ml(e).delete(t.targetId)}).next(function(){return n.Ka(e)}).next(function(t){return Lr(0<t.targetCount),--t.targetCount,n.Ga(e,t)})},vl.prototype.ea=function(n,r,i){var o=this,s=0,u=[];return ml(n).ns(function(t,e){e=gh(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.eu(n,e)))}).next(function(){return xa.Fn(u)}).next(function(){return s})},vl.prototype.De=function(t,n){return ml(t).ns(function(t,e){e=gh(e);n(e)})},vl.prototype.Ka=function(t){return wl(t).get(tl.key).next(function(t){return Lr(null!==t),t})},vl.prototype.Ga=function(t,e){return wl(t).put(tl.key,e)},vl.prototype.Xa=function(t,e){return ml(t).put(mh(this.serializer,e))},vl.prototype.Za=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},vl.prototype.nu=function(t){return this.Ka(t).next(function(t){return t.targetCount})},vl.prototype.su=function(t,r){var e=qi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return ml(t).ns({range:e,index:$h.queryTargetsIndexName},function(t,e,n){e=gh(e);Bi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},vl.prototype.Xr=function(n,t,r){var i=this,o=[],s=bl(n);return t.forEach(function(t){var e=sh(t.path);o.push(s.put(new Zh(r,e))),o.push(i.aa.iu(n,r,t))}),xa.Fn(o)},vl.prototype.ru=function(n,t,r){var i=this,o=bl(n);return xa.forEach(t,function(t){var e=sh(t.path);return xa.Fn([o.delete([r,e]),i.aa.ou(n,r,t)])})},vl.prototype.Jr=function(t,e){t=bl(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},vl.prototype.au=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=bl(t),r=lo();return t.ns({range:e,es:!0},function(t,e,n){t=ah(t[1]),t=new Gr(t);r=r.add(t)}).next(function(){return r})},vl.prototype.ga=function(t,e){var e=sh(e.path),e=IDBKeyRange.bound([e],[gi(e)],!1,!0),i=0;return bl(t).ns({index:Zh.documentTargetsIndex,es:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},vl.prototype.qe=function(t,e){return ml(t).get(e).next(function(t){return t?gh(t):null})},vl);function vl(t,e){this.aa=t,this.serializer=e}function gl(t){this.Ua=t}function ml(t){return _l.qn(t,$h.store)}function wl(t){return _l.qn(t,tl.store)}function bl(t){return _l.qn(t,Zh.store)}var El,Il="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Tl=(n(Nl,El=Ie),Nl),_l=(Al.qn=function(t,e){if(t instanceof Tl)return Ra.qn(t.Aa,e);throw Pr()},Al.prototype.start=function(){var e=this;return this.Pu().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new _r(Tr.FAILED_PRECONDITION,Il);return e.yu(),e.gu(),e.Vu(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Yr.Ha(t)})}).then(function(t){e.lu=new uc(t,e.cu)}).then(function(){e._u=!0}).catch(function(t){return e.Iu&&e.Iu.close(),Promise.reject(t)})},Al.prototype.pu=function(n){var t=this;return this.Tu=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.wi?[2,n(e)]:[2]})})},n(this.isPrimary)},Al.prototype.bu=function(n){var t=this;this.Iu.Wn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Al.prototype.vu=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.ln.fs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.wi?[4,this.Pu()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Al.prototype.Pu=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return xl(e).put(new rl(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Su(e).next(function(t){t||(n.isPrimary=!1,n.ln.Ss(function(){return n.Tu(!1)}))})}).next(function(){return n.Du(e)}).next(function(t){return n.isPrimary&&!t?n.Cu(e).next(function(){return!1}):!!t&&n.Nu(e).next(function(){return!0})})}).catch(function(t){if(Ma(t))return Rr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Rr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.ln.Ss(function(){return n.Tu(t)}),n.isPrimary=t})},Al.prototype.Su=function(t){var e=this;return Sl(t).get(Fh.key).next(function(t){return xa.resolve(e.Fu(t))})},Al.prototype.$u=function(t){return xl(t).delete(this.clientId)},Al.prototype.xu=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ku(this.mu,18e5)?[3,2]:(this.mu=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Al.qn(t,rl.store);return r.Xn().next(function(t){var e=o.Mu(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return xa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ru)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ru.removeItem(this.Ou(i.clientId));t.label=2;case 2:return[2]}})})},Al.prototype.Vu=function(){var t=this;this.wu=this.ln.Pn("client_metadata_refresh",4e3,function(){return t.Pu().then(function(){return t.xu()}).then(function(){return t.Vu()})})},Al.prototype.Fu=function(t){return!!t&&t.ownerId===this.clientId},Al.prototype.Du=function(e){var r=this;return this.hu?xa.resolve(!0):Sl(e).get(Fh.key).next(function(t){if(null!==t&&r.ku(t.leaseTimestampMs,5e3)&&!r.Lu(t.ownerId)){if(r.Fu(t)&&r.networkEnabled)return!0;if(!r.Fu(t)){if(!t.allowTabSynchronization)throw new _r(Tr.FAILED_PRECONDITION,Il);return!1}}return!(!r.networkEnabled||!r.inForeground)||xl(e).Xn().next(function(t){return void 0===r.Mu(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Rr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Al.prototype.vi=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this._u=!1,this.Bu(),this.wu&&(this.wu.cancel(),this.wu=null),this.qu(),this.Uu(),[4,this.Iu.runTransaction("shutdown","readwrite",[Fh.store,rl.store],function(t){var e=new Tl(t,uc.ii);return n.Cu(e).next(function(){return n.$u(e)})})];case 1:return t.sent(),this.Iu.close(),this.Qu(),[2]}})})},Al.prototype.Mu=function(t,e){var n=this;return t.filter(function(t){return n.ku(t.updateTimeMs,e)&&!n.Lu(t.clientId)})},Al.prototype.gi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return xl(t).Xn().next(function(t){return e.Mu(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Al.prototype,"wi",{get:function(){return this._u},enumerable:!1,configurable:!0}),Al.prototype.Wu=function(t){return bh.ca(t,this.serializer,this.ao,this.aa)},Al.prototype.ju=function(){return this.Yr},Al.prototype.Ku=function(){return this.ro},Al.prototype.Gu=function(){return this.ao},Al.prototype.zu=function(){return this.Au},Al.prototype.runTransaction=function(e,n,r){var i=this;Rr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Iu.runTransaction(e,t,sl,function(t){return o=new Tl(t,i.lu?i.lu.next():uc.ii),"readwrite-primary"===n?i.Su(o).next(function(t){return!!t||i.Du(o)}).next(function(t){if(!t)throw Dr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.ln.Ss(function(){return i.Tu(!1)}),new _r(Tr.FAILED_PRECONDITION,Gc);return r(o)}).next(function(t){return i.Nu(o).next(function(){return t})}):i.Hu(o).next(function(){return r(o)})}).then(function(t){return o.io(),t})},Al.prototype.Hu=function(t){var e=this;return Sl(t).get(Fh.key).next(function(t){if(null!==t&&e.ku(t.leaseTimestampMs,5e3)&&!e.Lu(t.ownerId)&&!e.Fu(t)&&!(e.hu||e.allowTabSynchronization&&t.allowTabSynchronization))throw new _r(Tr.FAILED_PRECONDITION,Il)})},Al.prototype.Nu=function(t){var e=new Fh(this.clientId,this.allowTabSynchronization,Date.now());return Sl(t).put(Fh.key,e)},Al.Mn=function(){return Ra.Mn()},Al.prototype.Cu=function(t){var e=this,n=Sl(t);return n.get(Fh.key).next(function(t){return e.Fu(t)?(Rr("IndexedDbPersistence","Releasing primary lease."),n.delete(Fh.key)):xa.resolve()})},Al.prototype.ku=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Dr("Detected an update time that is in the future: "+t+" > "+n),1))},Al.prototype.yu=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.du=function(){t.ln.fs(function(){return t.inForeground="visible"===t.document.visibilityState,t.Pu()})},this.document.addEventListener("visibilitychange",this.du),this.inForeground="visible"===this.document.visibilityState)},Al.prototype.qu=function(){this.du&&(this.document.removeEventListener("visibilitychange",this.du),this.du=null)},Al.prototype.gu=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.fu=function(){e.Bu(),e.ln.fs(function(){return e.vi()})},this.window.addEventListener("unload",this.fu))},Al.prototype.Uu=function(){this.fu&&(this.window.removeEventListener("unload",this.fu),this.fu=null)},Al.prototype.Lu=function(t){try{var e=null!==(null===(e=this.Ru)||void 0===e?void 0:e.getItem(this.Ou(t)));return Rr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Dr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Al.prototype.Bu=function(){if(this.Ru)try{this.Ru.setItem(this.Ou(this.clientId),String(Date.now()))}catch(t){Dr("Failed to set zombie client id.",t)}},Al.prototype.Qu=function(){if(this.Ru)try{this.Ru.removeItem(this.Ou(this.clientId))}catch(t){}},Al.prototype.Ou=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Al);function Al(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.ln=i,this.window=o,this.document=s,this.cu=a,this.hu=c,this.lu=null,this._u=!1,this.isPrimary=!1,this.networkEnabled=!0,this.fu=null,this.inForeground=!1,this.du=null,this.wu=null,this.mu=Number.NEGATIVE_INFINITY,this.Tu=function(t){return Promise.resolve()},!Al.Mn())throw new _r(Tr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.aa=new Rl(this,r),this.Eu=e+"main",this.serializer=new ch(u),this.Iu=new Ra(this.Eu,11,new Vh(this.serializer)),this.Yr=new yl(this.aa,this.serializer),this.ao=new ll,this.ro=(e=this.serializer,u=this.ao,new xh(e,u)),this.Au=new ul(this.serializer),this.window&&this.window.localStorage?this.Ru=this.window.localStorage:(this.Ru=null,!1===c&&Dr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Nl(t,e){var n=this;return(n=El.call(this)||this).Aa=t,n.uu=e,n}function Sl(t){return _l.qn(t,Fh.store)}function xl(t){return _l.qn(t,rl.store)}var Rl=(Dl.prototype.Xo=function(t){var n=this.Ju(t);return this.db.ju().nu(t).next(function(e){return n.next(function(t){return e+t})})},Dl.prototype.Ju=function(t){var e=0;return this.ta(t,function(t){e++}).next(function(){return e})},Dl.prototype.De=function(t,e){return this.db.ju().De(t,e)},Dl.prototype.ta=function(t,n){return this.Yu(t,function(t,e){return n(e)})},Dl.prototype.iu=function(t,e,n){return kl(t,n)},Dl.prototype.ou=function(t,e,n){return kl(t,n)},Dl.prototype.ea=function(t,e,n){return this.db.ju().ea(t,e,n)},Dl.prototype.Pa=kl,Dl.prototype.Xu=function(t,e){return r=e,i=!1,Nh(n=t).ss(function(t){return Ih(n,t,r).next(function(t){return t&&(i=!0),xa.resolve(!t)})}).next(function(){return i});var n,r,i},Dl.prototype.na=function(n,r){var i=this,o=this.db.Ku().Gr(),s=[],u=0;return this.Yu(n,function(e,t){t<=r&&(t=i.Xu(n,e).next(function(t){if(!t)return u++,o.yr(n,e).next(function(){return o.Pr(e),bl(n).delete([0,sh(e.path)])})}),s.push(t))}).next(function(){return xa.Fn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Dl.prototype.removeTarget=function(t,e){e=e.nt(t.uu);return this.db.ju().tu(t,e)},Dl.prototype.Zu=kl,Dl.prototype.Yu=function(t,r){var i,t=bl(t),o=uc.ii;return t.ns({index:Zh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==uc.ii&&r(new Gr(ah(i)),o),o=e,i=t):o=uc.ii}).next(function(){o!==uc.ii&&r(new Gr(ah(i)),o)})},Dl.prototype.ia=function(t){return this.db.Ku().Fa(t)},Dl);function Dl(t,e){this.db=t,this.jo=new rh(this,e)}function kl(t,e){return bl(t).put((t=t.uu,new Zh(0,sh(e.path),t)))}function Ol(t,e){var n=t.projectId;return t.W||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Pl=(Ll.prototype.Ho=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.sa(t,n.ec)})},Ll);function Ll(t,e,n,r){this.persistence=t,this.tc=e,this.serializer=r,this.ec=new Yi(yi),this.nc=new xi(qi,Bi),this.sc=Di.min(),this.oo=t.Wu(n),this.zr=t.Ku(),this.Yr=t.ju(),this.eo=new Wc(this.zr,this.oo,this.persistence.Gu()),this.Au=t.zu(),this.tc.ic(this.eo)}function Cl(t,e,n,r){return new Pl(t,e,n,r)}function Ul(t,h){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=l.zr.Gr({Hr:!0});return e=l,r=t,o=c,s=(i=h).batch,n=s.keys(),u=xa.resolve(),n.forEach(function(n){u=u.next(function(){return o.yr(r,n)}).next(function(t){var e=t,t=i.wr.get(n);Lr(null!==t),(!e||e.version.L(t)<0)&&(e=s.cr(n,e,i))&&o.Ir(e,i.dr)})}),u.next(function(){return e.oo.Ia(r,s)}).next(function(){return c.apply(t)}).next(function(){return l.oo.ya(t)}).next(function(){return l.eo._o(t,a)})})}function Ml(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Yr.za(t)})}function Vl(t,r){var a=t,c=r.et,h=a.ec;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.zr.Gr({Hr:!0});h=a.ec;var u=[];r.Gt.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.Yr.ru(s,t.ne,e).next(function(){return a.Yr.Xr(s,t.te,e)})),0<(i=t.resumeToken).O()&&(n=o.st(i,c).nt(s.uu),h=h.rt(e,n),r=o,i=t,Lr(0<(o=n).resumeToken.O()),(0===r.resumeToken.O()||3e8<=o.et.Y()-r.et.Y()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(a.Yr.tu(s,n))))});var e,n=oo;return r.Ht.forEach(function(t,e){r.Jt.has(t)&&u.push(a.persistence.aa.Zu(s,t))}),u.push(jl(s,t,r.Ht,c,void 0).next(function(t){n=t})),c.isEqual(Di.min())||(e=a.Yr.za(s).next(function(t){return a.Yr.Ja(s,s.uu,c)}),u.push(e)),xa.Fn(u).next(function(){return t.apply(s)}).next(function(){return a.eo.Zr(s,n)})}).then(function(t){return a.ec=h,t})}function jl(t,s,e,u,a){var n=lo();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=oo;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof Nu&&e.version.isEqual(Di.min())?(s.Pr(t,r),o=o.rt(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(s.Ir(e,r),o=o.rt(t,e)):Rr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Fl(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Yr.su(e,r).next(function(t){return t?(n=t,xa.resolve(n)):i.Yr.ja(e).next(function(t){return n=new Qi(r,t,0,e.uu),i.Yr.Ya(e,n).next(function(){return n})})})}).then(function(t){var e=i.ec.get(t.targetId);return(null===e||0<t.et.L(e.et))&&(i.ec=i.ec.rt(t.targetId,t),i.nc.set(r,t.targetId)),t})}function ql(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).ec.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.aa.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ma(r=t.sent()))throw r;return Rr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.ec=e.ec.remove(o),e.nc.delete(n.target),[2]}})})}function Bl(t,o,s){var u=t,a=Di.min(),c=lo();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Fu(o),(void 0!==(t=(i=t).nc.get(r))?xa.resolve(i.ec.get(t)):i.Yr.su(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Yr.au(e,t.targetId).next(function(t){c=t})}).next(function(){return u.tc.wo(e,o,s?a:Di.min(),s?c:lo())}).next(function(t){return{documents:t,rc:c}});var t,n,r,i})}function Gl(t,e){var n=t,r=n.Yr,t=n.ec.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function Wl(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.zr,n=t,t=s.sc,r=e,i=oo,o=fh(t),t=Ph(n),n=IDBKeyRange.lowerBound(o,!0),t.ns({index:Yh.readTimeIndex,range:n},function(t,e){var n=hh(r.serializer,e);i=i.rt(n.key,n),o=e.readTime}).next(function(){return{Ur:i,readTime:ph(o)}});var e,n,r,i,o}).then(function(t){var e=t.Ur,t=t.readTime;return s.sc=t,e})}function zl(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Ph(t),r=Di.min(),t.ns({index:Yh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=ph(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.sc=t})]})})}function Ql(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Tr.FAILED_PRECONDITION||e.message!==Gc)throw e;return Rr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Kl(t,e){this.user=e,this.type="OAuth",this.Tc={},this.Tc.Authorization="Bearer "+t}function Hl(t,e,n,r,i){var o=this;this.Wr=t,this.Eh=e,this.rs=n,this.Ih={},this.Ah=[],this.Rh=new Map,this.Ph=new Set,this.yh=[],this.gh=i,this.gh.Vh(function(t){n.fs(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Rf(this)?(Rr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ph.add(4),[4,Ef(e)];case 1:return t.sent(),e.ph.set("Unknown"),e.Ph.delete(4),[4,bf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.ph=new af(n,r)}var Xl,Yl,Jl,$l=(wf.prototype.m=function(){return this.oc.m()},wf.prototype.iu=function(t,e){e=new Zl(t,e);this.oc=this.oc.add(e),this.uc=this.uc.add(e)},wf.prototype.hc=function(t,e){var n=this;t.forEach(function(t){return n.iu(t,e)})},wf.prototype.ou=function(t,e){this.lc(new Zl(t,e))},wf.prototype._c=function(t,e){var n=this;t.forEach(function(t){return n.ou(t,e)})},wf.prototype.fc=function(t){var e=this,n=new Gr(new Fr([])),r=new Zl(n,t),t=new Zl(n,t+1),i=[];return this.uc.Nt([r,t],function(t){e.lc(t),i.push(t.key)}),i},wf.prototype.dc=function(){var e=this;this.oc.forEach(function(t){return e.lc(t)})},wf.prototype.lc=function(t){this.oc=this.oc.delete(t),this.uc=this.uc.delete(t)},wf.prototype.wc=function(t){var e=new Gr(new Fr([])),n=new Zl(e,t),t=new Zl(e,t+1),r=lo();return this.uc.Nt([n,t],function(t){r=r.add(t.key)}),r},wf.prototype.ga=function(t){var e=new Zl(t,0),e=this.oc.$t(e);return null!==e&&t.isEqual(e.key)},wf),Zl=(mf.ac=function(t,e){return Gr.i(t.key,e.key)||yi(t.mc,e.mc)},mf.cc=function(t,e){return yi(t.mc,e.mc)||Gr.i(t.key,e.key)},mf),tf=(gf.prototype.getToken=function(){return Promise.resolve(null)},gf.prototype.Ic=function(){},gf.prototype.Ac=function(t){(this.Ec=t)(ic.UNAUTHENTICATED)},gf.prototype.Rc=function(){this.Ec=null},gf),ef=(vf.prototype.getToken=function(){var e=this,n=this.gc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.gc!==n?(Rr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Lr("string"==typeof t.accessToken),new Kl(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},vf.prototype.Ic=function(){this.forceRefresh=!0},vf.prototype.Ac=function(t){this.Ec=t,this.yc&&t(this.currentUser)},vf.prototype.Rc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Pc),this.Pc=null,this.Ec=null},vf.prototype.Vc=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new ic(t)},vf),nf=(Object.defineProperty(yf.prototype,"Tc",{get:function(){var t={"X-Goog-AuthUser":this.vc},e=this.bc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),yf),rf=(df.prototype.getToken=function(){return Promise.resolve(new nf(this.bc,this.vc))},df.prototype.Ac=function(t){t(ic.Zs)},df.prototype.Rc=function(){},df.prototype.Ic=function(){},df),Ee=(pf.prototype.$c=function(){return 1===this.state||2===this.state||4===this.state},pf.prototype.xc=function(){return 2===this.state},pf.prototype.start=function(){3!==this.state?this.auth():this.kc()},pf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.$c()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},pf.prototype.Mc=function(){this.state=0,this.Ps.reset()},pf.prototype.Oc=function(){var t=this;this.xc()&&null===this.Fc&&(this.Fc=this.ln.Pn(this.Sc,6e4,function(){return t.Lc()}))},pf.prototype.Bc=function(t){this.qc(),this.stream.send(t)},pf.prototype.Lc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.xc()?[2,this.close(0)]:[2]})})},pf.prototype.qc=function(){this.Fc&&(this.Fc.cancel(),this.Fc=null)},pf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.qc(),this.Ps.cancel(),this.Nc++,3!==e?this.Ps.reset():n&&n.code===Tr.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Ps.In()):n&&n.code===Tr.UNAUTHENTICATED&&this.Cc.Ic(),null!==this.stream&&(this.Uc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Qc(n)];case 1:return t.sent(),[2]}})})},pf.prototype.Uc=function(){},pf.prototype.auth=function(){var n=this;this.state=1;var t=this.Wc(this.Nc),e=this.Nc;this.Cc.getToken().then(function(t){n.Nc===e&&n.jc(t)},function(e){t(function(){var t=new _r(Tr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Kc(t)})})},pf.prototype.jc=function(t){var e=this,n=this.Wc(this.Nc);this.stream=this.Gc(t),this.stream.zc(function(){n(function(){return e.state=2,e.listener.zc()})}),this.stream.Qc(function(t){n(function(){return e.Kc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},pf.prototype.kc=function(){var t=this;this.state=4,this.Ps.An(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},pf.prototype.Kc=function(t){return Rr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},pf.prototype.Wc=function(e){var n=this;return function(t){n.ln.fs(function(){return n.Nc===e?t():(Rr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},pf),of=(n(ff,Jl=Ee),ff.prototype.Gc=function(t){return this.Dc.Hc("Listen",t)},ff.prototype.onMessage=function(t){this.Ps.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Pr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ue?(Lr(void 0===o||"string"==typeof o),mi.fromBase64String(o||"")):(Lr(void 0===o||o instanceof Uint8Array),mi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Tr.UNKNOWN:Xi(s.code),new _r(o,s.message||"")),r=new Eo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=cs(t,u.document.name),a=os(u.document.updateTime),s=new vu({mapValue:{fields:u.document.fields}}),a=new Au(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new wo(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=cs(t,u.document),c=u.readTime?os(u.readTime):Di.min(),c=new Nu(a,c),u=u.removedTargetIds||[];r=new wo([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=cs(t,c.document),c=c.removedTargetIds||[];r=new wo([],c,h,null)}else{if(!("filter"in e))return Pr();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new Wi(e),h=h.targetId;r=new bo(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return Di.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?os(t.readTime):Di.min()}(t);return this.listener.Jc(e,t)},ff.prototype.Yc=function(t){var e,n,r,i={};i.database=fs(this.serializer),i.addTarget=(e=this.serializer,(r=Gi(r=(n=t).target)?{documents:ms(e,r)}:{query:ws(e,r)}).targetId=n.targetId,0<n.resumeToken.O()?r.resumeToken=is(e,n.resumeToken):0<n.et.L(Di.min())&&(r.readTime=rs(e,n.et.X())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.Bc(i)},ff.prototype.Xc=function(t){var e={};e.database=fs(this.serializer),e.removeTarget=t,this.Bc(e)},ff),sf=(n(lf,Yl=Ee),Object.defineProperty(lf.prototype,"th",{get:function(){return this.Zc},enumerable:!1,configurable:!0}),lf.prototype.start=function(){this.Zc=!1,this.lastStreamToken=void 0,Yl.prototype.start.call(this)},lf.prototype.Uc=function(){this.Zc&&this.eh([])},lf.prototype.Gc=function(t){return this.Dc.Hc("Write",t)},lf.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Zc){this.Ps.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Lr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?os(t.updateTime):os(e);n.isEqual(Di.min())&&(n=os(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Ks(n,e)}(t,r)})):[]),n=os(t.commitTime);return this.listener.nh(n,e)}var n,r;return Lr(!t.writeResults||0===t.writeResults.length),this.Zc=!0,this.listener.sh()},lf.prototype.ih=function(){var t={};t.database=fs(this.serializer),this.Bc(t)},lf.prototype.eh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return vs(e.serializer,t)})};this.Bc(t)},lf),uf=(n(hf,Xl=function(){}),hf.prototype.oh=function(){if(this.rh)throw new _r(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},hf.prototype.ah=function(e,n,r){var i=this;return this.oh(),this.credentials.getToken().then(function(t){return i.Dc.ah(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.Ic(),t})},hf.prototype.uh=function(e,n,r){var i=this;return this.oh(),this.credentials.getToken().then(function(t){return i.Dc.uh(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.Ic(),t})},hf.prototype.terminate=function(){this.rh=!1},hf),af=(cf.prototype.fh=function(){var t=this;0===this.hh&&(this.dh("Unknown"),this.lh=this.rs.Pn("online_state_timeout",1e4,function(){return t.lh=null,t.wh("Backend didn't respond within 10 seconds."),t.dh("Offline"),Promise.resolve()}))},cf.prototype.mh=function(t){"Online"===this.state?this.dh("Unknown"):(this.hh++,1<=this.hh&&(this.Th(),this.wh("Connection failed 1 times. Most recent error: "+t.toString()),this.dh("Offline")))},cf.prototype.set=function(t){this.Th(),this.hh=0,"Online"===t&&(this._h=!1),this.dh(t)},cf.prototype.dh=function(t){t!==this.state&&(this.state=t,this.li(t))},cf.prototype.wh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this._h?(Dr(t),this._h=!1):Rr("OnlineStateTracker",t)},cf.prototype.Th=function(){null!==this.lh&&(this.lh.cancel(),this.lh=null)},cf);function cf(t,e){this.rs=t,this.li=e,this.state="Unknown",this.hh=0,this.lh=null,this._h=!0}function hf(t,e,n){var r=this;return(r=Xl.call(this)||this).credentials=t,r.Dc=e,r.serializer=n,r.rh=!1,r}function lf(t,e,n,r,i){var o=this;return(o=Yl.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Zc=!1,o}function ff(t,e,n,r,i){var o=this;return(o=Jl.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function pf(t,e,n,r,i,o){this.ln=t,this.Sc=n,this.Dc=r,this.Cc=i,this.listener=o,this.state=0,this.Nc=0,this.Fc=null,this.stream=null,this.Ps=new Sa(t,e)}function df(t,e){this.bc=t,this.vc=e}function yf(t,e){this.bc=t,this.vc=e,this.type="FirstParty",this.user=ic.Zs}function vf(t){var e=this;this.Pc=null,this.currentUser=ic.UNAUTHENTICATED,this.yc=!1,this.gc=0,this.Ec=null,this.forceRefresh=!1,this.Pc=function(){e.gc++,e.currentUser=e.Vc(),e.yc=!0,e.Ec&&e.Ec(e.currentUser)},this.gc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Pc):(this.Pc(null),t.get().then(function(t){e.auth=t,e.Pc&&e.auth.addAuthTokenListener(e.Pc)},function(){}))}function gf(){this.Ec=null}function mf(t,e){this.key=t,this.mc=e}function wf(){this.oc=new ro(Zl.ac),this.uc=new ro(Zl.cc)}function bf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Rf(r))return[3,4];e=0,n=r.yh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ef(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.yh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function If(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Rr("RemoteStore","RemoteStore shutting down."),e.Ph.add(5),[4,Ef(e)];case 1:return t.sent(),e.gh.vi(),e.ph.set("Unknown"),[2]}})})}function Tf(t,e){t.Rh.has(e.targetId)||(t.Rh.set(e.targetId,e),xf(t)?Sf(t):Vf(t).xc()&&Af(t,e))}function _f(t,e){var n=t,t=Vf(n);n.Rh.delete(e),t.xc()&&Nf(n,e),0===n.Rh.size&&(t.xc()?t.Oc():Rf(n)&&n.ph.set("Unknown"))}function Af(t,e){t.bh.Ee(e.targetId),Vf(t).Yc(e)}function Nf(t,e){t.bh.Ee(e),Vf(t).Xc(e)}function Sf(e){e.bh=new To({Be:function(t){return e.Ih.Be(t)},qe:function(t){return e.Rh.get(t)||null}}),Vf(e).start(),e.ph.fh()}function xf(t){return Rf(t)&&!Vf(t).$c()&&0<t.Rh.size}function Rf(t){return 0===t.Ph.size}function Df(t){t.bh=void 0}function kf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.ph.set("Online"),!(u instanceof Eo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Rh.has(i)?[4,o.Ih.Sh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Rh.delete(i),o.bh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Rr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Of(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof wo?s.bh.pe(u):u instanceof bo?s.bh.$e(u):s.bh.Se(u),a.isEqual(Di.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ml(s.Wr)];case 8:return o=t.sent(),0<=a.L(o)?[4,(i=a,(e=(r=s).bh.Me(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.O()&&((n=r.Rh.get(e))&&r.Rh.set(e,n.st(t.resumeToken,i)))}),e.zt.forEach(function(t){var e=r.Rh.get(t);e&&(r.Rh.set(t,e.st(mi.B,e.et)),Nf(r,t),e=new Qi(e.target,t,1,e.sequenceNumber),Af(r,e))}),r.Ih.Dh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Rr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Of(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Of(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ma(r))throw r;return n.Ph.add(1),[4,Ef(n)];case 1:return t.sent(),n.ph.set("Offline"),i=i||function(){return Ml(n.Wr)},n.rs.Ss(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Rr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Ph.delete(1),[4,bf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Pf(e,n){return n().catch(function(t){return Of(e,t,n)})}function Lf(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=jf(i=a),s=0<i.Ah.length?i.Ah[i.Ah.length-1].batchId:-1,t.label=1;case 1:if(!(Rf(i)&&i.Ah.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Wr,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.oo.wa(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Ah.length&&o.Oc(),[3,7]):(s=u.batchId,function(t,e){t.Ah.push(e);t=jf(t);t.xc()&&t.th&&t.eh(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Of(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Cf(i)&&Uf(i),[2]}var e,n,r})})}function Cf(t){return Rf(t)&&!jf(t).$c()&&0<t.Ah.length}function Uf(t){jf(t).start()}function Mf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Ph.delete(2),[4,bf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Ph.add(2),[4,Ef(e)]);case 3:t.sent(),e.ph.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Vf(n){var t,e,r,i=this;return n.Fh||(n.Fh=(t=n.Eh,e=n.rs,r={zc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Rh.forEach(function(t,e){Af(n,t)}),[2]})})}.bind(null,n),Qc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Df(e),xf(e)?(e.ph.mh(n),Sf(e)):e.ph.set("Unknown"),[2]})})}.bind(null,n),Jc:kf.bind(null,n)},t.oh(),new of(e,t.Dc,t.credentials,t.serializer,r)),n.yh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Fh.Mc(),xf(n)?Sf(n):n.ph.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Fh.stop()];case 2:t.sent(),Df(n),t.label=3;case 3:return[2]}})})})),n.Fh}function jf(n){var t,e,r,i=this;return n.$h||(n.$h=(t=n.Eh,e=n.rs,r={zc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return jf(e).ih(),[2]})})}.bind(null,n),Qc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&jf(e).th?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Hi(n=i.code)&&n!==Tr.ABORTED?(e=r.Ah.shift(),jf(r).Mc(),[4,Pf(r,function(){return r.Ih.Nh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Lf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Cf(e)&&Uf(e),[2]}})})}.bind(null,n),sh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=jf(o),n=0,r=o.Ah;n<r.length;n++)i=r[n],e.eh(i.mutations);return[2]})})}.bind(null,n),nh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Ah.shift(),n=bc.from(e,i,o),[4,Pf(r,function(){return r.Ih.Ch(n)})];case 1:return t.sent(),[4,Lf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.oh(),new sf(e,t.Dc,t.credentials,t.serializer,r)),n.yh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.$h.Mc(),[4,Lf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.$h.stop()];case 3:t.sent(),0<n.Ah.length&&(Rr("RemoteStore","Stopping write stream with "+n.Ah.length+" pending writes"),n.Ah=[]),t.label=4;case 4:return[2]}})})})),n.$h}var Ff=function(t){this.key=t},qf=function(t){this.key=t},Bf=(Object.defineProperty(Kf.prototype,"Bh",{get:function(){return this.xh},enumerable:!1,configurable:!0}),Kf.prototype.qh=function(t,e){var s=this,u=e?e.Uh:new yo,a=(e||this).Lh,c=(e||this).Qt,h=a,l=!1,f=Lu(this.query)&&a.size===this.query.limit?a.last():null,p=Cu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ct(function(t,e){var n=a.get(t),r=(r=e instanceof Au?e:null)&&(Ku(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Je||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Qh(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.Oh(r,f)||p&&s.Oh(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Lu(this.query)||Cu(this.query))for(;h.size>this.query.limit;){var n=Lu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Lh:h,Uh:u,Wh:l,Qt:c}},Kf.prototype.Qh=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},Kf.prototype.pr=function(t,e,n){var o=this,r=this.Lh;this.Lh=t.Lh,this.Qt=t.Qt;var i=t.Uh.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Oh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pr()}}var r,i}),this.jh(n);var s=e?this.Kh():[],n=0===this.Mh.size&&this.Zt?1:0,e=n!==this.kh;return this.kh=n,0!==i.length||e?{snapshot:new vo(this.query,t.Lh,r,i,t.Qt,0==n,e,!1),Gh:s}:{Gh:s}},Kf.prototype.Bs=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.pr({Lh:this.Lh,Uh:new yo,Qt:this.Qt,Wh:!1},!1)):{Gh:[]}},Kf.prototype.zh=function(t){return!this.xh.has(t)&&!!this.Lh.has(t)&&!this.Lh.get(t).Je},Kf.prototype.jh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.xh=e.xh.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.xh=e.xh.delete(t)}),this.Zt=t.Zt)},Kf.prototype.Kh=function(){var e=this;if(!this.Zt)return[];var n=this.Mh;this.Mh=lo(),this.Lh.forEach(function(t){e.zh(t.key)&&(e.Mh=e.Mh.add(t.key))});var r=[];return n.forEach(function(t){e.Mh.has(t)||r.push(new qf(t))}),this.Mh.forEach(function(t){n.has(t)||r.push(new Ff(t))}),r},Kf.prototype.Hh=function(t){this.xh=t.rc,this.Mh=lo();t=this.qh(t.documents);return this.pr(t,!0)},Kf.prototype.Jh=function(){return vo.Kt(this.query,this.Lh,this.Qt,0===this.kh)},Kf),Gf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Wf=function(t){this.key=t,this.Yh=!1},zf=(Object.defineProperty(Qf.prototype,"fl",{get:function(){return!0===this._l},enumerable:!1,configurable:!0}),Qf);function Qf(t,e,n,r,i,o){this.Wr=t,this.Xh=e,this.Zh=n,this.tl=r,this.currentUser=i,this.el=o,this.nl={},this.sl=new xi(zu,Wu),this.il=new Map,this.rl=[],this.ol=new Yi(Gr.i),this.al=new Map,this.ul=new $l,this.cl={},this.hl=new Map,this.ll=dl.Wa(),this.onlineState="Unknown",this._l=void 0}function Kf(t,e){this.query=t,this.xh=e,this.kh=null,this.Zt=!1,this.Mh=lo(),this.Qt=lo(),this.Oh=Hu(t),this.Lh=new po(this.Oh)}function Hf(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.dl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.qh(o)).Wh?[4,Bl(r.Wr,i.query,!1).then(function(t){t=t.documents;return i.view.qh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Gt.get(i.targetId),n=i.view.pr(e,r.fl,n),[2,(np(r,i.targetId,n.Gh),n.snapshot)]}})})}(i,t,e,n)},[4,Bl(i.Wr,o,!0)];case 1:return n=t.sent(),r=new Bf(o,n.rc),e=r.qh(n.documents),n=mo.Xt(s,u&&"Offline"!==i.onlineState),n=r.pr(e,i.fl,n),np(i,s,n.Gh),r=new Gf(o,s,r),[2,(i.sl.set(o,r),i.il.has(s)?i.il.get(s).push(o):i.il.set(s,[o]),n.snapshot)]}})})}function Xf(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Vl(n.Wr,i)];case 2:return e=t.sent(),i.Gt.forEach(function(t,e){e=n.al.get(e);e&&(Lr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.Yh=!0:0<t.ee.size?Lr(e.Yh):0<t.ne.size&&(Lr(e.Yh),e.Yh=!1))}),[4,ip(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Ql(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Yf(t,n,e){var r,t=t;(t.fl&&0===e||!t.fl&&1===e)&&(r=[],t.sl.forEach(function(t,e){e=e.view.Bs(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Bs(i)&&(o=!0)}),o&&nc(t)}(t.Zh,n),r.length&&t.nl.Jc(r),t.onlineState=n,t.fl&&t.tl.Wi(n))}function Jf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Wr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.oo.fa(e,r).next(function(t){return Lr(null!==t),n=t.keys(),i.oo.Ia(e,t)}).next(function(){return i.oo.ya(e)}).next(function(){return i.eo._o(e,n)})}))];case 2:return o=t.sent(),Zf(n,u,a),$f(n,u),n.tl.$i(u,"rejected",a),[4,ip(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Ql(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function $f(t,e){(t.hl.get(e)||[]).forEach(function(t){t.resolve()}),t.hl.delete(e)}function Zf(t,e,n){var r=t,i=r.cl[r.currentUser.Ys()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.cl[r.currentUser.Ys()]=i)}function tp(e,t,n){void 0===n&&(n=null),e.tl.Oi(t);for(var r=0,i=e.il.get(t);r<i.length;r++){var o=i[r];e.sl.delete(o),n&&e.nl.wl(o,n)}e.il.delete(t),e.fl&&e.ul.fc(t).forEach(function(t){e.ul.ga(t)||ep(e,t)})}function ep(t,e){var n=t.ol.get(e);null!==n&&(_f(t.Xh,n),t.ol=t.ol.remove(e),t.al.delete(n),rp(t))}function np(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Ff?(t.ul.iu(o.key,e),function(t,e){e=e.key;t.ol.get(e)||(Rr("SyncEngine","New document in limbo: "+e),t.rl.push(e),rp(t))}(t,o)):o instanceof qf?(Rr("SyncEngine","Document no longer in limbo: "+o.key),t.ul.ou(o.key,e),t.ul.ga(o.key)||ep(t,o.key)):Pr()}}function rp(t){for(;0<t.rl.length&&t.ol.size<t.el;){var e=t.rl.shift(),n=t.ll.next();t.al.set(n,new Wf(e)),t.ol=t.ol.rt(e,n),Tf(t.Xh,new Qi(Fu(Pu(e.path)),n,2,uc.ii))}}function ip(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).sl.m()?[3,3]:(n.sl.forEach(function(t,e){o.push(n.dl(e,s,u).then(function(t){t&&(n.fl&&n.tl.qi(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=zc.Vo(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.nl.Jc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return xa.forEach(c,function(e){return xa.forEach(e.Po,function(t){return r.persistence.aa.iu(n,e.targetId,t)}).next(function(){return xa.forEach(e.yo,function(t){return r.persistence.aa.ou(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ma(e=t.sent()))throw e;return Rr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.ec.get(o),u=s.et,u=s.it(u),r.ec=r.ec.rt(o,u));return[2]}})})}(n.Wr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function op(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Rr("SyncEngine","User change. New user:",o.Ys()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).oo,m=e.eo,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.oo.Ta(v).next(function(t){return g=t,n=e.persistence.Wu(o),m=new Wc(e.zr,n,e.persistence.Gu()),n.Ta(v)}).next(function(t){for(var e=[],n=[],r=lo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m._o(v,r).next(function(t){return{ml:t,Tl:e,El:n}})})})];case 1:return r=t.sent(),[2,(e.oo=n,e.eo=m,e.tc.ic(e.eo),r)]}})})}(n.Wr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).hl.forEach(function(t){t.forEach(function(t){t.reject(new _r(Tr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.hl.clear(),n.tl.Qi(o,r.Tl,r.El),[4,ip(n,r.ml)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function sp(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Wr,n=a,i=(r=e).oo,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.da(e,n).next(function(t){return t?r.eo._o(e,t):xa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Lf(o.Xh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(Zf(o,a,h||null),$f(o,a),o.Wr.oo.Ra(a)):Pr(),t.label=4;case 4:return[4,ip(o,s)];case 5:return t.sent(),[3,7];case 6:Rr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function up(h,l){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return hp(r=h),lp(r),!0!==l||!0===r._l?[3,3]:(e=r.tl.Si(),[4,ap(r,e.A())]);case 1:return i=t.sent(),r._l=!0,[4,Mf(r.Xh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Tf(r.Xh,u);return[3,7];case 3:return!1!==l||!1===r._l?[3,7]:(a=[],c=Promise.resolve(),r.il.forEach(function(t,e){r.tl.Li(e)?a.push(e):c=c.then(function(){return tp(r,e),ql(r.Wr,e,!0)}),_f(r.Xh,e)}),[4,c]);case 4:return t.sent(),[4,ap(r,a)];case 5:return t.sent(),(n=r).al.forEach(function(t,e){_f(n.Xh,e)}),n.ul.dc(),n.al=new Map,n.ol=new Yi(Gr.i),r._l=!1,[4,Mf(r.Xh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function ap(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l,f;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.il.get(s))&&0!==a.length?[4,Fl(e.Wr,Fu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(l=h[c],l=e.sl.get(l),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Bl((e=r).Wr,i.query,!0)];case 1:return n=t.sent(),n=i.view.Hh(n),[2,(e.fl&&np(e,i.targetId,n.Gh),n)]}})})}(e,l)]):[3,6];case 4:(l=t.sent()).snapshot&&r.push(l.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Gl(e.Wr,s)];case 8:return f=t.sent(),[4,Fl(e.Wr,f)];case 9:return u=t.sent(),[4,Hf(e,cp(f),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.nl.Jc(r),n)]}})})}function cp(t){return Ou(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function hp(t){return t.Xh.Ih.Dh=Xf.bind(null,t),t.Xh.Ih.Be=function(t,e){var n=t;if((t=n.al.get(e))&&t.Yh)return lo().add(t.key);var r=lo();if(!(e=n.il.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.sl.get(s),r=r.xt(s.view.Bh);return r}.bind(null,t),t.Xh.Ih.Sh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).tl.qi(s,"rejected",u),i=e.al.get(s),(n=i&&i.key)?(r=(r=new Yi(Gr.i)).rt(n,new Nu(n,Di.min())),i=lo().add(n),i=new go(Di.min(),new Map,new ro(yi),r,i),[4,Xf(e,i)]):[3,2];case 1:return t.sent(),e.ol=e.ol.remove(n),e.al.delete(s),rp(e),[3,4];case 2:return[4,ql(e.Wr,s,!1).then(function(){return tp(e,s,u)}).catch(Ql)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.nl.Jc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].qs(s)&&(r=!0);u.Ms=s}}r&&nc(n)}.bind(null,t.Zh),t.nl.wl=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Zh),t}function lp(t){return t.Xh.Ih.Ch=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ul(e.Wr,o)];case 2:return r=t.sent(),Zf(e,n,null),$f(e,n),e.tl.$i(n,"acknowledged"),[4,ip(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Ql(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.Xh.Ih.Nh=Jf.bind(null,t),t}function fp(t,e,n){var r=t;(function(f,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,l;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=f.Wr,i=u,s=new Uc((o=r).serializer).qr(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Au.Ma(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.L(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Il({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Al(Fc(u)),a=new Bc(u,f.Wr,p.serializer),[4,p.Nr()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.jr(c)]:[3,10];case 7:return(h=t.sent())&&d.Al(h),[4,p.Nr()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return l=t.sent(),[4,ip(f,l.Ur,void 0)];case 12:return t.sent(),[4,(r=f.Wr,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Au.Oa(t,e)}))];case 13:return t.sent(),d.Il(l.progress),[3,15];case 14:return l=t.sent(),d.Rl(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.tl.Ki()})}var pp,dp,yp,vp,gp,mp,wp,bp=(hd.prototype.ic=function(t){this.Pl=t},hd.prototype.wo=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.p())||i.isEqual(Di.min())?this.yl(e,r):this.Pl._o(e,o).next(function(t){var n=s.gl(r,t);return(Lu(r)||Cu(r))&&s.Wh(r.limitType,n,o,i)?s.yl(e,r):(xr()<=f.DEBUG&&Rr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Qu(r)),s.Pl.wo(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},hd.prototype.gl=function(n,t){var r=new ro(Hu(n));return t.forEach(function(t,e){e instanceof Au&&Ku(n,e)&&(r=r.add(e))}),r},hd.prototype.Wh=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.L(r))},hd.prototype.yl=function(t,e){return xr()<=f.DEBUG&&Rr("IndexFreeQueryEngine","Using full collection scan to execute query:",Qu(e)),this.Pl.wo(t,e,Di.min())},hd),Ep=(cd.prototype.ha=function(t){return xa.resolve(0===this.oo.length)},cd.prototype.la=function(t,e,n,r){var i=this.Vl;this.Vl++,0<this.oo.length&&this.oo[this.oo.length-1];n=new wc(i,e,n,r);this.oo.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.pl=this.pl.add(new Zl(u.key,i)),this.ao._a(t,u.key.path.h())}return xa.resolve(n)},cd.prototype.fa=function(t,e){return xa.resolve(this.bl(e))},cd.prototype.wa=function(t,e){e+=1,e=this.vl(e),e=e<0?0:e;return xa.resolve(this.oo.length>e?this.oo[e]:null)},cd.prototype.ma=function(){return xa.resolve(0===this.oo.length?-1:this.Vl-1)},cd.prototype.Ta=function(t){return xa.resolve(this.oo.slice())},cd.prototype.co=function(t,e){var n=this,r=new Zl(e,0),e=new Zl(e,Number.POSITIVE_INFINITY),i=[];return this.pl.Nt([r,e],function(t){t=n.bl(t.mc);i.push(t)}),xa.resolve(i)},cd.prototype.fo=function(t,e){var n=this,r=new ro(yi);return e.forEach(function(t){var e=new Zl(t,0),t=new Zl(t,Number.POSITIVE_INFINITY);n.pl.Nt([e,t],function(t){r=r.add(t.mc)})}),xa.resolve(this.Sl(r))},cd.prototype.Ao=function(t,e){var n=e.path,r=n.length+1,e=n;Gr.F(e)||(e=e.child(""));var e=new Zl(new Gr(e),0),i=new ro(yi);return this.pl.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.mc)),!0)},e),xa.resolve(this.Sl(i))},cd.prototype.Sl=function(t){var e=this,n=[];return t.forEach(function(t){t=e.bl(t);null!==t&&n.push(t)}),n},cd.prototype.Ia=function(n,r){var i=this;Lr(0===this.Dl(r.batchId,"removed")),this.oo.shift();var o=this.pl;return xa.forEach(r.mutations,function(t){var e=new Zl(t.key,r.batchId);return o=o.delete(e),i.aa.Pa(n,t.key)}).next(function(){i.pl=o})},cd.prototype.Ra=function(t){},cd.prototype.ga=function(t,e){var n=new Zl(e,0),n=this.pl.$t(n);return xa.resolve(e.isEqual(n&&n.key))},cd.prototype.ya=function(t){return this.oo.length,xa.resolve()},cd.prototype.Dl=function(t,e){return this.vl(t)},cd.prototype.vl=function(t){return 0===this.oo.length?0:t-this.oo[0].batchId},cd.prototype.bl=function(t){t=this.vl(t);return t<0||t>=this.oo.length?null:this.oo[t]},cd),Ip=(ad.prototype.Ir=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Cl(e);return this.docs=this.docs.rt(r,{Rr:e,size:i,readTime:n}),this.size+=i-o,this.ao._a(t,r.path.h())},ad.prototype.Pr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},ad.prototype.yr=function(t,e){e=this.docs.get(e);return xa.resolve(e?e.Rr:null)},ad.prototype.getEntries=function(t,e){var n=this,r=oo;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.Rr:null)}),xa.resolve(r)},ad.prototype.wo=function(t,e,n){for(var r=ao,i=new Gr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),u=s.key,a=s.value,s=a.Rr,a=a.readTime;if(!e.path.T(u.path))break;a.L(n)<=0||s instanceof Au&&Ku(e,s)&&(r=r.rt(s.key,s))}return xa.resolve(r)},ad.prototype.Nl=function(t,e){return xa.forEach(this.docs,function(t){return e(t)})},ad.prototype.Gr=function(t){return new Tp(this)},ad.prototype.Fa=function(t){return xa.resolve(this.size)},ad),Tp=(n(ud,wp=h),ud.prototype.pr=function(n){var r=this,i=[];return this.mr.forEach(function(t,e){e&&e.Rr?i.push(r.$a.Ir(n,e.Rr,r.Er(t))):r.$a.Pr(t)}),xa.Fn(i)},ud.prototype.gr=function(t,e){return this.$a.yr(t,e)},ud.prototype.Vr=function(t,e){return this.$a.getEntries(t,e)},ud),_p=(sd.prototype.De=function(t,n){return this.Fl.forEach(function(t,e){return n(e)}),xa.resolve()},sd.prototype.za=function(t){return xa.resolve(this.lastRemoteSnapshotVersion)},sd.prototype.Ha=function(t){return xa.resolve(this.$l)},sd.prototype.ja=function(t){return this.highestTargetId=this.kl.next(),xa.resolve(this.highestTargetId)},sd.prototype.Ja=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.$l&&(this.$l=e),xa.resolve()},sd.prototype.Xa=function(t){this.Fl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.kl=new dl(e),this.highestTargetId=e),t.sequenceNumber>this.$l&&(this.$l=t.sequenceNumber)},sd.prototype.Ya=function(t,e){return this.Xa(e),this.targetCount+=1,xa.resolve()},sd.prototype.tu=function(t,e){return this.Xa(e),xa.resolve()},sd.prototype.eu=function(t,e){return this.Fl.delete(e.target),this.xl.fc(e.targetId),--this.targetCount,xa.resolve()},sd.prototype.ea=function(n,r,i){var o=this,s=0,u=[];return this.Fl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Fl.delete(t),u.push(o.Jr(n,e.targetId)),s++)}),xa.Fn(u).next(function(){return s})},sd.prototype.nu=function(t){return xa.resolve(this.targetCount)},sd.prototype.su=function(t,e){e=this.Fl.get(e)||null;return xa.resolve(e)},sd.prototype.Xr=function(t,e,n){return this.xl.hc(e,n),xa.resolve()},sd.prototype.ru=function(e,t,n){this.xl._c(t,n);var r=this.persistence.aa,i=[];return r&&t.forEach(function(t){i.push(r.Pa(e,t))}),xa.Fn(i)},sd.prototype.Jr=function(t,e){return this.xl.fc(e),xa.resolve()},sd.prototype.au=function(t,e){e=this.xl.wc(e);return xa.resolve(e)},sd.prototype.ga=function(t,e){return xa.resolve(this.xl.ga(e))},sd),Ap=(od.prototype.Ma=function(t,e){return xa.resolve(this.Ml.get(e))},od.prototype.Oa=function(t,e){return this.Ml.set(e.id,{id:e.id,version:e.version,createTime:os(e.createTime)}),xa.resolve()},od.prototype.La=function(t,e){return xa.resolve(this.Ol.get(e))},od.prototype.Ba=function(t,e){return this.Ol.set(e.name,{name:(e=e).name,query:wh(e.bundledQuery),readTime:os(e.readTime)}),xa.resolve()},od),Np=(id.prototype.start=function(){return Promise.resolve()},id.prototype.vi=function(){return this._u=!1,Promise.resolve()},Object.defineProperty(id.prototype,"wi",{get:function(){return this._u},enumerable:!1,configurable:!0}),id.prototype.bu=function(){},id.prototype.vu=function(){},id.prototype.Gu=function(){return this.ao},id.prototype.Wu=function(t){var e=this.Ll[t.Ys()];return e||(e=new Ep(this.ao,this.aa),this.Ll[t.Ys()]=e),e},id.prototype.ju=function(){return this.Yr},id.prototype.Ku=function(){return this.ro},id.prototype.zu=function(){return this.Au},id.prototype.runTransaction=function(t,e,n){var r=this;Rr("MemoryPersistence","Starting transaction:",t);var i=new Sp(this.lu.next());return this.aa.ql(),n(i).next(function(t){return r.aa.Ul(i).next(function(){return t})}).Cn().then(function(t){return i.io(),t})},id.prototype.Ql=function(e,n){return xa.$n(Object.values(this.Ll).map(function(t){return function(){return t.ga(e,n)}}))},id),Sp=(n(rd,mp=Ie),rd),xp=(nd.Kl=function(t){return new nd(t)},Object.defineProperty(nd.prototype,"Gl",{get:function(){if(this.jl)return this.jl;throw Pr()},enumerable:!1,configurable:!0}),nd.prototype.iu=function(t,e,n){return this.Wl.iu(n,e),this.Gl.delete(n.toString()),xa.resolve()},nd.prototype.ou=function(t,e,n){return this.Wl.ou(n,e),this.Gl.add(n.toString()),xa.resolve()},nd.prototype.Pa=function(t,e){return this.Gl.add(e.toString()),xa.resolve()},nd.prototype.removeTarget=function(t,e){var n=this;this.Wl.fc(e.targetId).forEach(function(t){return n.Gl.add(t.toString())});var r=this.persistence.ju();return r.au(t,e.targetId).next(function(t){t.forEach(function(t){return n.Gl.add(t.toString())})}).next(function(){return r.eu(t,e)})},nd.prototype.ql=function(){this.jl=new Set},nd.prototype.Ul=function(n){var r=this,i=this.persistence.Ku().Gr();return xa.forEach(this.Gl,function(t){var e=Gr.D(t);return r.zl(n,e).next(function(t){t||i.Pr(e)})}).next(function(){return r.jl=null,i.apply(n)})},nd.prototype.Zu=function(t,e){var n=this;return this.zl(t,e).next(function(t){t?n.Gl.delete(e.toString()):n.Gl.add(e.toString())})},nd.prototype.Bl=function(t){return 0},nd.prototype.zl=function(t,e){var n=this;return xa.$n([function(){return xa.resolve(n.Wl.ga(e))},function(){return n.persistence.ju().ga(t,e)},function(){return n.persistence.Ql(t,e)}])},nd),Rp=(ed.prototype.zc=function(t){this.Yl=t},ed.prototype.Qc=function(t){this.Xl=t},ed.prototype.onMessage=function(t){this.Zl=t},ed.prototype.close=function(){this.Jl()},ed.prototype.send=function(t){this.Hl(t)},ed.prototype.t_=function(){this.Yl()},ed.prototype.e_=function(t){this.Xl(t)},ed.prototype.n_=function(t){this.Zl(t)},ed),Dp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},kp=(td.prototype.ah=function(e,t,n,r){var i=this.o_(e,t);Rr("RestConnection","Sending: ",i,n);t={};return this.a_(t,r),this.u_(e,i,t,n).then(function(t){return Rr("RestConnection","Received: ",t),t},function(t){throw kr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},td.prototype.uh=function(t,e,n,r){return this.ah(t,e,n,r)},td.prototype.a_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.22.1-alpha.96ae6a5fe",t["Content-Type"]="text/plain",e)for(var n in e.Tc)e.Tc.hasOwnProperty(n)&&(t[n]=e.Tc[n])},td.prototype.o_=function(t,e){t=Dp[t];return this.i_+"/v1/"+e+":"+t},n(Zp,gp=td),Zp.prototype.u_=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();Rr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:Rr("Connection",'RPC "'+o+'" timed out'),r(new _r(Tr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();Rr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Tr).indexOf(e)?e:Tr.UNKNOWN,r(new _r(e,t.message))):r(new _r(Tr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new _r(Tr.UNAVAILABLE,"Connection failed."));break;default:Pr()}}finally{Rr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Zp.prototype.Hc=function(t,e){var n,r=[this.i_,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=yr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.a_(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Rr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Rp({Hl:function(t){u?Rr("Connection","Not sending because WebChannel is closed:",t):(s||(Rr("Connection","Opening WebChannel transport."),o.open(),s=!0),Rr("Connection","WebChannel sending:",t),o.send(t))},Jl:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Rr("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Rr("Connection","WebChannel transport closed"),a.e_())}),t(mr.EventType.ERROR,function(t){u||(u=!0,kr("Connection","WebChannel transport errored:",t),a.e_(new _r(Tr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Lr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Rr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=zi[r];if(void 0!==t)return Xi(t)}(),i=n.message,void 0===t&&(t=Tr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.e_(new _r(t,i)),o.close()):(Rr("Connection","WebChannel received:",e),a.n_(e)))}),setTimeout(function(){a.t_()},0),a},Zp),Op=($p.prototype.Vh=function(t){this.f_.push(t)},$p.prototype.vi=function(){window.removeEventListener("online",this.c_),window.removeEventListener("offline",this.l_)},$p.prototype.d_=function(){window.addEventListener("online",this.c_),window.addEventListener("offline",this.l_)},$p.prototype.h_=function(){Rr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.f_;t<e.length;t++)(0,e[t])(0)},$p.prototype.__=function(){Rr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.f_;t<e.length;t++)(0,e[t])(1)},$p.Mn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},$p),Pp=(Jp.prototype.Vh=function(t){},Jp.prototype.vi=function(){},Jp),Lp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Cp=(Yp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Pc(e.s_.U),this.tl=this.w_(e),this.persistence=this.m_(e),[4,this.persistence.start()];case 1:return t.sent(),this.T_=this.E_(e),this.Wr=this.I_(e),[2]}})})},Yp.prototype.E_=function(t){return null},Yp.prototype.I_=function(t){return Cl(this.persistence,new bp,t.A_,this.serializer)},Yp.prototype.m_=function(t){if(t.persistenceSettings.R_)throw new _r(Tr.FAILED_PRECONDITION,Lp);return new Np(xp.Kl,this.serializer)},Yp.prototype.w_=function(t){return new mc},Yp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.T_&&this.T_.stop(),[4,this.tl.vi()];case 1:return t.sent(),[4,this.persistence.vi()];case 2:return t.sent(),[2]}})})},Yp.prototype.clearPersistence=function(t,e){throw new _r(Tr.FAILED_PRECONDITION,Lp)},Yp),Up=(n(Xp,vp=Cp),Xp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,vp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,zl(this.Wr)];case 2:return t.sent(),[4,this.P_.initialize(this,e)];case 3:return t.sent(),[4,lp(this.P_.hi)];case 4:return t.sent(),[4,Lf(this.P_.Xh)];case 5:return t.sent(),[2]}})})},Xp.prototype.I_=function(t){return Cl(this.persistence,new bp,t.A_,this.serializer)},Xp.prototype.E_=function(t){var e=this.persistence.aa.jo;return new nh(e,t.rs)},Xp.prototype.m_=function(t){var e=Ol(t.s_.U,t.s_.persistenceKey);return new _l(t.persistenceSettings.synchronizeTabs,e,t.clientId,Zc.Mo(t.persistenceSettings.cacheSizeBytes),t.rs,za(),Qa(),this.serializer,this.tl,t.persistenceSettings.hu)},Xp.prototype.w_=function(t){return new mc},Xp.prototype.clearPersistence=function(t,e){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Ra.Mn()?(e=n+"main",[4,Ra.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Ol(t,e))},n(Hp,yp=Xp),Hp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,yp.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.P_.hi,this.tl instanceof gc?(this.tl.hi={nr:sp.bind(null,e),sr:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i)._l?(Rr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.il.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Wl(e.Wr)];case 3:return n=t.sent(),r=go.Yt(o,"current"===s),[4,ip(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,ql(e.Wr,o,!0)];case 6:return t.sent(),tp(e,o,u),[3,8];case 7:Pr(),t.label=8;case 8:return[2]}})})}.bind(null,e),ir:function(c,h,l){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=hp(c))._l)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.il.has(r)?(Rr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Gl(n.Wr,r)]):[3,6];case 2:return i=t.sent(),[4,Fl(n.Wr,i)];case 3:return o=t.sent(),[4,Hf(n,cp(i),o.targetId,!1)];case 4:t.sent(),Tf(n.Xh,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.il.has(e)?[4,ql(n.Wr,e,!1).then(function(){_f(n.Xh,e),tp(n,e)}).catch(Ql)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=l,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),gi:function(t){return t.Wr.persistence.gi()}.bind(null,e),er:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Wl((e=n).Wr).then(function(t){return ip(e,t)})]})})}.bind(null,e)},[4,this.tl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.pu(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,up(this.P_.hi,e)];case 1:return t.sent(),this.T_&&(e&&!this.T_.wi?this.T_.start(this.Wr):e||this.T_.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Hp.prototype.w_=function(t){if(t.persistenceSettings.R_&&t.persistenceSettings.synchronizeTabs){var e=za();if(!gc.Mn(e))throw new _r(Tr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ol(t.s_.U,t.s_.persistenceKey);return new gc(e,t.rs,n,t.clientId,t.A_)}return new mc},Hp),Mp=(Kp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Wr?[3,2]:(this.Wr=n.Wr,this.tl=n.tl,this.Eh=this.y_(r),this.Xh=this.g_(r),this.Zh=this.V_(r),this.hi=this.p_(r),this.tl.li=function(t){return Yf(e.hi,t,1)},this.Xh.Ih.b_=op.bind(null,this.hi),[4,Mf(this.Xh,this.hi.fl)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Kp.prototype.V_=function(t){return new Za},Kp.prototype.y_=function(t){var e=Pc(t.s_.U),n=(n=t.s_,new kp(n));return t=t.credentials,new uf(t,n,e)},Kp.prototype.g_=function(t){var e=this,n=this.Wr,r=this.Eh,i=t.rs,o=function(t){return Yf(e.hi,t,0)},t=new(Op.Mn()?Op:Pp);return new Hl(n,r,i,o,t)},Kp.prototype.p_=function(t){return function(t,e,n,r,i,o,s){o=new zf(t,e,n,r,i,o);return s&&(o._l=!0),o}(this.Wr,this.Xh,this.Zh,this.tl,t.A_,t.el,!t.persistenceSettings.R_||!t.persistenceSettings.synchronizeTabs)},Kp.prototype.terminate=function(){return If(this.Xh)},Kp),Vp=(Qp.prototype.next=function(t){this.observer.next&&this.v_(this.observer.next,t)},Qp.prototype.error=function(t){this.observer.error?this.v_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Qp.prototype.S_=function(){this.muted=!0},Qp.prototype.v_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Qp),jp=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new _r(Tr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if($r("FieldPath","string",e,t[e]),0===t[e].length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.D_=new Br(t)},Fp=(n(zp,dp=jp),zp.documentId=function(){return new zp(Br.v().R())},zp.prototype.isEqual=function(t){if(!(t instanceof zp))throw ci("isEqual","FieldPath",1,t);return this.D_.isEqual(t.D_)},zp),qp=new RegExp("[~\\*/\\[\\]]"),Bp=function(t){this.C_=t},Gp=(n(Wp,pp=Bp),Wp.prototype.N_=function(t){if(2!==t.F_)throw 1===t.F_?t.x_(this.C_+"() can only appear at the top level of your update data"):t.x_(this.C_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},Wp.prototype.isEqual=function(t){return t instanceof Wp},Wp);function Wp(){return null!==pp&&pp.apply(this,arguments)||this}function zp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return dp.call(this,t)||this}function Qp(t){this.observer=t,this.muted=!1}function Kp(){}function Hp(){return null!==yp&&yp.apply(this,arguments)||this}function Xp(t){var e=this;return(e=vp.call(this)||this).P_=t,e}function Yp(){}function Jp(){}function $p(){var t=this;this.c_=function(){return t.h_()},this.l_=function(){return t.__()},this.f_=[],this.d_()}function Zp(t){var e=this;return(e=gp.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function td(t){this.s_=t,this.U=t.U;var e=t.ssl?"https":"http";this.i_=e+"://"+t.host,this.r_="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function ed(t){this.Hl=t.Hl,this.Jl=t.Jl}function nd(t){this.persistence=t,this.Wl=new $l,this.jl=null}function rd(t){var e=this;return(e=mp.call(this)||this).uu=t,e}function id(t,e){var n=this;this.Ll={},this.lu=new uc(0),this._u=!1,this._u=!0,this.aa=t(this),this.Yr=new _p(this),this.ao=new Uh,this.ro=(t=this.ao,new Ip(t,function(t){return n.aa.Bl(t)})),this.serializer=new ch(e),this.Au=new Ap(this.serializer)}function od(t){this.serializer=t,this.Ml=new Map,this.Ol=new Map}function sd(t){this.persistence=t,this.Fl=new xi(qi,Bi),this.lastRemoteSnapshotVersion=Di.min(),this.highestTargetId=0,this.$l=0,this.xl=new $l,this.targetCount=0,this.kl=dl.Qa()}function ud(t){var e=this;return(e=wp.call(this)||this).$a=t,e}function ad(t,e){this.ao=t,this.Cl=e,this.docs=new Yi(Gr.i),this.size=0}function cd(t,e){this.ao=t,this.aa=e,this.oo=[],this.Vl=1,this.pl=new ro(Zl.ac)}function hd(){}function ld(t,e,n){return new Ld({F_:3,k_:e.settings.k_,methodName:t.C_,M_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var fd,pd,dd,yd,vd=(n(Od,yd=Bp),Od.prototype.N_=function(t){return new zs(t.path,new Ds)},Od.prototype.isEqual=function(t){return t instanceof Od},Od),gd=(n(kd,dd=Bp),kd.prototype.N_=function(t){var e=ld(this,t,!0),n=this.O_.map(function(t){return Bd(t,e)}),n=new ks(n);return new zs(t.path,n)},kd.prototype.isEqual=function(t){return this===t},kd),md=(n(Dd,pd=Bp),Dd.prototype.N_=function(t){var e=ld(this,t,!0),n=this.O_.map(function(t){return Bd(t,e)}),n=new Us(n);return new zs(t.path,n)},Dd.prototype.isEqual=function(t){return this===t},Dd),wd=(n(Rd,fd=Bp),Rd.prototype.N_=function(t){var e=new Fs(t.serializer,ns(t.serializer,this.L_));return new zs(t.path,e)},Rd.prototype.isEqual=function(t){return this===t},Rd),bd=(Object.defineProperty(xd.prototype,"latitude",{get:function(){return this.B_},enumerable:!1,configurable:!0}),Object.defineProperty(xd.prototype,"longitude",{get:function(){return this.q_},enumerable:!1,configurable:!0}),xd.prototype.isEqual=function(t){return this.B_===t.B_&&this.q_===t.q_},xd.prototype.toJSON=function(){return{latitude:this.B_,longitude:this.q_}},xd.prototype.H=function(t){return yi(this.B_,t.B_)||yi(this.q_,t.q_)},xd),Ed=function(t){this.U_=t},Id=/^__.*__$/,Td=function(t,e,n){this.Q_=t,this.W_=e,this.j_=n},_d=(Sd.prototype.K_=function(t,e){var n=[];return null!==this.Qe?n.push(new iu(t,this.data,this.Qe,e)):n.push(new ru(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new cu(t,this.fieldTransforms)),n},Sd),Ad=(Nd.prototype.K_=function(t,e){e=[new iu(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&e.push(new cu(t,this.fieldTransforms)),e},Nd);function Nd(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Sd(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function xd(t,e){if(Xr("GeoPoint",arguments,2),$r("GeoPoint","number",1,t),$r("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new _r(Tr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new _r(Tr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.B_=t,this.q_=e}function Rd(t,e){var n=this;return(n=fd.call(this,t)||this).L_=e,n}function Dd(t,e){var n=this;return(n=pd.call(this,t)||this).O_=e,n}function kd(t,e){var n=this;return(n=dd.call(this,t)||this).O_=e,n}function Od(){return null!==yd&&yd.apply(this,arguments)||this}function Pd(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pr()}}var Ld=(Object.defineProperty(Md.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Md.prototype,"F_",{get:function(){return this.settings.F_},enumerable:!1,configurable:!0}),Md.prototype.z_=function(t){return new Md(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Md.prototype.H_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.z_({path:e,M_:!1});return e.J_(t),e},Md.prototype.Y_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.z_({path:t,M_:!1});return t.G_(),t},Md.prototype.X_=function(t){return this.z_({path:void 0,M_:!0})},Md.prototype.x_=function(t){return Hd(t,this.settings.methodName,this.settings.Z_||!1,this.path,this.settings.k_)},Md.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},Md.prototype.G_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.J_(this.path.get(t))},Md.prototype.J_=function(t){if(0===t.length)throw this.x_("Document fields must not be empty");if(Pd(this.F_)&&Id.test(t))throw this.x_('Document fields cannot begin and end with "__"')},Md),Cd=(Ud.prototype.tf=function(t,e,n,r){return void 0===r&&(r=!1),new Ld({F_:t,methodName:e,k_:n,path:Br.g(),M_:!1,Z_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},Ud);function Ud(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||Pc(t)}function Md(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.G_(),this.fieldTransforms=i||[],this.Qe=o||[]}function Vd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.tf(o.merge||o.mergeFields?2:0,e,n,i);zd("Data must be an object, but it was:",s,r);var u,a,r=Gd(r,s);if(o.merge)u=new Ws(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=l[h],p=void 0;if(f instanceof jp)p=f.D_;else{if("string"!=typeof f)throw Pr();p=Kd(e,f,n)}if(!s.contains(p))throw new _r(Tr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Xd(c,p)||c.push(p)}u=new Ws(c),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new _d(new vu(r),u,a)}function jd(t,r,i,e){var o=t.tf(1,r,i);zd("Data must be an object, but it was:",o,e);var s=[],u=new gu;Ur(e,function(t,e){var n=Kd(r,t,i),t=o.Y_(n);e instanceof Gp||e instanceof Ed&&e.U_ instanceof Gp?s.push(n):null!=(t=Bd(e,t))&&(s.push(n),u.set(n,t))});e=new Ws(s);return new Ad(u.Ye(),e,o.fieldTransforms)}function Fd(t,e,n,r,i,o){var s=t.tf(1,e,n),u=[Qd(e,r,n)],a=[i];if(o.length%2!=0)throw new _r(Tr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Qd(e,o[c])),a.push(o[c+1]);for(var h,l,f,p=[],d=new gu,y=u.length-1;0<=y;--y){Xd(p,u[y])||(h=u[y],l=a[y],f=s.Y_(h),l instanceof Gp||l instanceof Ed&&l.U_ instanceof Gp?p.push(h):null!=(f=Bd(l,f))&&(p.push(h),d.set(h,f)))}i=new Ws(p);return new Ad(d.Ye(),i,s.fieldTransforms)}function qd(t,e,n,r){return void 0===r&&(r=!1),Bd(n,t.tf(r?4:3,e))}function Bd(s,t){if(s instanceof Ed&&(s=s.U_),Wd(s))return zd("Unsupported field value:",t,s),Gd(s,t);if(s instanceof Bp)return function(t,e){if(!Pd(e.F_))throw e.x_(t.C_+"() can only be used with update() and set()");if(!e.path)throw e.x_(t.C_+"() is not currently supported inside arrays");t=t.N_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.M_&&4!==t.F_)throw t.x_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Bd(i[r],t.X_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ns(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ri.fromDate(t);return{timestampValue:rs(e.serializer,n)}}if(t instanceof Ri){var r=new Ri(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:rs(e.serializer,r)}}if(t instanceof bd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof bi)return{bytesValue:is(e.serializer,t.q)};if(t instanceof Td){n=e.U,r=t.Q_;if(!r.isEqual(n))throw e.x_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ss(t.Q_||e.U,t.W_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.x_("Unsupported field value: "+si(t))}(s,t)}function Gd(t,n){var r={};return Mr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Ur(t,function(t,e){e=Bd(e,n.H_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Wd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ri||t instanceof bd||t instanceof bi||t instanceof Td||t instanceof Bp)}function zd(t,e,n){if(!Wd(n)||!oi(n)){n=si(n);throw"an object"===n?e.x_(t+" a custom object"):e.x_(t+" "+n)}}function Qd(t,e,n){if(e instanceof jp)return e.D_;if("string"==typeof e)return Kd(t,e);throw Hd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Kd(t,e,n){try{return function(e){if(0<=e.search(qp))throw new _r(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Fp.bind.apply(Fp,i([void 0],e.split("."))))}catch(t){throw new _r(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).D_}catch(e){throw Hd(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Hd(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new _r(Tr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Xd(t,e){return t.some(function(t){return t.isEqual(e)})}var Yd=(ey.prototype.rf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.af(),0<this.mutations.length)throw new _r(Tr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=fs((n=s).serializer)+"/documents",r={documents:u.map(function(t){return as(n.serializer,t)})},[4,n.uh("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=cs(t,e.found.name),t=os(e.found.updateTime),e=new vu({mapValue:{fields:e.found.fields}});return new Au(n,t,e,{})}(e,t):"missing"in t?function(t,e){Lr(!!e.missing),Lr(!!e.readTime);t=cs(t,e.missing),e=os(e.readTime);return new Nu(t,e)}(e,t):Pr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Lr(!!t),o.push(t)}),o)]}})})}(this.Eh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Nu||t instanceof Au?n.uf(t):Pr()}),e)]}})})},ey.prototype.set=function(t,e){this.write(e.K_(t,this.Ke(t))),this.if.add(t.toString())},ey.prototype.update=function(t,e){try{this.write(e.K_(t,this.cf(t)))}catch(t){this.sf=t}this.if.add(t.toString())},ey.prototype.delete=function(t){this.write([new du(t,this.Ke(t))]),this.if.add(t.toString())},ey.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.af(),this.sf)throw this.sf;return e=this.ef,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Gr.D(e);n.mutations.push(new yu(e,n.Ke(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=fs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return vs(e.serializer,t)})},[4,e.ah("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Eh,this.mutations)];case 1:return t.sent(),this.nf=!0,[2]}})})},ey.prototype.uf=function(t){var e;if(t instanceof Au)e=t.version;else{if(!(t instanceof Nu))throw Pr();e=Di.min()}var n=this.ef.get(t.key.toString());if(n){if(!e.isEqual(n))throw new _r(Tr.ABORTED,"Document version changed between two reads.")}else this.ef.set(t.key.toString(),e)},ey.prototype.Ke=function(t){var e=this.ef.get(t.toString());return!this.if.has(t.toString())&&e?Hs.updateTime(e):Hs.Ge()},ey.prototype.cf=function(t){var e=this.ef.get(t.toString());if(this.if.has(t.toString())||!e)return Hs.exists(!0);if(e.isEqual(Di.min()))throw new _r(Tr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Hs.updateTime(e)},ey.prototype.write=function(t){this.af(),this.mutations=this.mutations.concat(t)},ey.prototype.af=function(){},ey),Jd=(ty.prototype.run=function(){this.lf()},ty.prototype.lf=function(){var t=this;this.Ps.An(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Yd(this.Eh),(n=this._f(e))&&n.then(function(t){r.rs.fs(function(){return e.commit().then(function(){r.cs.resolve(t)}).catch(function(t){r.ff(t)})})}).catch(function(t){r.ff(t)}),[2]})})})},ty.prototype._f=function(t){try{var e=this.updateFunction(t);return!Ui(e)&&e.catch&&e.then?e:(this.cs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.cs.reject(t),null}},ty.prototype.ff=function(t){var e=this;0<this.hf&&this.df(t)?(--this.hf,this.rs.fs(function(){return e.lf(),Promise.resolve()})):this.cs.reject(t)},ty.prototype.df=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Hi(t)},ty),$d=(Zd.prototype.start=function(t,e,n,r){var i=this;this.mf(),this.s_=t;var o=new Aa,s=!1;return this.credentials.Ac(function(t){return s?void i.rs.Ss(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).rs.Ns(),Rr("RemoteStore","RemoteStore received new credentials"),n=Rf(e),e.Ph.add(3),[4,Ef(e)];case 1:return t.sent(),n&&e.ph.set("Unknown"),[4,e.Ih.b_(i)];case 2:return t.sent(),e.Ph.delete(3),[4,bf(e)];case 3:return t.sent(),[2]}})})}(i.Xh,t)}):(s=!0,Rr("FirestoreClient","Initializing. user=",t.uid),i.Tf(e,n,r,t,o).then(i.wf.resolve,i.wf.reject))}),this.rs.fs(function(){return i.wf.promise}),o.promise},Zd.prototype.enableNetwork=function(){var e=this;return this.mf(),this.rs.enqueue(function(){return e.persistence.vu(!0),(t=e.Xh).Ph.delete(0),bf(t);var t})},Zd.prototype.Tf=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={rs:this.rs,s_:this.s_,clientId:this.clientId,credentials:this.credentials,A_:s,el:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.tl=r.tl,this.Wr=r.Wr,this.T_=r.T_,this.Eh=i.Eh,this.Xh=i.Xh,this.hi=i.hi,this.Ef=i.Zh,this.Ef.Ls=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=hp(s),(o=e.sl.get(u))?(n=o.targetId,e.tl.ki(n),r=o.view.Jh(),[3,4]):[3,1];case 1:return[4,Fl(e.Wr,Fu(u))];case 2:return i=t.sent(),o=e.tl.ki(i.targetId),n=i.targetId,[4,Hf(e,u,n,"current"===o)];case 3:r=t.sent(),e.fl&&Tf(e.Xh,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this.hi),this.Ef.Us=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).sl.get(o),1<(r=e.il.get(n.targetId)).length?[2,(e.il.set(n.targetId,r.filter(function(t){return!Wu(t,o)})),void e.sl.delete(o))]:e.fl?(e.tl.Oi(n.targetId),e.tl.Ci(n.targetId)?[3,2]:[4,ql(e.Wr,n.targetId,!1).then(function(){e.tl.Bi(n.targetId),_f(e.Xh,n.targetId),tp(e,n.targetId)}).catch(Ql)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return tp(e,n.targetId),[4,ql(e.Wr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.hi),this.persistence.bu(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.If(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.Tf(new Cp,new Mp,{R_:!1},s,u))];case 4:return[2]}})})},Zd.prototype.If=function(t){return"FirebaseError"===t.name?t.code===Tr.FAILED_PRECONDITION||t.code===Tr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Zd.prototype.mf=function(){if(this.rs.gs)throw new _r(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},Zd.prototype.disableNetwork=function(){var t=this;return this.mf(),this.rs.enqueue(function(){return t.persistence.vu(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ph.add(0),[4,Ef(e)];case 1:return t.sent(),e.ph.set("Offline"),[2]}})})}(t.Xh)})},Zd.prototype.terminate=function(){var t=this;this.rs.vs();var n=new Aa;return this.rs.Vs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.T_&&this.T_.stop(),[4,If(this.Xh)];case 1:return t.sent(),[4,this.tl.vi()];case 2:return t.sent(),[4,this.persistence.vi()];case 3:return t.sent(),this.credentials.Rc(),n.resolve(),[3,5];case 4:return e=t.sent(),e=Ja(e,"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},Zd.prototype.waitForPendingWrites=function(){var t=this;this.mf();var e=new Aa;return this.rs.fs(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Rf((n=o).Xh)||Rr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Wr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.oo.ma(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.hl.get(r)||[]).push(s),n.hl.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ja(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.hi,e)}),e.promise},Zd.prototype.listen=function(t,e,n){var r=this;this.mf();var i=new Vp(n),o=new rc(t,i,e);return this.rs.fs(function(){return tc(r.Ef,o)}),function(){i.S_(),r.rs.fs(function(){return ec(r.Ef,o)})}},Zd.prototype.Af=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.mf(),[4,this.wf.promise];case 1:return t.sent(),e=new Aa,[2,(this.rs.fs(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.eo.uo(t,e)}))];case 1:return(r=t.sent())instanceof Au?s.resolve(r):r instanceof Nu?s.resolve(null):s.reject(new _r(Tr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Ja(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Wr,r,e)}),e.promise)]}})})},Zd.prototype.Rf=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.mf(),[4,this.wf.promise];case 1:return t.sent(),e=new Aa,[2,(this.rs.fs(function(){return n=a.Ef,r=a.rs,i=c,o=h,s=e,t=new Vp({next:function(t){r.fs(function(){return ec(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new _r(Tr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new _r(Tr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new rc(Pu(i.path),t,{includeMetadataChanges:!0,Hs:!0}),tc(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},Zd.prototype.Pf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.mf(),[4,this.wf.promise];case 1:return t.sent(),e=new Aa,[2,(this.rs.fs(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Bl(r,i,!0)];case 1:return n=t.sent(),e=new Bf(i,n.rc),n=e.qh(n.documents),n=e.pr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Ja(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Wr,r,e)}),e.promise)]}})})},Zd.prototype.yf=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.mf(),[4,this.wf.promise];case 1:return t.sent(),u=new Aa,[2,(this.rs.fs(function(){return e=a.Ef,n=a.rs,t=c,r=h,i=u,o=new Vp({next:function(t){n.fs(function(){return ec(e,s)}),t.fromCache&&"server"===r.source?i.reject(new _r(Tr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new rc(t,o,{includeMetadataChanges:!0,Hs:!0}),tc(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},Zd.prototype.write=function(t){var e=this;this.mf();var n=new Aa;return this.rs.fs(function(){return function(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=lp(f),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Wr,a=p,h=i,l=Ri.now(),o=a.reduce(function(t,e){return t.add(e.key)},lo()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.eo._o(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof cu?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Au?t.field(i.field):void 0,o=Ss(i.transform,o||null);null!=o&&(e=(null==e?new gu:e).set(i.field,o))}return e?e.Ye():null}(o):null);null!=o&&e.push(new iu(i.key,o,function s(t){var u=[];return Ur(t.fields||{},function(t,e){var n=new Br([t]);if(Yo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ws(u)}(o.proto.mapValue),Hs.exists(!0)))}return h.oo.la(u,l,e,a)})}).then(function(t){var e=t._r(c);return{batchId:t.batchId,mr:e}}))];case 2:return s=t.sent(),u.tl.Ni(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.cl[e.currentUser.Ys()])||new Yi(yi)).rt(n,r),e.cl[e.currentUser.Ys()]=i,[4,ip(u,s.mr)];case 3:return t.sent(),[4,Lf(u.Xh)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ja(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,l,o})})}(e.hi,t,n)}),n.promise},Zd.prototype.U=function(){return this.s_.U},Zd.prototype.gf=function(t){var e=this;this.mf();var r=new Vp(t);return this.rs.fs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Ef,n=r,e.Os.add(n),void n.next())];var e,n})})}),function(){r.S_(),e.rs.fs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Ef.Os.delete(r)]})})})}},Object.defineProperty(Zd.prototype,"Vf",{get:function(){return this.rs.gs},enumerable:!1,configurable:!0}),Zd.prototype.transaction=function(t){var e=this;this.mf();var n=new Aa;return this.rs.fs(function(){return new Jd(e.rs,e.Eh,t,n).run(),Promise.resolve()}),n.promise},Zd.prototype.loadBundle=function(t,e){var n=this;this.mf();var r=function(t,e){t="string"==typeof t?(new TextEncoder).encode(t):t;return new Cc(Oc(t),e)}(t,Pc(this.s_.U));this.rs.fs(function(){return y(n,void 0,void 0,function(){return v(this,function(t){return[2,(fp(this.hi,r,e),e.catch(function(t){kr("FirestoreClient","Loading bundle failed with "+t)}))]})})})},Zd.prototype.La=function(t){return this.mf(),e=this.Wr,n=t,(r=e).persistence.runTransaction("Get named query","readonly",function(t){return r.Au.La(t,n)});var e,n,r},Zd);function Zd(t,e){this.credentials=t,this.rs=e,this.clientId=pi.k(),this.wf=new Aa}function ty(t,e,n,r){this.rs=t,this.Eh=e,this.updateFunction=n,this.cs=r,this.hf=5,this.Ps=new Sa(this.rs,"transaction_retry")}function ey(t){this.Eh=t,this.ef=new Map,this.mutations=[],this.nf=!1,this.sf=null,this.if=new Set}function ny(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ry,iy,oy=(Ay.prototype.Sf=function(t){switch(Uo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Go(t.integerValue||t.doubleValue);case 3:return this.Df(t.timestampValue);case 4:return this.Cf(t);case 5:return t.stringValue;case 6:return this.vf(Wo(t.bytesValue));case 7:return this.Nf(t.referenceValue);case 8:return this.Ff(t.geoPointValue);case 9:return this.$f(t.arrayValue);case 10:return this.xf(t.mapValue);default:throw Pr()}},Ay.prototype.xf=function(t){var n=this,r={};return Ur(t.fields||{},function(t,e){r[t]=n.Sf(e)}),r},Ay.prototype.Ff=function(t){return new bd(Go(t.latitude),Go(t.longitude))},Ay.prototype.$f=function(t){var e=this;return(t.values||[]).map(function(t){return e.Sf(t)})},Ay.prototype.Cf=function(t){switch(this.pf){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return Po(e)?t(e):e}(t);return null==e?null:this.Sf(e);case"estimate":return this.Df(Lo(t));default:return null}},Ay.prototype.Df=function(t){t=Bo(t),t=new Ri(t.seconds,t.nanos);return this.timestampsInSnapshots?t:t.toDate()},Ay.prototype.Nf=function(t){var e=Fr.P(t);Lr(Ns(e));t=new Si(e.get(1),e.get(3)),e=new Gr(e.u(5));return t.isEqual(this.U)||Dr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.bf(e)},Ay),sy=(_y.prototype.onProgress=function(t,e,n){this.kf={next:t,error:e,complete:n}},_y.prototype.catch=function(t){return this.Mf.promise.catch(t)},_y.prototype.then=function(t,e){return this.Mf.promise.then(t,e)},_y.prototype.Il=function(t){this.Al(t),this.kf.complete&&this.kf.complete(),this.Mf.resolve(t)},_y.prototype.Rl=function(t){this.Of.taskState="Error",this.kf.next&&this.kf.next(this.Of),this.kf.error&&this.kf.error(t),this.Mf.reject(t)},_y.prototype.Al=function(t){this.Of=t,this.kf.next&&this.kf.next(t)},_y),uy=Zc.Bo,ay=(Ty.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Ty),cy=(Object.defineProperty(Iy.prototype,"Hf",{get:function(){return this.Jf||(this.Jf=new Cd(this.Q_,this.zf.ignoreUndefinedProperties)),this.Jf},enumerable:!1,configurable:!0}),Iy.prototype.settings=function(t){Xr("Firestore.settings",arguments,1),$r("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.zf),t)).merge;t=new ay(t);if(this.Wf&&!this.zf.isEqual(t))throw new _r(Tr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.zf=t).credentials&&(this.Gf=function(t){if(!t)return new tf;switch(t.type){case"gapi":var e=t.client;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new rf(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new _r(Tr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Iy.prototype.enableNetwork=function(){return this.Qf(),this.Wf.enableNetwork()},Iy.prototype.disableNetwork=function(){return this.Qf(),this.Wf.disableNetwork()},Iy.prototype.enablePersistence=function(t){var e;if(this.Wf)throw new _r(Tr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Dr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new _r(Tr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Yf(this.Lf,this.Bf,{R_:!0,cacheSizeBytes:this.zf.cacheSizeBytes,synchronizeTabs:n,hu:r})},Iy.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Wf&&!this.Wf.Vf)throw new _r(Tr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Aa,[2,(this.Uf.Vs(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Lf.clearPersistence(this.Q_,this.Kf)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Iy.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Iy.prototype,"Xf",{get:function(){return this.Qf(),this.Wf.Vf},enumerable:!1,configurable:!0}),Iy.prototype.waitForPendingWrites=function(){return this.Qf(),this.Wf.waitForPendingWrites()},Iy.prototype.onSnapshotsInSync=function(t){if(this.Qf(),ny(t))return this.Wf.gf(t);$r("Firestore.onSnapshotsInSync","function",1,t);t={next:t};return this.Wf.gf(t)},Iy.prototype.loadBundle=function(t){this.Qf();var e=new sy;return this.Wf.loadBundle(t,e),e},Iy.prototype.namedQuery=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.Qf(),[4,this.Wf.La(n)];case 1:return[2,(e=t.sent())?new ky(e.query,this,null):null]}})})},Iy.prototype.Qf=function(){return this.Wf||this.Yf(new Cp,new Mp,{R_:!1}),this.Wf},Iy.prototype.Zf=function(){return new _i(this.Q_,this.Kf,this.zf.host,this.zf.ssl,this.zf.experimentalForceLongPolling)},Iy.prototype.Yf=function(t,e,n){var r=this.Zf();return this.Wf=new $d(this.Gf,this.Uf),this.Wf.start(r,t,e,n)},Iy.jf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new _r(Tr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new _r(Tr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Si(t)},Object.defineProperty(Iy.prototype,"app",{get:function(){if(!this.qf)throw new _r(Tr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.qf},enumerable:!1,configurable:!0}),Iy.prototype.collection=function(t){return Xr("Firestore.collection",arguments,1),$r("Firestore.collection","non-empty string",1,t),this.Qf(),new Py(Fr.P(t),this,null)},Iy.prototype.doc=function(t){return Xr("Firestore.doc",arguments,1),$r("Firestore.doc","non-empty string",1,t),this.Qf(),fy.td(Fr.P(t),this,null)},Iy.prototype.collectionGroup=function(t){if(Xr("Firestore.collectionGroup",arguments,1),$r("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Qf(),new ky((t=t,new xu(Fr.g(),t)),this,null)},Iy.prototype.runTransaction=function(e){var n=this;return Xr("Firestore.runTransaction",arguments,1),$r("Firestore.runTransaction","function",1,e),this.Qf().transaction(function(t){return e(new hy(n,t))})},Iy.prototype.batch=function(){return this.Qf(),new ly(this)},Object.defineProperty(Iy,"logLevel",{get:function(){switch(xr()){case f.DEBUG:return"debug";case f.ERROR:return"error";case f.SILENT:return"silent";case f.WARN:return"warn";case f.INFO:return"info";case f.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Iy.setLogLevel=function(t){Xr("Firestore.setLogLevel",arguments,1),ri("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Nr.setLogLevel(t)},Iy.prototype.ed=function(){return this.zf.timestampsInSnapshots},Iy.prototype.nd=function(){return this.zf},Iy),hy=(Ey.prototype.get=function(t){var e=this;Xr("Transaction.get",arguments,1);var n=Fy("Transaction.get",t,this.sd);return this.rd.rf([n.W_]).then(function(t){if(!t||1!==t.length)return Pr();t=t[0];if(t instanceof Nu)return new dy(e.sd,n.W_,null,!1,!1,n.j_);if(t instanceof Au)return new dy(e.sd,n.W_,t,!1,!1,n.j_);throw Pr()})},Ey.prototype.set=function(t,e,n){Jr("Transaction.set",arguments,2,3);t=Fy("Transaction.set",t,this.sd);n=My("Transaction.set",n);e=qy(t.j_,e,n),n=Vd(this.sd.Hf,"Transaction.set",t.W_,e,null!==t.j_,n);return this.rd.set(t.W_,n),this},Ey.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof Fp?(Yr("Transaction.update",arguments,3),r=Fy("Transaction.update",t,this.sd),Fd(this.sd.Hf,"Transaction.update",r.W_,e,n,i)):(Xr("Transaction.update",arguments,2),r=Fy("Transaction.update",t,this.sd),jd(this.sd.Hf,"Transaction.update",r.W_,e)),this.rd.update(r.W_,e),this},Ey.prototype.delete=function(t){Xr("Transaction.delete",arguments,1);t=Fy("Transaction.delete",t,this.sd);return this.rd.delete(t.W_),this},Ey),ly=(by.prototype.set=function(t,e,n){Jr("WriteBatch.set",arguments,2,3),this.ud();t=Fy("WriteBatch.set",t,this.sd);n=My("WriteBatch.set",n);e=qy(t.j_,e,n),n=Vd(this.sd.Hf,"WriteBatch.set",t.W_,e,null!==t.j_,n);return this.od=this.od.concat(n.K_(t.W_,Hs.Ge())),this},by.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.ud(),e="string"==typeof e||e instanceof Fp?(Yr("WriteBatch.update",arguments,3),r=Fy("WriteBatch.update",t,this.sd),Fd(this.sd.Hf,"WriteBatch.update",r.W_,e,n,i)):(Xr("WriteBatch.update",arguments,2),r=Fy("WriteBatch.update",t,this.sd),jd(this.sd.Hf,"WriteBatch.update",r.W_,e)),this.od=this.od.concat(e.K_(r.W_,Hs.exists(!0))),this},by.prototype.delete=function(t){Xr("WriteBatch.delete",arguments,1),this.ud();t=Fy("WriteBatch.delete",t,this.sd);return this.od=this.od.concat(new du(t.W_,Hs.Ge())),this},by.prototype.commit=function(){return this.ud(),this.ad=!0,0<this.od.length?this.sd.Qf().write(this.od):Promise.resolve()},by.prototype.ud=function(){if(this.ad)throw new _r(Tr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},by),fy=(n(wy,iy=Td),wy.td=function(t,e,n){if(t.length%2!=0)throw new _r(Tr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new wy(new Gr(t),e,n)},Object.defineProperty(wy.prototype,"id",{get:function(){return this.W_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(wy.prototype,"parent",{get:function(){return new Py(this.W_.path.h(),this.firestore,this.j_)},enumerable:!1,configurable:!0}),Object.defineProperty(wy.prototype,"path",{get:function(){return this.W_.path.R()},enumerable:!1,configurable:!0}),wy.prototype.collection=function(t){if(Xr("DocumentReference.collection",arguments,1),$r("DocumentReference.collection","non-empty string",1,t),!t)throw new _r(Tr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=Fr.P(t);return new Py(this.W_.path.child(t),this.firestore,null)},wy.prototype.isEqual=function(t){if(!(t instanceof wy))throw ci("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.W_.isEqual(t.W_)&&this.j_===t.j_},wy.prototype.set=function(t,e){Jr("DocumentReference.set",arguments,1,2),e=My("DocumentReference.set",e);t=qy(this.j_,t,e),e=Vd(this.firestore.Hf,"DocumentReference.set",this.W_,t,null!==this.j_,e);return this.Wf.write(e.K_(this.W_,Hs.Ge()))},wy.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof Fp?(Yr("DocumentReference.update",arguments,2),Fd(this.firestore.Hf,"DocumentReference.update",this.W_,t,e,n)):(Xr("DocumentReference.update",arguments,1),jd(this.firestore.Hf,"DocumentReference.update",this.W_,t)),this.Wf.write(t.K_(this.W_,Hs.exists(!0)))},wy.prototype.delete=function(){return Xr("DocumentReference.delete",arguments,0),this.Wf.write([new du(this.W_,Hs.Ge())])},wy.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Jr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||ny(n[i])||(ai("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),ei("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};ny(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):($r("DocumentReference.onSnapshot","function",i,n[i]),Zr("DocumentReference.onSnapshot","function",i+1,n[i+1]),Zr("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.hd(t))},error:n[i+1],complete:n[i+2]};return this.Wf.listen(Pu(this.W_.path),o,s)},wy.prototype.get=function(t){var e=this;Jr("DocumentReference.get",arguments,0,1),jy("DocumentReference.get",t);var n=this.firestore.Qf();return t&&"cache"===t.source?n.Af(this.W_).then(function(t){return new dy(e.firestore,e.W_,t,!0,t instanceof Au&&t.Je,e.j_)}):n.Rf(this.W_,t).then(function(t){return e.hd(t)})},wy.prototype.withConverter=function(t){return new wy(this.W_,this.firestore,t)},wy.prototype.hd=function(t){var e=t.docs.get(this.W_);return new dy(this.firestore,this.W_,e,t.fromCache,t.hasPendingWrites,this.j_)},wy),py=(my.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},my),dy=(gy.prototype.data=function(t){var e=this;if(Jr("DocumentSnapshot.data",arguments,0,1),t=Vy("DocumentSnapshot.data",t),this.ld){if(this.j_){var n=new yy(this.sd,this.W_,this.ld,this._d,this.fd,null);return this.j_.fromFirestore(n,t)}return new oy(this.sd.Q_,this.sd.ed(),t.serverTimestamps||"none",function(t){return new fy(t,e.sd,null)},function(t){return new Ni(t)}).Sf(this.ld.sn())}},gy.prototype.get=function(t,e){var n=this;if(Jr("DocumentSnapshot.get",arguments,1,2),e=Vy("DocumentSnapshot.get",e),this.ld){t=this.ld.data().field(Qd("DocumentSnapshot.get",t,this.W_));if(null!==t)return new oy(this.sd.Q_,this.sd.ed(),e.serverTimestamps||"none",function(t){return new fy(t,n.sd,n.j_)},function(t){return new Ni(t)}).Sf(t)}},Object.defineProperty(gy.prototype,"id",{get:function(){return this.W_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(gy.prototype,"ref",{get:function(){return new fy(this.W_,this.sd,this.j_)},enumerable:!1,configurable:!0}),Object.defineProperty(gy.prototype,"exists",{get:function(){return null!==this.ld},enumerable:!1,configurable:!0}),Object.defineProperty(gy.prototype,"metadata",{get:function(){return new py(this.fd,this._d)},enumerable:!1,configurable:!0}),gy.prototype.isEqual=function(t){if(!(t instanceof gy))throw ci("isEqual","DocumentSnapshot",1,t);return this.sd===t.sd&&this._d===t._d&&this.W_.isEqual(t.W_)&&(null===this.ld?null===t.ld:this.ld.isEqual(t.ld))&&this.j_===t.j_},gy),yy=(n(vy,ry=dy),vy.prototype.data=function(t){return ry.prototype.data.call(this,t)},vy);function vy(){return null!==ry&&ry.apply(this,arguments)||this}function gy(t,e,n,r,i,o){this.sd=t,this.W_=e,this.ld=n,this._d=r,this.fd=i,this.j_=o}function my(t,e){this.hasPendingWrites=t,this.fromCache=e}function wy(t,e,n){var r=this;return(r=iy.call(this,e.Q_,t,n)||this).W_=t,r.firestore=e,r.j_=n,r.Wf=r.firestore.Qf(),r}function by(t){this.sd=t,this.od=[],this.ad=!1}function Ey(t,e){this.sd=t,this.rd=e}function Iy(t,e,n,r){var i=this;if(void 0===n&&(n=new Cp),void 0===r&&(r=new Mp),this.Lf=n,this.Bf=r,this.qf=null,this.Uf=new Ha,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Qf(),[4,this.Wf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){r=t;this.qf=r,this.Q_=Iy.jf(r),this.Kf=r.name,this.Gf=new ef(e)}else{t=t;if(!t.projectId)throw new _r(Tr.INVALID_ARGUMENT,"Must provide projectId");this.Q_=new Si(t.projectId,t.database),this.Kf="[DEFAULT]",this.Gf=new tf}this.zf=new ay({})}function Ty(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new _r(Tr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ti("settings","non-empty string","host",t.host),this.host=t.host,ei("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ai("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ei("settings","object","credentials",t.credentials),this.credentials=t.credentials,ei("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ei("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Dr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Dr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,ei("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Zc.Uo;else{if(t.cacheSizeBytes!==uy&&t.cacheSizeBytes<Zc.qo)throw new _r(Tr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Zc.qo);this.cacheSizeBytes=t.cacheSizeBytes}ei("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(t=t.experimentalForceLongPolling)&&void 0!==t&&t}function _y(){this.kf={},this.Mf=new Aa,this.Of={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Ay(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.pf=n,this.bf=r,this.vf=i}function Ny(t,e,n){if("string"==typeof n){if(""===n)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vu(e)&&-1!==n.indexOf("/"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(Fr.P(n));if(!Gr.F(e))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return zo(t,new Gr(e))}if(n instanceof Td)return zo(t,n.W_);throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+si(n)+".")}function Sy(t,e){if(!Array.isArray(t)||0===t.length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function xy(t,e,n){if(!n.isEqual(e))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ry(t){if(Cu(t)&&0===t.rn.length)throw new _r(Tr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Dy,ky=(Uy.prototype.where=function(t,e,n){Xr("Query.where",arguments,3),ui("Query.where",3,n);e=ri("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=Qd("Query.where",t),e=function(t,e,n,r,i,o,s){if(i.p()){if("array-contains"===o||"array-contains-any"===o)throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Sy(s,o);for(var u=[],a=0,c=s;a<c.length;a++){var h=c[a];u.push(Ny(r,t,h))}l={arrayValue:{values:u}}}else l=Ny(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Sy(s,o),l=qd(n,e,s,"in"===o||"not-in"===o);var l=Yu.create(i,o,l);return function(t,e){if(e.un()){var n=Mu(t);if(null!==n&&!n.isEqual(e.field))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Uu(t);null!==n&&xy(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new _r(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new _r(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,l),l}(this.dd,"Query.where",this.firestore.Hf,this.firestore.Q_,t,e,n);return new Uy((n=this.dd,e=n.filters.concat([e]),new xu(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.j_)},Uy.prototype.orderBy=function(t,e){if(Jr("Query.orderBy",arguments,1,2),Zr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new _r(Tr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Qd("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new _a(e,n);return e=r,null!==Uu(n=t)||null!==(t=Mu(n))&&xy(0,t,e.field),r}(this.dd,t,n);return new Uy((n=this.dd,t=n.rn.concat([t]),new xu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.j_)},Uy.prototype.limit=function(t){return Xr("Query.limit",arguments,1),$r("Query.limit","number",1,t),hi("Query.limit",1,t),new Uy(qu(this.dd,t,"F"),this.firestore,this.j_)},Uy.prototype.limitToLast=function(t){return Xr("Query.limitToLast",arguments,1),$r("Query.limitToLast","number",1,t),hi("Query.limitToLast",1,t),new Uy(qu(this.dd,t,"L"),this.firestore,this.j_)},Uy.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Yr("Query.startAt",arguments,1);t=this.wd("Query.startAt",t,e,!0);return new Uy(Bu(this.dd,t),this.firestore,this.j_)},Uy.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Yr("Query.startAfter",arguments,1);t=this.wd("Query.startAfter",t,e,!1);return new Uy(Bu(this.dd,t),this.firestore,this.j_)},Uy.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Yr("Query.endBefore",arguments,1);t=this.wd("Query.endBefore",t,e,!0);return new Uy(Gu(this.dd,t),this.firestore,this.j_)},Uy.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Yr("Query.endAt",arguments,1);t=this.wd("Query.endAt",t,e,!1);return new Uy(Gu(this.dd,t),this.firestore,this.j_)},Uy.prototype.isEqual=function(t){if(!(t instanceof Uy))throw ci("isEqual","Query",1,t);return this.firestore===t.firestore&&Wu(this.dd,t.dd)&&this.j_===t.j_},Uy.prototype.withConverter=function(t){return new Uy(this.dd,this.firestore,t)},Uy.prototype.wd=function(c,t,e,n){if(ui(c,1,t),t instanceof dy)return Xr(c,i([t],e),1),function(t,e,n,r){if(!n)throw new _r(Tr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=ju(t);o<s.length;o++){var u=s[o];if(u.field.p())i.push(zo(e,n.key));else{var a=n.field(u.field);if(Po(a))throw new _r(Tr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.R();throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new va(i,r)}(this.dd,this.firestore.Q_,t.ld,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new _r(Tr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.p()){if("string"!=typeof c)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Vu(t)&&-1!==c.indexOf("/"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Fr.P(c));if(!Gr.F(h))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Gr(h);u.push(zo(e,h))}else{c=qd(n,r,c);u.push(c)}}return new va(u,o)}(this.dd,this.firestore.Q_,this.firestore.Hf,c,e,n)},Uy.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Jr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||ny(n[o])||(ai("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),ei("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),ny(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):($r("Query.onSnapshot","function",o,n[o]),Zr("Query.onSnapshot","function",o+1,n[o+1]),Zr("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new Oy(e.firestore,e.dd,t,e.j_))},error:n[o+1],complete:n[o+2]};return Ry(this.dd),this.firestore.Qf().listen(this.dd,i,s)},Uy.prototype.get=function(t){var e=this;Jr("Query.get",arguments,0,1),jy("Query.get",t),Ry(this.dd);var n=this.firestore.Qf();return(t&&"cache"===t.source?n.Pf(this.dd):n.yf(this.dd,t)).then(function(t){return new Oy(e.firestore,e.dd,t,e.j_)})},Uy),Oy=(Object.defineProperty(Cy.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Cy.prototype,"empty",{get:function(){return this.Td.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(Cy.prototype,"size",{get:function(){return this.Td.docs.size},enumerable:!1,configurable:!0}),Cy.prototype.forEach=function(e,n){var r=this;Jr("QuerySnapshot.forEach",arguments,1,2),$r("QuerySnapshot.forEach","function",1,e),this.Td.docs.forEach(function(t){e.call(n,r.Ad(t,r.metadata.fromCache,r.Td.Qt.has(t.key)))})},Object.defineProperty(Cy.prototype,"query",{get:function(){return new ky(this.md,this.sd,this.j_)},enumerable:!1,configurable:!0}),Cy.prototype.docChanges=function(t){t&&(ai("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ei("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));t=!(!t||!t.includeMetadataChanges);if(t&&this.Td.jt)throw new _r(Tr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ed&&this.Id===t||(this.Ed=function(i,e,o){if(i.Ut.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ut;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Td,t,this.Ad.bind(this)),this.Id=t),this.Ed},Cy.prototype.isEqual=function(t){if(!(t instanceof Cy))throw ci("isEqual","QuerySnapshot",1,t);return this.sd===t.sd&&Wu(this.md,t.md)&&this.Td.isEqual(t.Td)&&this.j_===t.j_},Cy.prototype.Ad=function(t,e,n){return new yy(this.sd,t.key,t,e,n,this.j_)},Cy),Py=(n(Ly,Dy=ky),Object.defineProperty(Ly.prototype,"id",{get:function(){return this.dd.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Ly.prototype,"parent",{get:function(){var t=this.dd.path.h();return t.m()?null:new fy(new Gr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Ly.prototype,"path",{get:function(){return this.dd.path.R()},enumerable:!1,configurable:!0}),Ly.prototype.doc=function(t){Jr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=pi.k()),$r("CollectionReference.doc","non-empty string",1,t);t=Fr.P(t);return fy.td(this.dd.path.child(t),this.firestore,this.j_)},Ly.prototype.add=function(t){Xr("CollectionReference.add",arguments,1);t=this.j_?this.j_.toFirestore(t):t;$r("CollectionReference.add","object",1,t);var e=this.doc();return new fy(e.W_,this.firestore,null).set(t).then(function(){return e})},Ly.prototype.withConverter=function(t){return new Ly(this.Rd,this.firestore,t)},Ly);function Ly(t,e,n){var r=this;if(((r=Dy.call(this,Pu(t),e,n)||this).Rd=t).length%2!=1)throw new _r(Tr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function Cy(t,e,n,r){this.sd=t,this.md=e,this.Td=n,this.j_=r,this.Ed=null,this.Id=null,this.metadata=new py(n.hasPendingWrites,n.fromCache)}function Uy(t,e,n){this.dd=t,this.firestore=e,this.j_=n}function My(t,e){if(void 0===e)return{merge:!1};if(ai(t,e,["merge","mergeFields"]),ei(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+si(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+si(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof Fp}),void 0!==e.mergeFields&&void 0!==e.merge)throw new _r(Tr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Vy(t,e){return void 0===e?{}:(ai(t,e,["serverTimestamps"]),ni(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function jy(t,e){Zr(t,"object",1,e),e&&(ai(t,e,["source"]),ni(t,0,"source",e.source,["default","server","cache"]))}function Fy(t,e,n){if(e instanceof Td){if(e.firestore!==n)throw new _r(Tr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ci(t,"DocumentReference",1,e)}function qy(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var By,Gy,Ie=(n(zy,By=Ed),zy.serverTimestamp=function(){Hr("FieldValue.serverTimestamp",arguments);var t=new vd("serverTimestamp");return t.C_="FieldValue.serverTimestamp",new zy(t)},zy.delete=function(){Hr("FieldValue.delete",arguments);var t=new Gp("deleteField");return t.C_="FieldValue.delete",new zy(t)},zy.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Yr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Yr("arrayUnion()",arguments,1),new gd("arrayUnion",t)}.apply(void 0,t);return n.C_="FieldValue.arrayUnion",new zy(n)},zy.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Yr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Yr("arrayRemove()",arguments,1),new md("arrayRemove",t)}.apply(void 0,t);return n.C_="FieldValue.arrayRemove",new zy(n)},zy.increment=function(t){$r("FieldValue.increment","number",1,t),Xr("FieldValue.increment",arguments,1);t=new wd("increment",t);return t.C_="FieldValue.increment",new zy(t)},zy.prototype.isEqual=function(t){return this.U_.isEqual(t.U_)},zy),Wy={Firestore:cy,GeoPoint:bd,Timestamp:Ri,Blob:Ni,Transaction:hy,WriteBatch:ly,DocumentReference:fy,DocumentSnapshot:dy,Query:ky,QueryDocumentSnapshot:yy,QuerySnapshot:Oy,CollectionReference:Py,FieldPath:Fp,FieldValue:Ie,setLogLevel:cy.setLogLevel,CACHE_SIZE_UNLIMITED:uy};function zy(){return null!==By&&By.apply(this,arguments)||this}(Gy=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new Mp,t=new Up(r),new cy(e,n,t,r);var e,n,r},"PUBLIC").setServiceProps(Object.assign({},Wy))),Gy.registerVersion("@firebase/firestore","1.18.0-alpha.96ae6a5fe")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
